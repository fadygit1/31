var Ny=Object.defineProperty;var by=(e,t,r)=>t in e?Ny(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Xl=(e,t,r)=>by(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var jx={exports:{}},Wc={},Sx={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dl=Symbol.for("react.element"),Ey=Symbol.for("react.portal"),jy=Symbol.for("react.fragment"),Sy=Symbol.for("react.strict_mode"),Ty=Symbol.for("react.profiler"),ky=Symbol.for("react.provider"),Cy=Symbol.for("react.context"),Ay=Symbol.for("react.forward_ref"),Dy=Symbol.for("react.suspense"),Fy=Symbol.for("react.memo"),Oy=Symbol.for("react.lazy"),gh=Symbol.iterator;function Py(e){return e===null||typeof e!="object"?null:(e=gh&&e[gh]||e["@@iterator"],typeof e=="function"?e:null)}var Tx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kx=Object.assign,Cx={};function qs(e,t,r){this.props=e,this.context=t,this.refs=Cx,this.updater=r||Tx}qs.prototype.isReactComponent={};qs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};qs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ax(){}Ax.prototype=qs.prototype;function Dd(e,t,r){this.props=e,this.context=t,this.refs=Cx,this.updater=r||Tx}var Fd=Dd.prototype=new Ax;Fd.constructor=Dd;kx(Fd,qs.prototype);Fd.isPureReactComponent=!0;var vh=Array.isArray,Dx=Object.prototype.hasOwnProperty,Od={current:null},Fx={key:!0,ref:!0,__self:!0,__source:!0};function Ox(e,t,r){var n,a={},s=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(s=""+t.key),t)Dx.call(t,n)&&!Fx.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Dl,type:e,key:s,ref:l,props:a,_owner:Od.current}}function Iy(e,t){return{$$typeof:Dl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Pd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Dl}function Ry(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var yh=/\/+/g;function wu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ry(""+e.key):t.toString(36)}function ko(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Dl:case Ey:l=!0}}if(l)return l=e,a=a(l),e=n===""?"."+wu(l,0):n,vh(a)?(r="",e!=null&&(r=e.replace(yh,"$&/")+"/"),ko(a,t,r,"",function(u){return u})):a!=null&&(Pd(a)&&(a=Iy(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(yh,"$&/")+"/")+e)),t.push(a)),1;if(l=0,n=n===""?".":n+":",vh(e))for(var o=0;o<e.length;o++){s=e[o];var c=n+wu(s,o);l+=ko(s,t,r,c,a)}else if(c=Py(e),typeof c=="function")for(e=c.call(e),o=0;!(s=e.next()).done;)s=s.value,c=n+wu(s,o++),l+=ko(s,t,r,c,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Yl(e,t,r){if(e==null)return e;var n=[],a=0;return ko(e,n,"","",function(s){return t.call(r,s,a++)}),n}function Ly(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jt={current:null},Co={transition:null},My={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:Co,ReactCurrentOwner:Od};function Px(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Yl,forEach:function(e,t,r){Yl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Yl(e,function(){t++}),t},toArray:function(e){return Yl(e,function(t){return t})||[]},only:function(e){if(!Pd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=qs;Ce.Fragment=jy;Ce.Profiler=Ty;Ce.PureComponent=Dd;Ce.StrictMode=Sy;Ce.Suspense=Dy;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=My;Ce.act=Px;Ce.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=kx({},e.props),a=e.key,s=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,l=Od.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Dx.call(t,c)&&!Fx.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Dl,type:e.type,key:a,ref:s,props:n,_owner:l}};Ce.createContext=function(e){return e={$$typeof:Cy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ky,_context:e},e.Consumer=e};Ce.createElement=Ox;Ce.createFactory=function(e){var t=Ox.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:Ay,render:e}};Ce.isValidElement=Pd;Ce.lazy=function(e){return{$$typeof:Oy,_payload:{_status:-1,_result:e},_init:Ly}};Ce.memo=function(e,t){return{$$typeof:Fy,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=Co.transition;Co.transition={};try{e()}finally{Co.transition=t}};Ce.unstable_act=Px;Ce.useCallback=function(e,t){return Jt.current.useCallback(e,t)};Ce.useContext=function(e){return Jt.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Jt.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Jt.current.useEffect(e,t)};Ce.useId=function(){return Jt.current.useId()};Ce.useImperativeHandle=function(e,t,r){return Jt.current.useImperativeHandle(e,t,r)};Ce.useInsertionEffect=function(e,t){return Jt.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Jt.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Jt.current.useMemo(e,t)};Ce.useReducer=function(e,t,r){return Jt.current.useReducer(e,t,r)};Ce.useRef=function(e){return Jt.current.useRef(e)};Ce.useState=function(e){return Jt.current.useState(e)};Ce.useSyncExternalStore=function(e,t,r){return Jt.current.useSyncExternalStore(e,t,r)};Ce.useTransition=function(){return Jt.current.useTransition()};Ce.version="18.3.1";Sx.exports=Ce;var ye=Sx.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var By=ye,Uy=Symbol.for("react.element"),$y=Symbol.for("react.fragment"),Wy=Object.prototype.hasOwnProperty,zy=By.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Hy={key:!0,ref:!0,__self:!0,__source:!0};function Ix(e,t,r){var n,a={},s=null,l=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Wy.call(t,n)&&!Hy.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Uy,type:e,key:s,ref:l,props:a,_owner:zy.current}}Wc.Fragment=$y;Wc.jsx=Ix;Wc.jsxs=Ix;jx.exports=Wc;var i=jx.exports,Rx={exports:{}},Nr={},Lx={exports:{}},Mx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,N){var D=K.length;K.push(N);e:for(;0<D;){var b=D-1>>>1,S=K[b];if(0<a(S,N))K[b]=N,K[D]=S,D=b;else break e}}function r(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var N=K[0],D=K.pop();if(D!==N){K[0]=D;e:for(var b=0,S=K.length,W=S>>>1;b<W;){var M=2*(b+1)-1,U=K[M],J=M+1,ce=K[J];if(0>a(U,D))J<S&&0>a(ce,U)?(K[b]=ce,K[J]=D,b=J):(K[b]=U,K[M]=D,b=M);else if(J<S&&0>a(ce,D))K[b]=ce,K[J]=D,b=J;else break e}}return N}function a(K,N){var D=K.sortIndex-N.sortIndex;return D!==0?D:K.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],u=[],d=1,f=null,h=3,x=!1,g=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(K){for(var N=r(u);N!==null;){if(N.callback===null)n(u);else if(N.startTime<=K)n(u),N.sortIndex=N.expirationTime,t(c,N);else break;N=r(u)}}function T(K){if(m=!1,w(K),!g)if(r(c)!==null)g=!0,we(I);else{var N=r(u);N!==null&&z(T,N.startTime-K)}}function I(K,N){g=!1,m&&(m=!1,v(A),A=-1),x=!0;var D=h;try{for(w(N),f=r(c);f!==null&&(!(f.expirationTime>N)||K&&!B());){var b=f.callback;if(typeof b=="function"){f.callback=null,h=f.priorityLevel;var S=b(f.expirationTime<=N);N=e.unstable_now(),typeof S=="function"?f.callback=S:f===r(c)&&n(c),w(N)}else n(c);f=r(c)}if(f!==null)var W=!0;else{var M=r(u);M!==null&&z(T,M.startTime-N),W=!1}return W}finally{f=null,h=D,x=!1}}var L=!1,j=null,A=-1,y=5,O=-1;function B(){return!(e.unstable_now()-O<y)}function H(){if(j!==null){var K=e.unstable_now();O=K;var N=!0;try{N=j(!0,K)}finally{N?Q():(L=!1,j=null)}}else L=!1}var Q;if(typeof p=="function")Q=function(){p(H)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,oe=ie.port2;ie.port1.onmessage=H,Q=function(){oe.postMessage(null)}}else Q=function(){_(H,0)};function we(K){j=K,L||(L=!0,Q())}function z(K,N){A=_(function(){K(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){g||x||(g=!0,we(I))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(K){switch(h){case 1:case 2:case 3:var N=3;break;default:N=h}var D=h;h=N;try{return K()}finally{h=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,N){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var D=h;h=K;try{return N()}finally{h=D}},e.unstable_scheduleCallback=function(K,N,D){var b=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?b+D:b):D=b,K){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=D+S,K={id:d++,callback:N,priorityLevel:K,startTime:D,expirationTime:S,sortIndex:-1},D>b?(K.sortIndex=D,t(u,K),r(c)===null&&K===r(u)&&(m?(v(A),A=-1):m=!0,z(T,D-b))):(K.sortIndex=S,t(c,K),g||x||(g=!0,we(I))),K},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(K){var N=h;return function(){var D=h;h=N;try{return K.apply(this,arguments)}finally{h=D}}}})(Mx);Lx.exports=Mx;var Vy=Lx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ky=ye,yr=Vy;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Bx=new Set,Qi={};function Ka(e,t){Bs(e,t),Bs(e+"Capture",t)}function Bs(e,t){for(Qi[e]=t,e=0;e<t.length;e++)Bx.add(t[e])}var Sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l0=Object.prototype.hasOwnProperty,Gy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wh={},_h={};function Xy(e){return l0.call(_h,e)?!0:l0.call(wh,e)?!1:Gy.test(e)?_h[e]=!0:(wh[e]=!0,!1)}function Yy(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qy(e,t,r,n){if(t===null||typeof t>"u"||Yy(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zt(e,t,r,n,a,s,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ft[e]=new Zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ft[t]=new Zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ft[e]=new Zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ft[e]=new Zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ft[e]=new Zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ft[e]=new Zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ft[e]=new Zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ft[e]=new Zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ft[e]=new Zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Id=/[\-:]([a-z])/g;function Rd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Id,Rd);Ft[t]=new Zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Id,Rd);Ft[t]=new Zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Id,Rd);Ft[t]=new Zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ft[e]=new Zt(e,1,!1,e.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ft[e]=new Zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ld(e,t,r,n){var a=Ft.hasOwnProperty(t)?Ft[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(qy(t,r,a,n)&&(r=null),n||a===null?Xy(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var On=Ky.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ql=Symbol.for("react.element"),fs=Symbol.for("react.portal"),hs=Symbol.for("react.fragment"),Md=Symbol.for("react.strict_mode"),o0=Symbol.for("react.profiler"),Ux=Symbol.for("react.provider"),$x=Symbol.for("react.context"),Bd=Symbol.for("react.forward_ref"),c0=Symbol.for("react.suspense"),u0=Symbol.for("react.suspense_list"),Ud=Symbol.for("react.memo"),Bn=Symbol.for("react.lazy"),Wx=Symbol.for("react.offscreen"),Nh=Symbol.iterator;function di(e){return e===null||typeof e!="object"?null:(e=Nh&&e[Nh]||e["@@iterator"],typeof e=="function"?e:null)}var nt=Object.assign,_u;function bi(e){if(_u===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);_u=t&&t[1]||""}return`
`+_u+e}var Nu=!1;function bu(e,t){if(!e||Nu)return"";Nu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),l=a.length-1,o=s.length-1;1<=l&&0<=o&&a[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==s[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Nu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?bi(e):""}function Qy(e){switch(e.tag){case 5:return bi(e.type);case 16:return bi("Lazy");case 13:return bi("Suspense");case 19:return bi("SuspenseList");case 0:case 2:case 15:return e=bu(e.type,!1),e;case 11:return e=bu(e.type.render,!1),e;case 1:return e=bu(e.type,!0),e;default:return""}}function d0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case hs:return"Fragment";case fs:return"Portal";case o0:return"Profiler";case Md:return"StrictMode";case c0:return"Suspense";case u0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case $x:return(e.displayName||"Context")+".Consumer";case Ux:return(e._context.displayName||"Context")+".Provider";case Bd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ud:return t=e.displayName||null,t!==null?t:d0(e.type)||"Memo";case Bn:t=e._payload,e=e._init;try{return d0(e(t))}catch{}}return null}function Jy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return d0(t);case 8:return t===Md?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function aa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Zy(e){var t=zx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){n=""+l,s.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ql(e){e._valueTracker||(e._valueTracker=Zy(e))}function Hx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=zx(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Yo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function f0(e,t){var r=t.checked;return nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function bh(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=aa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Vx(e,t){t=t.checked,t!=null&&Ld(e,"checked",t,!1)}function h0(e,t){Vx(e,t);var r=aa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?m0(e,t.type,r):t.hasOwnProperty("defaultValue")&&m0(e,t.type,aa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Eh(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function m0(e,t,r){(t!=="number"||Yo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ei=Array.isArray;function Ss(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+aa(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function x0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(re(91));return nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function jh(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(re(92));if(Ei(r)){if(1<r.length)throw Error(re(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:aa(r)}}function Kx(e,t){var r=aa(t.value),n=aa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Sh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Gx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function p0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Gx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Jl,Xx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Jl=Jl||document.createElement("div"),Jl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Jl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ji(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ai={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},e2=["Webkit","ms","Moz","O"];Object.keys(Ai).forEach(function(e){e2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ai[t]=Ai[e]})});function Yx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ai.hasOwnProperty(e)&&Ai[e]?(""+t).trim():t+"px"}function qx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Yx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var t2=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function g0(e,t){if(t){if(t2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(re(62))}}function v0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var y0=null;function $d(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var w0=null,Ts=null,ks=null;function Th(e){if(e=Pl(e)){if(typeof w0!="function")throw Error(re(280));var t=e.stateNode;t&&(t=Gc(t),w0(e.stateNode,e.type,t))}}function Qx(e){Ts?ks?ks.push(e):ks=[e]:Ts=e}function Jx(){if(Ts){var e=Ts,t=ks;if(ks=Ts=null,Th(e),t)for(e=0;e<t.length;e++)Th(t[e])}}function Zx(e,t){return e(t)}function ep(){}var Eu=!1;function tp(e,t,r){if(Eu)return e(t,r);Eu=!0;try{return Zx(e,t,r)}finally{Eu=!1,(Ts!==null||ks!==null)&&(ep(),Jx())}}function Zi(e,t){var r=e.stateNode;if(r===null)return null;var n=Gc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(re(231,t,typeof r));return r}var _0=!1;if(Sn)try{var fi={};Object.defineProperty(fi,"passive",{get:function(){_0=!0}}),window.addEventListener("test",fi,fi),window.removeEventListener("test",fi,fi)}catch{_0=!1}function r2(e,t,r,n,a,s,l,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Di=!1,qo=null,Qo=!1,N0=null,n2={onError:function(e){Di=!0,qo=e}};function a2(e,t,r,n,a,s,l,o,c){Di=!1,qo=null,r2.apply(n2,arguments)}function s2(e,t,r,n,a,s,l,o,c){if(a2.apply(this,arguments),Di){if(Di){var u=qo;Di=!1,qo=null}else throw Error(re(198));Qo||(Qo=!0,N0=u)}}function Ga(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function rp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function kh(e){if(Ga(e)!==e)throw Error(re(188))}function i2(e){var t=e.alternate;if(!t){if(t=Ga(e),t===null)throw Error(re(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return kh(a),e;if(s===n)return kh(a),t;s=s.sibling}throw Error(re(188))}if(r.return!==n.return)r=a,n=s;else{for(var l=!1,o=a.child;o;){if(o===r){l=!0,r=a,n=s;break}if(o===n){l=!0,n=a,r=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===r){l=!0,r=s,n=a;break}if(o===n){l=!0,n=s,r=a;break}o=o.sibling}if(!l)throw Error(re(189))}}if(r.alternate!==n)throw Error(re(190))}if(r.tag!==3)throw Error(re(188));return r.stateNode.current===r?e:t}function np(e){return e=i2(e),e!==null?ap(e):null}function ap(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ap(e);if(t!==null)return t;e=e.sibling}return null}var sp=yr.unstable_scheduleCallback,Ch=yr.unstable_cancelCallback,l2=yr.unstable_shouldYield,o2=yr.unstable_requestPaint,ot=yr.unstable_now,c2=yr.unstable_getCurrentPriorityLevel,Wd=yr.unstable_ImmediatePriority,ip=yr.unstable_UserBlockingPriority,Jo=yr.unstable_NormalPriority,u2=yr.unstable_LowPriority,lp=yr.unstable_IdlePriority,zc=null,an=null;function d2(e){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(zc,e,void 0,(e.current.flags&128)===128)}catch{}}var zr=Math.clz32?Math.clz32:m2,f2=Math.log,h2=Math.LN2;function m2(e){return e>>>=0,e===0?32:31-(f2(e)/h2|0)|0}var Zl=64,eo=4194304;function ji(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zo(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~a;o!==0?n=ji(o):(s&=l,s!==0&&(n=ji(s)))}else l=r&~a,l!==0?n=ji(l):s!==0&&(n=ji(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-zr(t),a=1<<r,n|=e[r],t&=~a;return n}function x2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function p2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-zr(s),o=1<<l,c=a[l];c===-1?(!(o&r)||o&n)&&(a[l]=x2(o,t)):c<=t&&(e.expiredLanes|=o),s&=~o}}function b0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function op(){var e=Zl;return Zl<<=1,!(Zl&4194240)&&(Zl=64),e}function ju(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Fl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-zr(t),e[t]=r}function g2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-zr(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function zd(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-zr(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Be=0;function cp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var up,Hd,dp,fp,hp,E0=!1,to=[],qn=null,Qn=null,Jn=null,el=new Map,tl=new Map,Wn=[],v2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ah(e,t){switch(e){case"focusin":case"focusout":qn=null;break;case"dragenter":case"dragleave":Qn=null;break;case"mouseover":case"mouseout":Jn=null;break;case"pointerover":case"pointerout":el.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":tl.delete(t.pointerId)}}function hi(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=Pl(t),t!==null&&Hd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function y2(e,t,r,n,a){switch(t){case"focusin":return qn=hi(qn,e,t,r,n,a),!0;case"dragenter":return Qn=hi(Qn,e,t,r,n,a),!0;case"mouseover":return Jn=hi(Jn,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return el.set(s,hi(el.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,tl.set(s,hi(tl.get(s)||null,e,t,r,n,a)),!0}return!1}function mp(e){var t=ja(e.target);if(t!==null){var r=Ga(t);if(r!==null){if(t=r.tag,t===13){if(t=rp(r),t!==null){e.blockedOn=t,hp(e.priority,function(){dp(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ao(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=j0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);y0=n,r.target.dispatchEvent(n),y0=null}else return t=Pl(r),t!==null&&Hd(t),e.blockedOn=r,!1;t.shift()}return!0}function Dh(e,t,r){Ao(e)&&r.delete(t)}function w2(){E0=!1,qn!==null&&Ao(qn)&&(qn=null),Qn!==null&&Ao(Qn)&&(Qn=null),Jn!==null&&Ao(Jn)&&(Jn=null),el.forEach(Dh),tl.forEach(Dh)}function mi(e,t){e.blockedOn===t&&(e.blockedOn=null,E0||(E0=!0,yr.unstable_scheduleCallback(yr.unstable_NormalPriority,w2)))}function rl(e){function t(a){return mi(a,e)}if(0<to.length){mi(to[0],e);for(var r=1;r<to.length;r++){var n=to[r];n.blockedOn===e&&(n.blockedOn=null)}}for(qn!==null&&mi(qn,e),Qn!==null&&mi(Qn,e),Jn!==null&&mi(Jn,e),el.forEach(t),tl.forEach(t),r=0;r<Wn.length;r++)n=Wn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Wn.length&&(r=Wn[0],r.blockedOn===null);)mp(r),r.blockedOn===null&&Wn.shift()}var Cs=On.ReactCurrentBatchConfig,ec=!0;function _2(e,t,r,n){var a=Be,s=Cs.transition;Cs.transition=null;try{Be=1,Vd(e,t,r,n)}finally{Be=a,Cs.transition=s}}function N2(e,t,r,n){var a=Be,s=Cs.transition;Cs.transition=null;try{Be=4,Vd(e,t,r,n)}finally{Be=a,Cs.transition=s}}function Vd(e,t,r,n){if(ec){var a=j0(e,t,r,n);if(a===null)Iu(e,t,n,tc,r),Ah(e,n);else if(y2(a,e,t,r,n))n.stopPropagation();else if(Ah(e,n),t&4&&-1<v2.indexOf(e)){for(;a!==null;){var s=Pl(a);if(s!==null&&up(s),s=j0(e,t,r,n),s===null&&Iu(e,t,n,tc,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Iu(e,t,n,null,r)}}var tc=null;function j0(e,t,r,n){if(tc=null,e=$d(n),e=ja(e),e!==null)if(t=Ga(e),t===null)e=null;else if(r=t.tag,r===13){if(e=rp(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return tc=e,null}function xp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(c2()){case Wd:return 1;case ip:return 4;case Jo:case u2:return 16;case lp:return 536870912;default:return 16}default:return 16}}var Kn=null,Kd=null,Do=null;function pp(){if(Do)return Do;var e,t=Kd,r=t.length,n,a="value"in Kn?Kn.value:Kn.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===a[s-n];n++);return Do=a.slice(e,1<n?1-n:void 0)}function Fo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ro(){return!0}function Fh(){return!1}function br(e){function t(r,n,a,s,l){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ro:Fh,this.isPropagationStopped=Fh,this}return nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ro)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ro)},persist:function(){},isPersistent:ro}),t}var Qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gd=br(Qs),Ol=nt({},Qs,{view:0,detail:0}),b2=br(Ol),Su,Tu,xi,Hc=nt({},Ol,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==xi&&(xi&&e.type==="mousemove"?(Su=e.screenX-xi.screenX,Tu=e.screenY-xi.screenY):Tu=Su=0,xi=e),Su)},movementY:function(e){return"movementY"in e?e.movementY:Tu}}),Oh=br(Hc),E2=nt({},Hc,{dataTransfer:0}),j2=br(E2),S2=nt({},Ol,{relatedTarget:0}),ku=br(S2),T2=nt({},Qs,{animationName:0,elapsedTime:0,pseudoElement:0}),k2=br(T2),C2=nt({},Qs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),A2=br(C2),D2=nt({},Qs,{data:0}),Ph=br(D2),F2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},P2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=P2[e])?!!t[e]:!1}function Xd(){return I2}var R2=nt({},Ol,{key:function(e){if(e.key){var t=F2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Fo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?O2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xd,charCode:function(e){return e.type==="keypress"?Fo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Fo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),L2=br(R2),M2=nt({},Hc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ih=br(M2),B2=nt({},Ol,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xd}),U2=br(B2),$2=nt({},Qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),W2=br($2),z2=nt({},Hc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),H2=br(z2),V2=[9,13,27,32],Yd=Sn&&"CompositionEvent"in window,Fi=null;Sn&&"documentMode"in document&&(Fi=document.documentMode);var K2=Sn&&"TextEvent"in window&&!Fi,gp=Sn&&(!Yd||Fi&&8<Fi&&11>=Fi),Rh=" ",Lh=!1;function vp(e,t){switch(e){case"keyup":return V2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ms=!1;function G2(e,t){switch(e){case"compositionend":return yp(t);case"keypress":return t.which!==32?null:(Lh=!0,Rh);case"textInput":return e=t.data,e===Rh&&Lh?null:e;default:return null}}function X2(e,t){if(ms)return e==="compositionend"||!Yd&&vp(e,t)?(e=pp(),Do=Kd=Kn=null,ms=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return gp&&t.locale!=="ko"?null:t.data;default:return null}}var Y2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Y2[e.type]:t==="textarea"}function wp(e,t,r,n){Qx(n),t=rc(t,"onChange"),0<t.length&&(r=new Gd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Oi=null,nl=null;function q2(e){Dp(e,0)}function Vc(e){var t=gs(e);if(Hx(t))return e}function Q2(e,t){if(e==="change")return t}var _p=!1;if(Sn){var Cu;if(Sn){var Au="oninput"in document;if(!Au){var Bh=document.createElement("div");Bh.setAttribute("oninput","return;"),Au=typeof Bh.oninput=="function"}Cu=Au}else Cu=!1;_p=Cu&&(!document.documentMode||9<document.documentMode)}function Uh(){Oi&&(Oi.detachEvent("onpropertychange",Np),nl=Oi=null)}function Np(e){if(e.propertyName==="value"&&Vc(nl)){var t=[];wp(t,nl,e,$d(e)),tp(q2,t)}}function J2(e,t,r){e==="focusin"?(Uh(),Oi=t,nl=r,Oi.attachEvent("onpropertychange",Np)):e==="focusout"&&Uh()}function Z2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Vc(nl)}function ew(e,t){if(e==="click")return Vc(t)}function tw(e,t){if(e==="input"||e==="change")return Vc(t)}function rw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xr=typeof Object.is=="function"?Object.is:rw;function al(e,t){if(Xr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!l0.call(t,a)||!Xr(e[a],t[a]))return!1}return!0}function $h(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Wh(e,t){var r=$h(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$h(r)}}function bp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?bp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ep(){for(var e=window,t=Yo();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Yo(e.document)}return t}function qd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function nw(e){var t=Ep(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&bp(r.ownerDocument.documentElement,r)){if(n!==null&&qd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Wh(r,s);var l=Wh(r,n);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var aw=Sn&&"documentMode"in document&&11>=document.documentMode,xs=null,S0=null,Pi=null,T0=!1;function zh(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;T0||xs==null||xs!==Yo(n)||(n=xs,"selectionStart"in n&&qd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Pi&&al(Pi,n)||(Pi=n,n=rc(S0,"onSelect"),0<n.length&&(t=new Gd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=xs)))}function no(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ps={animationend:no("Animation","AnimationEnd"),animationiteration:no("Animation","AnimationIteration"),animationstart:no("Animation","AnimationStart"),transitionend:no("Transition","TransitionEnd")},Du={},jp={};Sn&&(jp=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function Kc(e){if(Du[e])return Du[e];if(!ps[e])return e;var t=ps[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in jp)return Du[e]=t[r];return e}var Sp=Kc("animationend"),Tp=Kc("animationiteration"),kp=Kc("animationstart"),Cp=Kc("transitionend"),Ap=new Map,Hh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ma(e,t){Ap.set(e,t),Ka(t,[e])}for(var Fu=0;Fu<Hh.length;Fu++){var Ou=Hh[Fu],sw=Ou.toLowerCase(),iw=Ou[0].toUpperCase()+Ou.slice(1);ma(sw,"on"+iw)}ma(Sp,"onAnimationEnd");ma(Tp,"onAnimationIteration");ma(kp,"onAnimationStart");ma("dblclick","onDoubleClick");ma("focusin","onFocus");ma("focusout","onBlur");ma(Cp,"onTransitionEnd");Bs("onMouseEnter",["mouseout","mouseover"]);Bs("onMouseLeave",["mouseout","mouseover"]);Bs("onPointerEnter",["pointerout","pointerover"]);Bs("onPointerLeave",["pointerout","pointerover"]);Ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ka("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Si="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Si));function Vh(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,s2(n,t,void 0,e),e.currentTarget=null}function Dp(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==s&&a.isPropagationStopped())break e;Vh(a,o,u),s=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==s&&a.isPropagationStopped())break e;Vh(a,o,u),s=c}}}if(Qo)throw e=N0,Qo=!1,N0=null,e}function Ge(e,t){var r=t[F0];r===void 0&&(r=t[F0]=new Set);var n=e+"__bubble";r.has(n)||(Fp(t,e,2,!1),r.add(n))}function Pu(e,t,r){var n=0;t&&(n|=4),Fp(r,e,n,t)}var ao="_reactListening"+Math.random().toString(36).slice(2);function sl(e){if(!e[ao]){e[ao]=!0,Bx.forEach(function(r){r!=="selectionchange"&&(lw.has(r)||Pu(r,!1,e),Pu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ao]||(t[ao]=!0,Pu("selectionchange",!1,t))}}function Fp(e,t,r,n){switch(xp(t)){case 1:var a=_2;break;case 4:a=N2;break;default:a=Vd}r=a.bind(null,t,r,e),a=void 0,!_0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Iu(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=ja(o),l===null)return;if(c=l.tag,c===5||c===6){n=s=l;continue e}o=o.parentNode}}n=n.return}tp(function(){var u=s,d=$d(r),f=[];e:{var h=Ap.get(e);if(h!==void 0){var x=Gd,g=e;switch(e){case"keypress":if(Fo(r)===0)break e;case"keydown":case"keyup":x=L2;break;case"focusin":g="focus",x=ku;break;case"focusout":g="blur",x=ku;break;case"beforeblur":case"afterblur":x=ku;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Oh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=j2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=U2;break;case Sp:case Tp:case kp:x=k2;break;case Cp:x=W2;break;case"scroll":x=b2;break;case"wheel":x=H2;break;case"copy":case"cut":case"paste":x=A2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Ih}var m=(t&4)!==0,_=!m&&e==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var p=u,w;p!==null;){w=p;var T=w.stateNode;if(w.tag===5&&T!==null&&(w=T,v!==null&&(T=Zi(p,v),T!=null&&m.push(il(p,T,w)))),_)break;p=p.return}0<m.length&&(h=new x(h,g,null,r,d),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",h&&r!==y0&&(g=r.relatedTarget||r.fromElement)&&(ja(g)||g[Tn]))break e;if((x||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,x?(g=r.relatedTarget||r.toElement,x=u,g=g?ja(g):null,g!==null&&(_=Ga(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(x=null,g=u),x!==g)){if(m=Oh,T="onMouseLeave",v="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(m=Ih,T="onPointerLeave",v="onPointerEnter",p="pointer"),_=x==null?h:gs(x),w=g==null?h:gs(g),h=new m(T,p+"leave",x,r,d),h.target=_,h.relatedTarget=w,T=null,ja(d)===u&&(m=new m(v,p+"enter",g,r,d),m.target=w,m.relatedTarget=_,T=m),_=T,x&&g)t:{for(m=x,v=g,p=0,w=m;w;w=ns(w))p++;for(w=0,T=v;T;T=ns(T))w++;for(;0<p-w;)m=ns(m),p--;for(;0<w-p;)v=ns(v),w--;for(;p--;){if(m===v||v!==null&&m===v.alternate)break t;m=ns(m),v=ns(v)}m=null}else m=null;x!==null&&Kh(f,h,x,m,!1),g!==null&&_!==null&&Kh(f,_,g,m,!0)}}e:{if(h=u?gs(u):window,x=h.nodeName&&h.nodeName.toLowerCase(),x==="select"||x==="input"&&h.type==="file")var I=Q2;else if(Mh(h))if(_p)I=tw;else{I=Z2;var L=J2}else(x=h.nodeName)&&x.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(I=ew);if(I&&(I=I(e,u))){wp(f,I,r,d);break e}L&&L(e,h,u),e==="focusout"&&(L=h._wrapperState)&&L.controlled&&h.type==="number"&&m0(h,"number",h.value)}switch(L=u?gs(u):window,e){case"focusin":(Mh(L)||L.contentEditable==="true")&&(xs=L,S0=u,Pi=null);break;case"focusout":Pi=S0=xs=null;break;case"mousedown":T0=!0;break;case"contextmenu":case"mouseup":case"dragend":T0=!1,zh(f,r,d);break;case"selectionchange":if(aw)break;case"keydown":case"keyup":zh(f,r,d)}var j;if(Yd)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else ms?vp(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(gp&&r.locale!=="ko"&&(ms||A!=="onCompositionStart"?A==="onCompositionEnd"&&ms&&(j=pp()):(Kn=d,Kd="value"in Kn?Kn.value:Kn.textContent,ms=!0)),L=rc(u,A),0<L.length&&(A=new Ph(A,e,null,r,d),f.push({event:A,listeners:L}),j?A.data=j:(j=yp(r),j!==null&&(A.data=j)))),(j=K2?G2(e,r):X2(e,r))&&(u=rc(u,"onBeforeInput"),0<u.length&&(d=new Ph("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=j))}Dp(f,t)})}function il(e,t,r){return{instance:e,listener:t,currentTarget:r}}function rc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Zi(e,r),s!=null&&n.unshift(il(e,s,a)),s=Zi(e,t),s!=null&&n.push(il(e,s,a))),e=e.return}return n}function ns(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Kh(e,t,r,n,a){for(var s=t._reactName,l=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=Zi(r,s),c!=null&&l.unshift(il(r,c,o))):a||(c=Zi(r,s),c!=null&&l.push(il(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var ow=/\r\n?/g,cw=/\u0000|\uFFFD/g;function Gh(e){return(typeof e=="string"?e:""+e).replace(ow,`
`).replace(cw,"")}function so(e,t,r){if(t=Gh(t),Gh(e)!==t&&r)throw Error(re(425))}function nc(){}var k0=null,C0=null;function A0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var D0=typeof setTimeout=="function"?setTimeout:void 0,uw=typeof clearTimeout=="function"?clearTimeout:void 0,Xh=typeof Promise=="function"?Promise:void 0,dw=typeof queueMicrotask=="function"?queueMicrotask:typeof Xh<"u"?function(e){return Xh.resolve(null).then(e).catch(fw)}:D0;function fw(e){setTimeout(function(){throw e})}function Ru(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),rl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);rl(t)}function Zn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Yh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Js=Math.random().toString(36).slice(2),rn="__reactFiber$"+Js,ll="__reactProps$"+Js,Tn="__reactContainer$"+Js,F0="__reactEvents$"+Js,hw="__reactListeners$"+Js,mw="__reactHandles$"+Js;function ja(e){var t=e[rn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Tn]||r[rn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Yh(e);e!==null;){if(r=e[rn])return r;e=Yh(e)}return t}e=r,r=e.parentNode}return null}function Pl(e){return e=e[rn]||e[Tn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(re(33))}function Gc(e){return e[ll]||null}var O0=[],vs=-1;function xa(e){return{current:e}}function Ye(e){0>vs||(e.current=O0[vs],O0[vs]=null,vs--)}function Ke(e,t){vs++,O0[vs]=e.current,e.current=t}var sa={},zt=xa(sa),nr=xa(!1),Ia=sa;function Us(e,t){var r=e.type.contextTypes;if(!r)return sa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ar(e){return e=e.childContextTypes,e!=null}function ac(){Ye(nr),Ye(zt)}function qh(e,t,r){if(zt.current!==sa)throw Error(re(168));Ke(zt,t),Ke(nr,r)}function Op(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(re(108,Jy(e)||"Unknown",a));return nt({},r,n)}function sc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||sa,Ia=zt.current,Ke(zt,e),Ke(nr,nr.current),!0}function Qh(e,t,r){var n=e.stateNode;if(!n)throw Error(re(169));r?(e=Op(e,t,Ia),n.__reactInternalMemoizedMergedChildContext=e,Ye(nr),Ye(zt),Ke(zt,e)):Ye(nr),Ke(nr,r)}var mn=null,Xc=!1,Lu=!1;function Pp(e){mn===null?mn=[e]:mn.push(e)}function xw(e){Xc=!0,Pp(e)}function pa(){if(!Lu&&mn!==null){Lu=!0;var e=0,t=Be;try{var r=mn;for(Be=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}mn=null,Xc=!1}catch(a){throw mn!==null&&(mn=mn.slice(e+1)),sp(Wd,pa),a}finally{Be=t,Lu=!1}}return null}var ys=[],ws=0,ic=null,lc=0,Tr=[],kr=0,Ra=null,gn=1,vn="";function Na(e,t){ys[ws++]=lc,ys[ws++]=ic,ic=e,lc=t}function Ip(e,t,r){Tr[kr++]=gn,Tr[kr++]=vn,Tr[kr++]=Ra,Ra=e;var n=gn;e=vn;var a=32-zr(n)-1;n&=~(1<<a),r+=1;var s=32-zr(t)+a;if(30<s){var l=a-a%5;s=(n&(1<<l)-1).toString(32),n>>=l,a-=l,gn=1<<32-zr(t)+a|r<<a|n,vn=s+e}else gn=1<<s|r<<a|n,vn=e}function Qd(e){e.return!==null&&(Na(e,1),Ip(e,1,0))}function Jd(e){for(;e===ic;)ic=ys[--ws],ys[ws]=null,lc=ys[--ws],ys[ws]=null;for(;e===Ra;)Ra=Tr[--kr],Tr[kr]=null,vn=Tr[--kr],Tr[kr]=null,gn=Tr[--kr],Tr[kr]=null}var vr=null,pr=null,Je=!1,Ur=null;function Rp(e,t){var r=Cr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Jh(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vr=e,pr=Zn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vr=e,pr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ra!==null?{id:gn,overflow:vn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Cr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,vr=e,pr=null,!0):!1;default:return!1}}function P0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function I0(e){if(Je){var t=pr;if(t){var r=t;if(!Jh(e,t)){if(P0(e))throw Error(re(418));t=Zn(r.nextSibling);var n=vr;t&&Jh(e,t)?Rp(n,r):(e.flags=e.flags&-4097|2,Je=!1,vr=e)}}else{if(P0(e))throw Error(re(418));e.flags=e.flags&-4097|2,Je=!1,vr=e}}}function Zh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vr=e}function io(e){if(e!==vr)return!1;if(!Je)return Zh(e),Je=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!A0(e.type,e.memoizedProps)),t&&(t=pr)){if(P0(e))throw Lp(),Error(re(418));for(;t;)Rp(e,t),t=Zn(t.nextSibling)}if(Zh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){pr=Zn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}pr=null}}else pr=vr?Zn(e.stateNode.nextSibling):null;return!0}function Lp(){for(var e=pr;e;)e=Zn(e.nextSibling)}function $s(){pr=vr=null,Je=!1}function Zd(e){Ur===null?Ur=[e]:Ur.push(e)}var pw=On.ReactCurrentBatchConfig;function pi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(re(309));var n=r.stateNode}if(!n)throw Error(re(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(l){var o=a.refs;l===null?delete o[s]:o[s]=l},t._stringRef=s,t)}if(typeof e!="string")throw Error(re(284));if(!r._owner)throw Error(re(290,e))}return e}function lo(e,t){throw e=Object.prototype.toString.call(t),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function em(e){var t=e._init;return t(e._payload)}function Mp(e){function t(v,p){if(e){var w=v.deletions;w===null?(v.deletions=[p],v.flags|=16):w.push(p)}}function r(v,p){if(!e)return null;for(;p!==null;)t(v,p),p=p.sibling;return null}function n(v,p){for(v=new Map;p!==null;)p.key!==null?v.set(p.key,p):v.set(p.index,p),p=p.sibling;return v}function a(v,p){return v=na(v,p),v.index=0,v.sibling=null,v}function s(v,p,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<p?(v.flags|=2,p):w):(v.flags|=2,p)):(v.flags|=1048576,p)}function l(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,p,w,T){return p===null||p.tag!==6?(p=Hu(w,v.mode,T),p.return=v,p):(p=a(p,w),p.return=v,p)}function c(v,p,w,T){var I=w.type;return I===hs?d(v,p,w.props.children,T,w.key):p!==null&&(p.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Bn&&em(I)===p.type)?(T=a(p,w.props),T.ref=pi(v,p,w),T.return=v,T):(T=Bo(w.type,w.key,w.props,null,v.mode,T),T.ref=pi(v,p,w),T.return=v,T)}function u(v,p,w,T){return p===null||p.tag!==4||p.stateNode.containerInfo!==w.containerInfo||p.stateNode.implementation!==w.implementation?(p=Vu(w,v.mode,T),p.return=v,p):(p=a(p,w.children||[]),p.return=v,p)}function d(v,p,w,T,I){return p===null||p.tag!==7?(p=Aa(w,v.mode,T,I),p.return=v,p):(p=a(p,w),p.return=v,p)}function f(v,p,w){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Hu(""+p,v.mode,w),p.return=v,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case ql:return w=Bo(p.type,p.key,p.props,null,v.mode,w),w.ref=pi(v,null,p),w.return=v,w;case fs:return p=Vu(p,v.mode,w),p.return=v,p;case Bn:var T=p._init;return f(v,T(p._payload),w)}if(Ei(p)||di(p))return p=Aa(p,v.mode,w,null),p.return=v,p;lo(v,p)}return null}function h(v,p,w,T){var I=p!==null?p.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return I!==null?null:o(v,p,""+w,T);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ql:return w.key===I?c(v,p,w,T):null;case fs:return w.key===I?u(v,p,w,T):null;case Bn:return I=w._init,h(v,p,I(w._payload),T)}if(Ei(w)||di(w))return I!==null?null:d(v,p,w,T,null);lo(v,w)}return null}function x(v,p,w,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(w)||null,o(p,v,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ql:return v=v.get(T.key===null?w:T.key)||null,c(p,v,T,I);case fs:return v=v.get(T.key===null?w:T.key)||null,u(p,v,T,I);case Bn:var L=T._init;return x(v,p,w,L(T._payload),I)}if(Ei(T)||di(T))return v=v.get(w)||null,d(p,v,T,I,null);lo(p,T)}return null}function g(v,p,w,T){for(var I=null,L=null,j=p,A=p=0,y=null;j!==null&&A<w.length;A++){j.index>A?(y=j,j=null):y=j.sibling;var O=h(v,j,w[A],T);if(O===null){j===null&&(j=y);break}e&&j&&O.alternate===null&&t(v,j),p=s(O,p,A),L===null?I=O:L.sibling=O,L=O,j=y}if(A===w.length)return r(v,j),Je&&Na(v,A),I;if(j===null){for(;A<w.length;A++)j=f(v,w[A],T),j!==null&&(p=s(j,p,A),L===null?I=j:L.sibling=j,L=j);return Je&&Na(v,A),I}for(j=n(v,j);A<w.length;A++)y=x(j,v,A,w[A],T),y!==null&&(e&&y.alternate!==null&&j.delete(y.key===null?A:y.key),p=s(y,p,A),L===null?I=y:L.sibling=y,L=y);return e&&j.forEach(function(B){return t(v,B)}),Je&&Na(v,A),I}function m(v,p,w,T){var I=di(w);if(typeof I!="function")throw Error(re(150));if(w=I.call(w),w==null)throw Error(re(151));for(var L=I=null,j=p,A=p=0,y=null,O=w.next();j!==null&&!O.done;A++,O=w.next()){j.index>A?(y=j,j=null):y=j.sibling;var B=h(v,j,O.value,T);if(B===null){j===null&&(j=y);break}e&&j&&B.alternate===null&&t(v,j),p=s(B,p,A),L===null?I=B:L.sibling=B,L=B,j=y}if(O.done)return r(v,j),Je&&Na(v,A),I;if(j===null){for(;!O.done;A++,O=w.next())O=f(v,O.value,T),O!==null&&(p=s(O,p,A),L===null?I=O:L.sibling=O,L=O);return Je&&Na(v,A),I}for(j=n(v,j);!O.done;A++,O=w.next())O=x(j,v,A,O.value,T),O!==null&&(e&&O.alternate!==null&&j.delete(O.key===null?A:O.key),p=s(O,p,A),L===null?I=O:L.sibling=O,L=O);return e&&j.forEach(function(H){return t(v,H)}),Je&&Na(v,A),I}function _(v,p,w,T){if(typeof w=="object"&&w!==null&&w.type===hs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ql:e:{for(var I=w.key,L=p;L!==null;){if(L.key===I){if(I=w.type,I===hs){if(L.tag===7){r(v,L.sibling),p=a(L,w.props.children),p.return=v,v=p;break e}}else if(L.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Bn&&em(I)===L.type){r(v,L.sibling),p=a(L,w.props),p.ref=pi(v,L,w),p.return=v,v=p;break e}r(v,L);break}else t(v,L);L=L.sibling}w.type===hs?(p=Aa(w.props.children,v.mode,T,w.key),p.return=v,v=p):(T=Bo(w.type,w.key,w.props,null,v.mode,T),T.ref=pi(v,p,w),T.return=v,v=T)}return l(v);case fs:e:{for(L=w.key;p!==null;){if(p.key===L)if(p.tag===4&&p.stateNode.containerInfo===w.containerInfo&&p.stateNode.implementation===w.implementation){r(v,p.sibling),p=a(p,w.children||[]),p.return=v,v=p;break e}else{r(v,p);break}else t(v,p);p=p.sibling}p=Vu(w,v.mode,T),p.return=v,v=p}return l(v);case Bn:return L=w._init,_(v,p,L(w._payload),T)}if(Ei(w))return g(v,p,w,T);if(di(w))return m(v,p,w,T);lo(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,p!==null&&p.tag===6?(r(v,p.sibling),p=a(p,w),p.return=v,v=p):(r(v,p),p=Hu(w,v.mode,T),p.return=v,v=p),l(v)):r(v,p)}return _}var Ws=Mp(!0),Bp=Mp(!1),oc=xa(null),cc=null,_s=null,ef=null;function tf(){ef=_s=cc=null}function rf(e){var t=oc.current;Ye(oc),e._currentValue=t}function R0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function As(e,t){cc=e,ef=_s=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(tr=!0),e.firstContext=null)}function Fr(e){var t=e._currentValue;if(ef!==e)if(e={context:e,memoizedValue:t,next:null},_s===null){if(cc===null)throw Error(re(308));_s=e,cc.dependencies={lanes:0,firstContext:e}}else _s=_s.next=e;return t}var Sa=null;function nf(e){Sa===null?Sa=[e]:Sa.push(e)}function Up(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,nf(t)):(r.next=a.next,a.next=r),t.interleaved=r,kn(e,n)}function kn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Un=!1;function af(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $p(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function wn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ea(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Fe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,kn(e,r)}return a=n.interleaved,a===null?(t.next=t,nf(n)):(t.next=a.next,a.next=t),n.interleaved=t,kn(e,r)}function Oo(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zd(e,r)}}function tm(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=l:s=s.next=l,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function uc(e,t,r,n){var a=e.updateQueue;Un=!1;var s=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?s=u:l.next=u,l=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;l=0,d=u=c=null,o=s;do{var h=o.lane,x=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(h=t,x=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(x,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(x,f,h):g,h==null)break e;f=nt({},f,h);break e;case 2:Un=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else x={eventTime:x,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=x,c=f):d=d.next=x,l|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Ma|=l,e.lanes=l,e.memoizedState=f}}function rm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(re(191,a));a.call(n)}}}var Il={},sn=xa(Il),ol=xa(Il),cl=xa(Il);function Ta(e){if(e===Il)throw Error(re(174));return e}function sf(e,t){switch(Ke(cl,t),Ke(ol,e),Ke(sn,Il),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:p0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=p0(t,e)}Ye(sn),Ke(sn,t)}function zs(){Ye(sn),Ye(ol),Ye(cl)}function Wp(e){Ta(cl.current);var t=Ta(sn.current),r=p0(t,e.type);t!==r&&(Ke(ol,e),Ke(sn,r))}function lf(e){ol.current===e&&(Ye(sn),Ye(ol))}var tt=xa(0);function dc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Mu=[];function of(){for(var e=0;e<Mu.length;e++)Mu[e]._workInProgressVersionPrimary=null;Mu.length=0}var Po=On.ReactCurrentDispatcher,Bu=On.ReactCurrentBatchConfig,La=0,rt=null,xt=null,yt=null,fc=!1,Ii=!1,ul=0,gw=0;function It(){throw Error(re(321))}function cf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xr(e[r],t[r]))return!1;return!0}function uf(e,t,r,n,a,s){if(La=s,rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Po.current=e===null||e.memoizedState===null?_w:Nw,e=r(n,a),Ii){s=0;do{if(Ii=!1,ul=0,25<=s)throw Error(re(301));s+=1,yt=xt=null,t.updateQueue=null,Po.current=bw,e=r(n,a)}while(Ii)}if(Po.current=hc,t=xt!==null&&xt.next!==null,La=0,yt=xt=rt=null,fc=!1,t)throw Error(re(300));return e}function df(){var e=ul!==0;return ul=0,e}function en(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?rt.memoizedState=yt=e:yt=yt.next=e,yt}function Or(){if(xt===null){var e=rt.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=yt===null?rt.memoizedState:yt.next;if(t!==null)yt=t,xt=e;else{if(e===null)throw Error(re(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},yt===null?rt.memoizedState=yt=e:yt=yt.next=e}return yt}function dl(e,t){return typeof t=="function"?t(e):t}function Uu(e){var t=Or(),r=t.queue;if(r===null)throw Error(re(311));r.lastRenderedReducer=e;var n=xt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var l=a.next;a.next=s.next,s.next=l}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=l=null,c=null,u=s;do{var d=u.lane;if((La&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,l=n):c=c.next=f,rt.lanes|=d,Ma|=d}u=u.next}while(u!==null&&u!==s);c===null?l=n:c.next=o,Xr(n,t.memoizedState)||(tr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,rt.lanes|=s,Ma|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function $u(e){var t=Or(),r=t.queue;if(r===null)throw Error(re(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var l=a=a.next;do s=e(s,l.action),l=l.next;while(l!==a);Xr(s,t.memoizedState)||(tr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function zp(){}function Hp(e,t){var r=rt,n=Or(),a=t(),s=!Xr(n.memoizedState,a);if(s&&(n.memoizedState=a,tr=!0),n=n.queue,ff(Gp.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||yt!==null&&yt.memoizedState.tag&1){if(r.flags|=2048,fl(9,Kp.bind(null,r,n,a,t),void 0,null),bt===null)throw Error(re(349));La&30||Vp(r,t,a)}return a}function Vp(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Kp(e,t,r,n){t.value=r,t.getSnapshot=n,Xp(t)&&Yp(e)}function Gp(e,t,r){return r(function(){Xp(t)&&Yp(e)})}function Xp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xr(e,r)}catch{return!0}}function Yp(e){var t=kn(e,1);t!==null&&Hr(t,e,1,-1)}function nm(e){var t=en();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dl,lastRenderedState:e},t.queue=e,e=e.dispatch=ww.bind(null,rt,e),[t.memoizedState,e]}function fl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function qp(){return Or().memoizedState}function Io(e,t,r,n){var a=en();rt.flags|=e,a.memoizedState=fl(1|t,r,void 0,n===void 0?null:n)}function Yc(e,t,r,n){var a=Or();n=n===void 0?null:n;var s=void 0;if(xt!==null){var l=xt.memoizedState;if(s=l.destroy,n!==null&&cf(n,l.deps)){a.memoizedState=fl(t,r,s,n);return}}rt.flags|=e,a.memoizedState=fl(1|t,r,s,n)}function am(e,t){return Io(8390656,8,e,t)}function ff(e,t){return Yc(2048,8,e,t)}function Qp(e,t){return Yc(4,2,e,t)}function Jp(e,t){return Yc(4,4,e,t)}function Zp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function eg(e,t,r){return r=r!=null?r.concat([e]):null,Yc(4,4,Zp.bind(null,t,e),r)}function hf(){}function tg(e,t){var r=Or();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&cf(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function rg(e,t){var r=Or();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&cf(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function ng(e,t,r){return La&21?(Xr(r,t)||(r=op(),rt.lanes|=r,Ma|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,tr=!0),e.memoizedState=r)}function vw(e,t){var r=Be;Be=r!==0&&4>r?r:4,e(!0);var n=Bu.transition;Bu.transition={};try{e(!1),t()}finally{Be=r,Bu.transition=n}}function ag(){return Or().memoizedState}function yw(e,t,r){var n=ra(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},sg(e))ig(t,r);else if(r=Up(e,t,r,n),r!==null){var a=Yt();Hr(r,e,n,a),lg(r,t,n)}}function ww(e,t,r){var n=ra(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(sg(e))ig(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var l=t.lastRenderedState,o=s(l,r);if(a.hasEagerState=!0,a.eagerState=o,Xr(o,l)){var c=t.interleaved;c===null?(a.next=a,nf(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=Up(e,t,a,n),r!==null&&(a=Yt(),Hr(r,e,n,a),lg(r,t,n))}}function sg(e){var t=e.alternate;return e===rt||t!==null&&t===rt}function ig(e,t){Ii=fc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function lg(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zd(e,r)}}var hc={readContext:Fr,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},_w={readContext:Fr,useCallback:function(e,t){return en().memoizedState=[e,t===void 0?null:t],e},useContext:Fr,useEffect:am,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Io(4194308,4,Zp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Io(4194308,4,e,t)},useInsertionEffect:function(e,t){return Io(4,2,e,t)},useMemo:function(e,t){var r=en();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=en();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=yw.bind(null,rt,e),[n.memoizedState,e]},useRef:function(e){var t=en();return e={current:e},t.memoizedState=e},useState:nm,useDebugValue:hf,useDeferredValue:function(e){return en().memoizedState=e},useTransition:function(){var e=nm(!1),t=e[0];return e=vw.bind(null,e[1]),en().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rt,a=en();if(Je){if(r===void 0)throw Error(re(407));r=r()}else{if(r=t(),bt===null)throw Error(re(349));La&30||Vp(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,am(Gp.bind(null,n,s,e),[e]),n.flags|=2048,fl(9,Kp.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=en(),t=bt.identifierPrefix;if(Je){var r=vn,n=gn;r=(n&~(1<<32-zr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ul++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=gw++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Nw={readContext:Fr,useCallback:tg,useContext:Fr,useEffect:ff,useImperativeHandle:eg,useInsertionEffect:Qp,useLayoutEffect:Jp,useMemo:rg,useReducer:Uu,useRef:qp,useState:function(){return Uu(dl)},useDebugValue:hf,useDeferredValue:function(e){var t=Or();return ng(t,xt.memoizedState,e)},useTransition:function(){var e=Uu(dl)[0],t=Or().memoizedState;return[e,t]},useMutableSource:zp,useSyncExternalStore:Hp,useId:ag,unstable_isNewReconciler:!1},bw={readContext:Fr,useCallback:tg,useContext:Fr,useEffect:ff,useImperativeHandle:eg,useInsertionEffect:Qp,useLayoutEffect:Jp,useMemo:rg,useReducer:$u,useRef:qp,useState:function(){return $u(dl)},useDebugValue:hf,useDeferredValue:function(e){var t=Or();return xt===null?t.memoizedState=e:ng(t,xt.memoizedState,e)},useTransition:function(){var e=$u(dl)[0],t=Or().memoizedState;return[e,t]},useMutableSource:zp,useSyncExternalStore:Hp,useId:ag,unstable_isNewReconciler:!1};function Mr(e,t){if(e&&e.defaultProps){t=nt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function L0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qc={isMounted:function(e){return(e=e._reactInternals)?Ga(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Yt(),a=ra(e),s=wn(n,a);s.payload=t,r!=null&&(s.callback=r),t=ea(e,s,a),t!==null&&(Hr(t,e,a,n),Oo(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Yt(),a=ra(e),s=wn(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ea(e,s,a),t!==null&&(Hr(t,e,a,n),Oo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Yt(),n=ra(e),a=wn(r,n);a.tag=2,t!=null&&(a.callback=t),t=ea(e,a,n),t!==null&&(Hr(t,e,n,r),Oo(t,e,n))}};function sm(e,t,r,n,a,s,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,l):t.prototype&&t.prototype.isPureReactComponent?!al(r,n)||!al(a,s):!0}function og(e,t,r){var n=!1,a=sa,s=t.contextType;return typeof s=="object"&&s!==null?s=Fr(s):(a=ar(t)?Ia:zt.current,n=t.contextTypes,s=(n=n!=null)?Us(e,a):sa),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function im(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&qc.enqueueReplaceState(t,t.state,null)}function M0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},af(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Fr(s):(s=ar(t)?Ia:zt.current,a.context=Us(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(L0(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&qc.enqueueReplaceState(a,a.state,null),uc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Hs(e,t){try{var r="",n=t;do r+=Qy(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Wu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function B0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Ew=typeof WeakMap=="function"?WeakMap:Map;function cg(e,t,r){r=wn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){xc||(xc=!0,Y0=n),B0(e,t)},r}function ug(e,t,r){r=wn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){B0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){B0(e,t),typeof n!="function"&&(ta===null?ta=new Set([this]):ta.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function lm(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Ew;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Mw.bind(null,e,t,r),t.then(e,e))}function om(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function cm(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=wn(-1,1),t.tag=2,ea(r,t,1))),r.lanes|=1),e)}var jw=On.ReactCurrentOwner,tr=!1;function Vt(e,t,r,n){t.child=e===null?Bp(t,null,r,n):Ws(t,e.child,r,n)}function um(e,t,r,n,a){r=r.render;var s=t.ref;return As(t,a),n=uf(e,t,r,n,s,a),r=df(),e!==null&&!tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Cn(e,t,a)):(Je&&r&&Qd(t),t.flags|=1,Vt(e,t,n,a),t.child)}function dm(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!_f(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,dg(e,t,s,n,a)):(e=Bo(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var l=s.memoizedProps;if(r=r.compare,r=r!==null?r:al,r(l,n)&&e.ref===t.ref)return Cn(e,t,a)}return t.flags|=1,e=na(s,n),e.ref=t.ref,e.return=t,t.child=e}function dg(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(al(s,n)&&e.ref===t.ref)if(tr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(tr=!0);else return t.lanes=e.lanes,Cn(e,t,a)}return U0(e,t,r,n,a)}function fg(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(bs,fr),fr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ke(bs,fr),fr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Ke(bs,fr),fr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Ke(bs,fr),fr|=n;return Vt(e,t,a,r),t.child}function hg(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function U0(e,t,r,n,a){var s=ar(r)?Ia:zt.current;return s=Us(t,s),As(t,a),r=uf(e,t,r,n,s,a),n=df(),e!==null&&!tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Cn(e,t,a)):(Je&&n&&Qd(t),t.flags|=1,Vt(e,t,r,a),t.child)}function fm(e,t,r,n,a){if(ar(r)){var s=!0;sc(t)}else s=!1;if(As(t,a),t.stateNode===null)Ro(e,t),og(t,r,n),M0(t,r,n,a),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,u=r.contextType;typeof u=="object"&&u!==null?u=Fr(u):(u=ar(r)?Ia:zt.current,u=Us(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==u)&&im(t,l,n,u),Un=!1;var h=t.memoizedState;l.state=h,uc(t,n,l,a),c=t.memoizedState,o!==n||h!==c||nr.current||Un?(typeof d=="function"&&(L0(t,r,d,n),c=t.memoizedState),(o=Un||sm(t,r,o,n,h,c,u))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),l.props=n,l.state=c,l.context=u,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,$p(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Mr(t.type,o),l.props=u,f=t.pendingProps,h=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=Fr(c):(c=ar(r)?Ia:zt.current,c=Us(t,c));var x=r.getDerivedStateFromProps;(d=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==f||h!==c)&&im(t,l,n,c),Un=!1,h=t.memoizedState,l.state=h,uc(t,n,l,a);var g=t.memoizedState;o!==f||h!==g||nr.current||Un?(typeof x=="function"&&(L0(t,r,x,n),g=t.memoizedState),(u=Un||sm(t,r,u,n,h,g,c)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,g,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,g,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),l.props=n,l.state=g,l.context=c,n=u):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return $0(e,t,r,n,s,a)}function $0(e,t,r,n,a,s){hg(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return a&&Qh(t,r,!1),Cn(e,t,s);n=t.stateNode,jw.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=Ws(t,e.child,null,s),t.child=Ws(t,null,o,s)):Vt(e,t,o,s),t.memoizedState=n.state,a&&Qh(t,r,!0),t.child}function mg(e){var t=e.stateNode;t.pendingContext?qh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qh(e,t.context,!1),sf(e,t.containerInfo)}function hm(e,t,r,n,a){return $s(),Zd(a),t.flags|=256,Vt(e,t,r,n),t.child}var W0={dehydrated:null,treeContext:null,retryLane:0};function z0(e){return{baseLanes:e,cachePool:null,transitions:null}}function xg(e,t,r){var n=t.pendingProps,a=tt.current,s=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ke(tt,a&1),e===null)return I0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=Zc(l,n,0,null),e=Aa(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=z0(r),t.memoizedState=W0,e):mf(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Sw(e,t,l,n,o,a,r);if(s){s=n.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=na(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=na(o,s):(s=Aa(s,l,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=e.child.memoizedState,l=l===null?z0(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=W0,n}return s=e.child,e=s.sibling,n=na(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function mf(e,t){return t=Zc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function oo(e,t,r,n){return n!==null&&Zd(n),Ws(t,e.child,null,r),e=mf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Sw(e,t,r,n,a,s,l){if(r)return t.flags&256?(t.flags&=-257,n=Wu(Error(re(422))),oo(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Zc({mode:"visible",children:n.children},a,0,null),s=Aa(s,a,l,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ws(t,e.child,null,l),t.child.memoizedState=z0(l),t.memoizedState=W0,s);if(!(t.mode&1))return oo(e,t,l,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(re(419)),n=Wu(s,n,void 0),oo(e,t,l,n)}if(o=(l&e.childLanes)!==0,tr||o){if(n=bt,n!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|l)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,kn(e,a),Hr(n,e,a,-1))}return wf(),n=Wu(Error(re(421))),oo(e,t,l,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Bw.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,pr=Zn(a.nextSibling),vr=t,Je=!0,Ur=null,e!==null&&(Tr[kr++]=gn,Tr[kr++]=vn,Tr[kr++]=Ra,gn=e.id,vn=e.overflow,Ra=t),t=mf(t,n.children),t.flags|=4096,t)}function mm(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),R0(e.return,t,r)}function zu(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function pg(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Vt(e,t,n.children,r),n=tt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mm(e,r,t);else if(e.tag===19)mm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ke(tt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&dc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),zu(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&dc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}zu(t,!0,r,null,s);break;case"together":zu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ro(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Cn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ma|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(re(153));if(t.child!==null){for(e=t.child,r=na(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=na(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Tw(e,t,r){switch(t.tag){case 3:mg(t),$s();break;case 5:Wp(t);break;case 1:ar(t.type)&&sc(t);break;case 4:sf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Ke(oc,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ke(tt,tt.current&1),t.flags|=128,null):r&t.child.childLanes?xg(e,t,r):(Ke(tt,tt.current&1),e=Cn(e,t,r),e!==null?e.sibling:null);Ke(tt,tt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return pg(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ke(tt,tt.current),n)break;return null;case 22:case 23:return t.lanes=0,fg(e,t,r)}return Cn(e,t,r)}var gg,H0,vg,yg;gg=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};H0=function(){};vg=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ta(sn.current);var s=null;switch(r){case"input":a=f0(e,a),n=f0(e,n),s=[];break;case"select":a=nt({},a,{value:void 0}),n=nt({},n,{value:void 0}),s=[];break;case"textarea":a=x0(e,a),n=x0(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=nc)}g0(r,n);var l;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Qi.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Qi.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ge("scroll",e),s||o===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};yg=function(e,t,r,n){r!==n&&(t.flags|=4)};function gi(e,t){if(!Je)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function kw(e,t,r){var n=t.pendingProps;switch(Jd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(t),null;case 1:return ar(t.type)&&ac(),Rt(t),null;case 3:return n=t.stateNode,zs(),Ye(nr),Ye(zt),of(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(io(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ur!==null&&(J0(Ur),Ur=null))),H0(e,t),Rt(t),null;case 5:lf(t);var a=Ta(cl.current);if(r=t.type,e!==null&&t.stateNode!=null)vg(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(re(166));return Rt(t),null}if(e=Ta(sn.current),io(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[rn]=t,n[ll]=s,e=(t.mode&1)!==0,r){case"dialog":Ge("cancel",n),Ge("close",n);break;case"iframe":case"object":case"embed":Ge("load",n);break;case"video":case"audio":for(a=0;a<Si.length;a++)Ge(Si[a],n);break;case"source":Ge("error",n);break;case"img":case"image":case"link":Ge("error",n),Ge("load",n);break;case"details":Ge("toggle",n);break;case"input":bh(n,s),Ge("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ge("invalid",n);break;case"textarea":jh(n,s),Ge("invalid",n)}g0(r,s),a=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&so(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&so(n.textContent,o,e),a=["children",""+o]):Qi.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Ge("scroll",n)}switch(r){case"input":Ql(n),Eh(n,s,!0);break;case"textarea":Ql(n),Sh(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=nc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Gx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[rn]=t,e[ll]=n,gg(e,t,!1,!1),t.stateNode=e;e:{switch(l=v0(r,n),r){case"dialog":Ge("cancel",e),Ge("close",e),a=n;break;case"iframe":case"object":case"embed":Ge("load",e),a=n;break;case"video":case"audio":for(a=0;a<Si.length;a++)Ge(Si[a],e);a=n;break;case"source":Ge("error",e),a=n;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),a=n;break;case"details":Ge("toggle",e),a=n;break;case"input":bh(e,n),a=f0(e,n),Ge("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=nt({},n,{value:void 0}),Ge("invalid",e);break;case"textarea":jh(e,n),a=x0(e,n),Ge("invalid",e);break;default:a=n}g0(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?qx(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Xx(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Ji(e,c):typeof c=="number"&&Ji(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Qi.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ge("scroll",e):c!=null&&Ld(e,s,c,l))}switch(r){case"input":Ql(e),Eh(e,n,!1);break;case"textarea":Ql(e),Sh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+aa(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Ss(e,!!n.multiple,s,!1):n.defaultValue!=null&&Ss(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=nc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Rt(t),null;case 6:if(e&&t.stateNode!=null)yg(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(re(166));if(r=Ta(cl.current),Ta(sn.current),io(t)){if(n=t.stateNode,r=t.memoizedProps,n[rn]=t,(s=n.nodeValue!==r)&&(e=vr,e!==null))switch(e.tag){case 3:so(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&so(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[rn]=t,t.stateNode=n}return Rt(t),null;case 13:if(Ye(tt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Je&&pr!==null&&t.mode&1&&!(t.flags&128))Lp(),$s(),t.flags|=98560,s=!1;else if(s=io(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(re(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(re(317));s[rn]=t}else $s(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Rt(t),s=!1}else Ur!==null&&(J0(Ur),Ur=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||tt.current&1?pt===0&&(pt=3):wf())),t.updateQueue!==null&&(t.flags|=4),Rt(t),null);case 4:return zs(),H0(e,t),e===null&&sl(t.stateNode.containerInfo),Rt(t),null;case 10:return rf(t.type._context),Rt(t),null;case 17:return ar(t.type)&&ac(),Rt(t),null;case 19:if(Ye(tt),s=t.memoizedState,s===null)return Rt(t),null;if(n=(t.flags&128)!==0,l=s.rendering,l===null)if(n)gi(s,!1);else{if(pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=dc(e),l!==null){for(t.flags|=128,gi(s,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ke(tt,tt.current&1|2),t.child}e=e.sibling}s.tail!==null&&ot()>Vs&&(t.flags|=128,n=!0,gi(s,!1),t.lanes=4194304)}else{if(!n)if(e=dc(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),gi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!Je)return Rt(t),null}else 2*ot()-s.renderingStartTime>Vs&&r!==1073741824&&(t.flags|=128,n=!0,gi(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(r=s.last,r!==null?r.sibling=l:t.child=l,s.last=l)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ot(),t.sibling=null,r=tt.current,Ke(tt,n?r&1|2:r&1),t):(Rt(t),null);case 22:case 23:return yf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?fr&1073741824&&(Rt(t),t.subtreeFlags&6&&(t.flags|=8192)):Rt(t),null;case 24:return null;case 25:return null}throw Error(re(156,t.tag))}function Cw(e,t){switch(Jd(t),t.tag){case 1:return ar(t.type)&&ac(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return zs(),Ye(nr),Ye(zt),of(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lf(t),null;case 13:if(Ye(tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(re(340));$s()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ye(tt),null;case 4:return zs(),null;case 10:return rf(t.type._context),null;case 22:case 23:return yf(),null;case 24:return null;default:return null}}var co=!1,Lt=!1,Aw=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Ns(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){st(e,t,n)}else r.current=null}function V0(e,t,r){try{r()}catch(n){st(e,t,n)}}var xm=!1;function Dw(e,t){if(k0=ec,e=Ep(),qd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var x;f!==r||a!==0&&f.nodeType!==3||(o=l+a),f!==s||n!==0&&f.nodeType!==3||(c=l+n),f.nodeType===3&&(l+=f.nodeValue.length),(x=f.firstChild)!==null;)h=f,f=x;for(;;){if(f===e)break t;if(h===r&&++u===a&&(o=l),h===s&&++d===n&&(c=l),(x=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=x}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(C0={focusedElem:e,selectionRange:r},ec=!1,ge=t;ge!==null;)if(t=ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ge=e;else for(;ge!==null;){t=ge;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,_=g.memoizedState,v=t.stateNode,p=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:Mr(t.type,m),_);v.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(T){st(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,ge=e;break}ge=t.return}return g=xm,xm=!1,g}function Ri(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&V0(t,r,s)}a=a.next}while(a!==n)}}function Qc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function K0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function wg(e){var t=e.alternate;t!==null&&(e.alternate=null,wg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[rn],delete t[ll],delete t[F0],delete t[hw],delete t[mw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _g(e){return e.tag===5||e.tag===3||e.tag===4}function pm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_g(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function G0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=nc));else if(n!==4&&(e=e.child,e!==null))for(G0(e,t,r),e=e.sibling;e!==null;)G0(e,t,r),e=e.sibling}function X0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(X0(e,t,r),e=e.sibling;e!==null;)X0(e,t,r),e=e.sibling}var jt=null,Br=!1;function In(e,t,r){for(r=r.child;r!==null;)Ng(e,t,r),r=r.sibling}function Ng(e,t,r){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(zc,r)}catch{}switch(r.tag){case 5:Lt||Ns(r,t);case 6:var n=jt,a=Br;jt=null,In(e,t,r),jt=n,Br=a,jt!==null&&(Br?(e=jt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):jt.removeChild(r.stateNode));break;case 18:jt!==null&&(Br?(e=jt,r=r.stateNode,e.nodeType===8?Ru(e.parentNode,r):e.nodeType===1&&Ru(e,r),rl(e)):Ru(jt,r.stateNode));break;case 4:n=jt,a=Br,jt=r.stateNode.containerInfo,Br=!0,In(e,t,r),jt=n,Br=a;break;case 0:case 11:case 14:case 15:if(!Lt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&V0(r,t,l),a=a.next}while(a!==n)}In(e,t,r);break;case 1:if(!Lt&&(Ns(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){st(r,t,o)}In(e,t,r);break;case 21:In(e,t,r);break;case 22:r.mode&1?(Lt=(n=Lt)||r.memoizedState!==null,In(e,t,r),Lt=n):In(e,t,r);break;default:In(e,t,r)}}function gm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Aw),t.forEach(function(n){var a=Uw.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ir(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:jt=o.stateNode,Br=!1;break e;case 3:jt=o.stateNode.containerInfo,Br=!0;break e;case 4:jt=o.stateNode.containerInfo,Br=!0;break e}o=o.return}if(jt===null)throw Error(re(160));Ng(s,l,a),jt=null,Br=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){st(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)bg(t,e),t=t.sibling}function bg(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ir(t,e),qr(e),n&4){try{Ri(3,e,e.return),Qc(3,e)}catch(m){st(e,e.return,m)}try{Ri(5,e,e.return)}catch(m){st(e,e.return,m)}}break;case 1:Ir(t,e),qr(e),n&512&&r!==null&&Ns(r,r.return);break;case 5:if(Ir(t,e),qr(e),n&512&&r!==null&&Ns(r,r.return),e.flags&32){var a=e.stateNode;try{Ji(a,"")}catch(m){st(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,l=r!==null?r.memoizedProps:s,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Vx(a,s),v0(o,l);var u=v0(o,s);for(l=0;l<c.length;l+=2){var d=c[l],f=c[l+1];d==="style"?qx(a,f):d==="dangerouslySetInnerHTML"?Xx(a,f):d==="children"?Ji(a,f):Ld(a,d,f,u)}switch(o){case"input":h0(a,s);break;case"textarea":Kx(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?Ss(a,!!s.multiple,x,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ss(a,!!s.multiple,s.defaultValue,!0):Ss(a,!!s.multiple,s.multiple?[]:"",!1))}a[ll]=s}catch(m){st(e,e.return,m)}}break;case 6:if(Ir(t,e),qr(e),n&4){if(e.stateNode===null)throw Error(re(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){st(e,e.return,m)}}break;case 3:if(Ir(t,e),qr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{rl(t.containerInfo)}catch(m){st(e,e.return,m)}break;case 4:Ir(t,e),qr(e);break;case 13:Ir(t,e),qr(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(gf=ot())),n&4&&gm(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Lt=(u=Lt)||d,Ir(t,e),Lt=u):Ir(t,e),qr(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ge=e,d=e.child;d!==null;){for(f=ge=d;ge!==null;){switch(h=ge,x=h.child,h.tag){case 0:case 11:case 14:case 15:Ri(4,h,h.return);break;case 1:Ns(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){st(n,r,m)}}break;case 5:Ns(h,h.return);break;case 22:if(h.memoizedState!==null){ym(f);continue}}x!==null?(x.return=h,ge=x):ym(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,c=f.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Yx("display",l))}catch(m){st(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){st(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ir(t,e),qr(e),n&4&&gm(e);break;case 21:break;default:Ir(t,e),qr(e)}}function qr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(_g(r)){var n=r;break e}r=r.return}throw Error(re(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ji(a,""),n.flags&=-33);var s=pm(e);X0(e,s,a);break;case 3:case 4:var l=n.stateNode.containerInfo,o=pm(e);G0(e,o,l);break;default:throw Error(re(161))}}catch(c){st(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Fw(e,t,r){ge=e,Eg(e)}function Eg(e,t,r){for(var n=(e.mode&1)!==0;ge!==null;){var a=ge,s=a.child;if(a.tag===22&&n){var l=a.memoizedState!==null||co;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Lt;o=co;var u=Lt;if(co=l,(Lt=c)&&!u)for(ge=a;ge!==null;)l=ge,c=l.child,l.tag===22&&l.memoizedState!==null?wm(a):c!==null?(c.return=l,ge=c):wm(a);for(;s!==null;)ge=s,Eg(s),s=s.sibling;ge=a,co=o,Lt=u}vm(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,ge=s):vm(e)}}function vm(e){for(;ge!==null;){var t=ge;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lt||Qc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Lt)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Mr(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&rm(t,s,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}rm(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&rl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}Lt||t.flags&512&&K0(t)}catch(h){st(t,t.return,h)}}if(t===e){ge=null;break}if(r=t.sibling,r!==null){r.return=t.return,ge=r;break}ge=t.return}}function ym(e){for(;ge!==null;){var t=ge;if(t===e){ge=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ge=r;break}ge=t.return}}function wm(e){for(;ge!==null;){var t=ge;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Qc(4,t)}catch(c){st(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){st(t,a,c)}}var s=t.return;try{K0(t)}catch(c){st(t,s,c)}break;case 5:var l=t.return;try{K0(t)}catch(c){st(t,l,c)}}}catch(c){st(t,t.return,c)}if(t===e){ge=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ge=o;break}ge=t.return}}var Ow=Math.ceil,mc=On.ReactCurrentDispatcher,xf=On.ReactCurrentOwner,Ar=On.ReactCurrentBatchConfig,Fe=0,bt=null,ut=null,At=0,fr=0,bs=xa(0),pt=0,hl=null,Ma=0,Jc=0,pf=0,Li=null,er=null,gf=0,Vs=1/0,hn=null,xc=!1,Y0=null,ta=null,uo=!1,Gn=null,pc=0,Mi=0,q0=null,Lo=-1,Mo=0;function Yt(){return Fe&6?ot():Lo!==-1?Lo:Lo=ot()}function ra(e){return e.mode&1?Fe&2&&At!==0?At&-At:pw.transition!==null?(Mo===0&&(Mo=op()),Mo):(e=Be,e!==0||(e=window.event,e=e===void 0?16:xp(e.type)),e):1}function Hr(e,t,r,n){if(50<Mi)throw Mi=0,q0=null,Error(re(185));Fl(e,r,n),(!(Fe&2)||e!==bt)&&(e===bt&&(!(Fe&2)&&(Jc|=r),pt===4&&zn(e,At)),sr(e,n),r===1&&Fe===0&&!(t.mode&1)&&(Vs=ot()+500,Xc&&pa()))}function sr(e,t){var r=e.callbackNode;p2(e,t);var n=Zo(e,e===bt?At:0);if(n===0)r!==null&&Ch(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ch(r),t===1)e.tag===0?xw(_m.bind(null,e)):Pp(_m.bind(null,e)),dw(function(){!(Fe&6)&&pa()}),r=null;else{switch(cp(n)){case 1:r=Wd;break;case 4:r=ip;break;case 16:r=Jo;break;case 536870912:r=lp;break;default:r=Jo}r=Fg(r,jg.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function jg(e,t){if(Lo=-1,Mo=0,Fe&6)throw Error(re(327));var r=e.callbackNode;if(Ds()&&e.callbackNode!==r)return null;var n=Zo(e,e===bt?At:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=gc(e,n);else{t=n;var a=Fe;Fe|=2;var s=Tg();(bt!==e||At!==t)&&(hn=null,Vs=ot()+500,Ca(e,t));do try{Rw();break}catch(o){Sg(e,o)}while(!0);tf(),mc.current=s,Fe=a,ut!==null?t=0:(bt=null,At=0,t=pt)}if(t!==0){if(t===2&&(a=b0(e),a!==0&&(n=a,t=Q0(e,a))),t===1)throw r=hl,Ca(e,0),zn(e,n),sr(e,ot()),r;if(t===6)zn(e,n);else{if(a=e.current.alternate,!(n&30)&&!Pw(a)&&(t=gc(e,n),t===2&&(s=b0(e),s!==0&&(n=s,t=Q0(e,s))),t===1))throw r=hl,Ca(e,0),zn(e,n),sr(e,ot()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(re(345));case 2:ba(e,er,hn);break;case 3:if(zn(e,n),(n&130023424)===n&&(t=gf+500-ot(),10<t)){if(Zo(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Yt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=D0(ba.bind(null,e,er,hn),t);break}ba(e,er,hn);break;case 4:if(zn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var l=31-zr(n);s=1<<l,l=t[l],l>a&&(a=l),n&=~s}if(n=a,n=ot()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ow(n/1960))-n,10<n){e.timeoutHandle=D0(ba.bind(null,e,er,hn),n);break}ba(e,er,hn);break;case 5:ba(e,er,hn);break;default:throw Error(re(329))}}}return sr(e,ot()),e.callbackNode===r?jg.bind(null,e):null}function Q0(e,t){var r=Li;return e.current.memoizedState.isDehydrated&&(Ca(e,t).flags|=256),e=gc(e,t),e!==2&&(t=er,er=r,t!==null&&J0(t)),e}function J0(e){er===null?er=e:er.push.apply(er,e)}function Pw(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Xr(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zn(e,t){for(t&=~pf,t&=~Jc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-zr(t),n=1<<r;e[r]=-1,t&=~n}}function _m(e){if(Fe&6)throw Error(re(327));Ds();var t=Zo(e,0);if(!(t&1))return sr(e,ot()),null;var r=gc(e,t);if(e.tag!==0&&r===2){var n=b0(e);n!==0&&(t=n,r=Q0(e,n))}if(r===1)throw r=hl,Ca(e,0),zn(e,t),sr(e,ot()),r;if(r===6)throw Error(re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ba(e,er,hn),sr(e,ot()),null}function vf(e,t){var r=Fe;Fe|=1;try{return e(t)}finally{Fe=r,Fe===0&&(Vs=ot()+500,Xc&&pa())}}function Ba(e){Gn!==null&&Gn.tag===0&&!(Fe&6)&&Ds();var t=Fe;Fe|=1;var r=Ar.transition,n=Be;try{if(Ar.transition=null,Be=1,e)return e()}finally{Be=n,Ar.transition=r,Fe=t,!(Fe&6)&&pa()}}function yf(){fr=bs.current,Ye(bs)}function Ca(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,uw(r)),ut!==null)for(r=ut.return;r!==null;){var n=r;switch(Jd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ac();break;case 3:zs(),Ye(nr),Ye(zt),of();break;case 5:lf(n);break;case 4:zs();break;case 13:Ye(tt);break;case 19:Ye(tt);break;case 10:rf(n.type._context);break;case 22:case 23:yf()}r=r.return}if(bt=e,ut=e=na(e.current,null),At=fr=t,pt=0,hl=null,pf=Jc=Ma=0,er=Li=null,Sa!==null){for(t=0;t<Sa.length;t++)if(r=Sa[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var l=s.next;s.next=a,n.next=l}r.pending=n}Sa=null}return e}function Sg(e,t){do{var r=ut;try{if(tf(),Po.current=hc,fc){for(var n=rt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}fc=!1}if(La=0,yt=xt=rt=null,Ii=!1,ul=0,xf.current=null,r===null||r.return===null){pt=1,hl=t,ut=null;break}e:{var s=e,l=r.return,o=r,c=t;if(t=At,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=om(l);if(x!==null){x.flags&=-257,cm(x,l,o,s,t),x.mode&1&&lm(s,u,t),t=x,c=u;var g=t.updateQueue;if(g===null){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}else{if(!(t&1)){lm(s,u,t),wf();break e}c=Error(re(426))}}else if(Je&&o.mode&1){var _=om(l);if(_!==null){!(_.flags&65536)&&(_.flags|=256),cm(_,l,o,s,t),Zd(Hs(c,o));break e}}s=c=Hs(c,o),pt!==4&&(pt=2),Li===null?Li=[s]:Li.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=cg(s,c,t);tm(s,v);break e;case 1:o=c;var p=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ta===null||!ta.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var T=ug(s,o,t);tm(s,T);break e}}s=s.return}while(s!==null)}Cg(r)}catch(I){t=I,ut===r&&r!==null&&(ut=r=r.return);continue}break}while(!0)}function Tg(){var e=mc.current;return mc.current=hc,e===null?hc:e}function wf(){(pt===0||pt===3||pt===2)&&(pt=4),bt===null||!(Ma&268435455)&&!(Jc&268435455)||zn(bt,At)}function gc(e,t){var r=Fe;Fe|=2;var n=Tg();(bt!==e||At!==t)&&(hn=null,Ca(e,t));do try{Iw();break}catch(a){Sg(e,a)}while(!0);if(tf(),Fe=r,mc.current=n,ut!==null)throw Error(re(261));return bt=null,At=0,pt}function Iw(){for(;ut!==null;)kg(ut)}function Rw(){for(;ut!==null&&!l2();)kg(ut)}function kg(e){var t=Dg(e.alternate,e,fr);e.memoizedProps=e.pendingProps,t===null?Cg(e):ut=t,xf.current=null}function Cg(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Cw(r,t),r!==null){r.flags&=32767,ut=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,ut=null;return}}else if(r=kw(r,t,fr),r!==null){ut=r;return}if(t=t.sibling,t!==null){ut=t;return}ut=t=e}while(t!==null);pt===0&&(pt=5)}function ba(e,t,r){var n=Be,a=Ar.transition;try{Ar.transition=null,Be=1,Lw(e,t,r,n)}finally{Ar.transition=a,Be=n}return null}function Lw(e,t,r,n){do Ds();while(Gn!==null);if(Fe&6)throw Error(re(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(re(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(g2(e,s),e===bt&&(ut=bt=null,At=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||uo||(uo=!0,Fg(Jo,function(){return Ds(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ar.transition,Ar.transition=null;var l=Be;Be=1;var o=Fe;Fe|=4,xf.current=null,Dw(e,r),bg(r,e),nw(C0),ec=!!k0,C0=k0=null,e.current=r,Fw(r),o2(),Fe=o,Be=l,Ar.transition=s}else e.current=r;if(uo&&(uo=!1,Gn=e,pc=a),s=e.pendingLanes,s===0&&(ta=null),d2(r.stateNode),sr(e,ot()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(xc)throw xc=!1,e=Y0,Y0=null,e;return pc&1&&e.tag!==0&&Ds(),s=e.pendingLanes,s&1?e===q0?Mi++:(Mi=0,q0=e):Mi=0,pa(),null}function Ds(){if(Gn!==null){var e=cp(pc),t=Ar.transition,r=Be;try{if(Ar.transition=null,Be=16>e?16:e,Gn===null)var n=!1;else{if(e=Gn,Gn=null,pc=0,Fe&6)throw Error(re(331));var a=Fe;for(Fe|=4,ge=e.current;ge!==null;){var s=ge,l=s.child;if(ge.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(ge=u;ge!==null;){var d=ge;switch(d.tag){case 0:case 11:case 15:Ri(8,d,s)}var f=d.child;if(f!==null)f.return=d,ge=f;else for(;ge!==null;){d=ge;var h=d.sibling,x=d.return;if(wg(d),d===u){ge=null;break}if(h!==null){h.return=x,ge=h;break}ge=x}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}ge=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,ge=l;else e:for(;ge!==null;){if(s=ge,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ri(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ge=v;break e}ge=s.return}}var p=e.current;for(ge=p;ge!==null;){l=ge;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,ge=w;else e:for(l=p;ge!==null;){if(o=ge,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Qc(9,o)}}catch(I){st(o,o.return,I)}if(o===l){ge=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,ge=T;break e}ge=o.return}}if(Fe=a,pa(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(zc,e)}catch{}n=!0}return n}finally{Be=r,Ar.transition=t}}return!1}function Nm(e,t,r){t=Hs(r,t),t=cg(e,t,1),e=ea(e,t,1),t=Yt(),e!==null&&(Fl(e,1,t),sr(e,t))}function st(e,t,r){if(e.tag===3)Nm(e,e,r);else for(;t!==null;){if(t.tag===3){Nm(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ta===null||!ta.has(n))){e=Hs(r,e),e=ug(t,e,1),t=ea(t,e,1),e=Yt(),t!==null&&(Fl(t,1,e),sr(t,e));break}}t=t.return}}function Mw(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Yt(),e.pingedLanes|=e.suspendedLanes&r,bt===e&&(At&r)===r&&(pt===4||pt===3&&(At&130023424)===At&&500>ot()-gf?Ca(e,0):pf|=r),sr(e,t)}function Ag(e,t){t===0&&(e.mode&1?(t=eo,eo<<=1,!(eo&130023424)&&(eo=4194304)):t=1);var r=Yt();e=kn(e,t),e!==null&&(Fl(e,t,r),sr(e,r))}function Bw(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Ag(e,r)}function Uw(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(re(314))}n!==null&&n.delete(t),Ag(e,r)}var Dg;Dg=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||nr.current)tr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return tr=!1,Tw(e,t,r);tr=!!(e.flags&131072)}else tr=!1,Je&&t.flags&1048576&&Ip(t,lc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ro(e,t),e=t.pendingProps;var a=Us(t,zt.current);As(t,r),a=uf(null,t,n,e,a,r);var s=df();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ar(n)?(s=!0,sc(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,af(t),a.updater=qc,t.stateNode=a,a._reactInternals=t,M0(t,n,e,r),t=$0(null,t,n,!0,s,r)):(t.tag=0,Je&&s&&Qd(t),Vt(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ro(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Ww(n),e=Mr(n,e),a){case 0:t=U0(null,t,n,e,r);break e;case 1:t=fm(null,t,n,e,r);break e;case 11:t=um(null,t,n,e,r);break e;case 14:t=dm(null,t,n,Mr(n.type,e),r);break e}throw Error(re(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),U0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),fm(e,t,n,a,r);case 3:e:{if(mg(t),e===null)throw Error(re(387));n=t.pendingProps,s=t.memoizedState,a=s.element,$p(e,t),uc(t,n,null,r);var l=t.memoizedState;if(n=l.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Hs(Error(re(423)),t),t=hm(e,t,n,r,a);break e}else if(n!==a){a=Hs(Error(re(424)),t),t=hm(e,t,n,r,a);break e}else for(pr=Zn(t.stateNode.containerInfo.firstChild),vr=t,Je=!0,Ur=null,r=Bp(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if($s(),n===a){t=Cn(e,t,r);break e}Vt(e,t,n,r)}t=t.child}return t;case 5:return Wp(t),e===null&&I0(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,l=a.children,A0(n,a)?l=null:s!==null&&A0(n,s)&&(t.flags|=32),hg(e,t),Vt(e,t,l,r),t.child;case 6:return e===null&&I0(t),null;case 13:return xg(e,t,r);case 4:return sf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ws(t,null,n,r):Vt(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),um(e,t,n,a,r);case 7:return Vt(e,t,t.pendingProps,r),t.child;case 8:return Vt(e,t,t.pendingProps.children,r),t.child;case 12:return Vt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,l=a.value,Ke(oc,n._currentValue),n._currentValue=l,s!==null)if(Xr(s.value,l)){if(s.children===a.children&&!nr.current){t=Cn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=wn(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),R0(s.return,r,t),o.lanes|=r;break}c=c.next}}else if(s.tag===10)l=s.type===t.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(re(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),R0(l,r,t),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===t){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Vt(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,As(t,r),a=Fr(a),n=n(a),t.flags|=1,Vt(e,t,n,r),t.child;case 14:return n=t.type,a=Mr(n,t.pendingProps),a=Mr(n.type,a),dm(e,t,n,a,r);case 15:return dg(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),Ro(e,t),t.tag=1,ar(n)?(e=!0,sc(t)):e=!1,As(t,r),og(t,n,a),M0(t,n,a,r),$0(null,t,n,!0,e,r);case 19:return pg(e,t,r);case 22:return fg(e,t,r)}throw Error(re(156,t.tag))};function Fg(e,t){return sp(e,t)}function $w(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cr(e,t,r,n){return new $w(e,t,r,n)}function _f(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ww(e){if(typeof e=="function")return _f(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Bd)return 11;if(e===Ud)return 14}return 2}function na(e,t){var r=e.alternate;return r===null?(r=Cr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bo(e,t,r,n,a,s){var l=2;if(n=e,typeof e=="function")_f(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case hs:return Aa(r.children,a,s,t);case Md:l=8,a|=8;break;case o0:return e=Cr(12,r,t,a|2),e.elementType=o0,e.lanes=s,e;case c0:return e=Cr(13,r,t,a),e.elementType=c0,e.lanes=s,e;case u0:return e=Cr(19,r,t,a),e.elementType=u0,e.lanes=s,e;case Wx:return Zc(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ux:l=10;break e;case $x:l=9;break e;case Bd:l=11;break e;case Ud:l=14;break e;case Bn:l=16,n=null;break e}throw Error(re(130,e==null?e:typeof e,""))}return t=Cr(l,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Aa(e,t,r,n){return e=Cr(7,e,n,t),e.lanes=r,e}function Zc(e,t,r,n){return e=Cr(22,e,n,t),e.elementType=Wx,e.lanes=r,e.stateNode={isHidden:!1},e}function Hu(e,t,r){return e=Cr(6,e,null,t),e.lanes=r,e}function Vu(e,t,r){return t=Cr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zw(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ju(0),this.expirationTimes=ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ju(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Nf(e,t,r,n,a,s,l,o,c){return e=new zw(e,t,r,o,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Cr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},af(s),e}function Hw(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Og(e){if(!e)return sa;e=e._reactInternals;e:{if(Ga(e)!==e||e.tag!==1)throw Error(re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ar(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(re(171))}if(e.tag===1){var r=e.type;if(ar(r))return Op(e,r,t)}return t}function Pg(e,t,r,n,a,s,l,o,c){return e=Nf(r,n,!0,e,a,s,l,o,c),e.context=Og(null),r=e.current,n=Yt(),a=ra(r),s=wn(n,a),s.callback=t??null,ea(r,s,a),e.current.lanes=a,Fl(e,a,n),sr(e,n),e}function eu(e,t,r,n){var a=t.current,s=Yt(),l=ra(a);return r=Og(r),t.context===null?t.context=r:t.pendingContext=r,t=wn(s,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ea(a,t,l),e!==null&&(Hr(e,a,l,s),Oo(e,a,l)),l}function vc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function bm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function bf(e,t){bm(e,t),(e=e.alternate)&&bm(e,t)}function Vw(){return null}var Ig=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ef(e){this._internalRoot=e}tu.prototype.render=Ef.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(re(409));eu(e,t,null,null)};tu.prototype.unmount=Ef.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ba(function(){eu(null,e,null,null)}),t[Tn]=null}};function tu(e){this._internalRoot=e}tu.prototype.unstable_scheduleHydration=function(e){if(e){var t=fp();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Wn.length&&t!==0&&t<Wn[r].priority;r++);Wn.splice(r,0,e),r===0&&mp(e)}};function jf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ru(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Em(){}function Kw(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=vc(l);s.call(u)}}var l=Pg(t,n,e,0,null,!1,!1,"",Em);return e._reactRootContainer=l,e[Tn]=l.current,sl(e.nodeType===8?e.parentNode:e),Ba(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=vc(c);o.call(u)}}var c=Nf(e,0,!1,null,null,!1,!1,"",Em);return e._reactRootContainer=c,e[Tn]=c.current,sl(e.nodeType===8?e.parentNode:e),Ba(function(){eu(t,c,r,n)}),c}function nu(e,t,r,n,a){var s=r._reactRootContainer;if(s){var l=s;if(typeof a=="function"){var o=a;a=function(){var c=vc(l);o.call(c)}}eu(t,l,e,a)}else l=Kw(r,t,e,a,n);return vc(l)}up=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ji(t.pendingLanes);r!==0&&(zd(t,r|1),sr(t,ot()),!(Fe&6)&&(Vs=ot()+500,pa()))}break;case 13:Ba(function(){var n=kn(e,1);if(n!==null){var a=Yt();Hr(n,e,1,a)}}),bf(e,1)}};Hd=function(e){if(e.tag===13){var t=kn(e,134217728);if(t!==null){var r=Yt();Hr(t,e,134217728,r)}bf(e,134217728)}};dp=function(e){if(e.tag===13){var t=ra(e),r=kn(e,t);if(r!==null){var n=Yt();Hr(r,e,t,n)}bf(e,t)}};fp=function(){return Be};hp=function(e,t){var r=Be;try{return Be=e,t()}finally{Be=r}};w0=function(e,t,r){switch(t){case"input":if(h0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Gc(n);if(!a)throw Error(re(90));Hx(n),h0(n,a)}}}break;case"textarea":Kx(e,r);break;case"select":t=r.value,t!=null&&Ss(e,!!r.multiple,t,!1)}};Zx=vf;ep=Ba;var Gw={usingClientEntryPoint:!1,Events:[Pl,gs,Gc,Qx,Jx,vf]},vi={findFiberByHostInstance:ja,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xw={bundleType:vi.bundleType,version:vi.version,rendererPackageName:vi.rendererPackageName,rendererConfig:vi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:On.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=np(e),e===null?null:e.stateNode},findFiberByHostInstance:vi.findFiberByHostInstance||Vw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fo.isDisabled&&fo.supportsFiber)try{zc=fo.inject(Xw),an=fo}catch{}}Nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gw;Nr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jf(t))throw Error(re(200));return Hw(e,t,null,r)};Nr.createRoot=function(e,t){if(!jf(e))throw Error(re(299));var r=!1,n="",a=Ig;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Nf(e,1,!1,null,null,r,!1,n,a),e[Tn]=t.current,sl(e.nodeType===8?e.parentNode:e),new Ef(t)};Nr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(re(188)):(e=Object.keys(e).join(","),Error(re(268,e)));return e=np(t),e=e===null?null:e.stateNode,e};Nr.flushSync=function(e){return Ba(e)};Nr.hydrate=function(e,t,r){if(!ru(t))throw Error(re(200));return nu(null,e,t,!0,r)};Nr.hydrateRoot=function(e,t,r){if(!jf(e))throw Error(re(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",l=Ig;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Pg(t,null,e,1,r??null,a,!1,s,l),e[Tn]=t.current,sl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new tu(t)};Nr.render=function(e,t,r){if(!ru(t))throw Error(re(200));return nu(null,e,t,!1,r)};Nr.unmountComponentAtNode=function(e){if(!ru(e))throw Error(re(40));return e._reactRootContainer?(Ba(function(){nu(null,null,e,!1,function(){e._reactRootContainer=null,e[Tn]=null})}),!0):!1};Nr.unstable_batchedUpdates=vf;Nr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ru(r))throw Error(re(200));if(e==null||e._reactInternals===void 0)throw Error(re(38));return nu(e,t,r,!1,n)};Nr.version="18.3.1-next-f1338f8080-20240426";function Rg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rg)}catch(e){console.error(e)}}Rg(),Rx.exports=Nr;var Yw=Rx.exports,Lg,jm=Yw;Lg=jm.createRoot,jm.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ae=(e,t)=>{const r=ye.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:o="",children:c,...u},d)=>ye.createElement("svg",{ref:d,...qw,width:a,height:a,stroke:n,strokeWidth:l?Number(s)*24/Number(a):s,className:["lucide",`lucide-${Qw(e)}`,o].join(" "),...u},[...t.map(([f,h])=>ye.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=Ae("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=Ae("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=Ae("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=Ae("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=Ae("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=Ae("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=Ae("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=Ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=Ae("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=Ae("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=Ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=Ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=Ae("FilePen",[["path",{d:"M12 22h6a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v10",key:"x7tsz2"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10.4 12.6a2 2 0 1 1 3 3L8 21l-4 1 1-4Z",key:"o3xyfb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Ae("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=Ae("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=Ae("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n_=Ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=Ae("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=Ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=Ae("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=Ae("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=Ae("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),c_=({onExport:e,onImport:t})=>{const[r,n]=ye.useState(!1),a=()=>{n(!r)};return i.jsxs("header",{className:"bg-white border-b border-gray-200 px-6 py-4 relative",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-600 rounded-lg",children:i.jsx(Mg,{className:"w-6 h-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"نظام ادارة العمليات - MEC DOORS"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"إدارة شاملة لمشاريع البناء والمقاولات"}),i.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:[i.jsx(e_,{className:"w-3 h-3"}),"قاعدة بيانات مدمجة"]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(Xa,{className:"w-4 h-4"}),"تصدير البيانات"]}),i.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer",children:[i.jsx(o_,{className:"w-4 h-4"}),"استيراد البيانات",i.jsx("input",{type:"file",accept:".json",onChange:t,className:"hidden"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:a,className:"flex items-center justify-center w-10 h-10 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:i.jsx(i_,{className:"w-5 h-5 text-gray-600"})}),r&&i.jsx("div",{className:"absolute left-0 top-12 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:i.jsxs("div",{className:"p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"الإعدادات"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-700",children:"الإشعارات"}),i.jsx("input",{type:"checkbox",className:"rounded",defaultChecked:!0})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-700",children:"النسخ الاحتياطي التلقائي"}),i.jsx("input",{type:"checkbox",className:"rounded",defaultChecked:!0})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-700",children:"الوضع المظلم"}),i.jsx("input",{type:"checkbox",className:"rounded"})]}),i.jsx("hr",{className:"my-3"}),i.jsx("button",{className:"w-full text-left text-sm text-gray-700 hover:text-gray-900 py-2",children:"حول النظام"}),i.jsx("button",{className:"w-full text-left text-sm text-gray-700 hover:text-gray-900 py-2",children:"المساعدة"}),i.jsx("button",{className:"w-full text-left text-sm text-red-600 hover:text-red-800 py-2",children:"مسح جميع البيانات"})]})]})})]})]})]}),r&&i.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>n(!1)})]})},u_=({activeView:e,onViewChange:t})=>{const r=[{id:"dashboard",label:"الرئيسية",icon:t_},{id:"add-operation",label:"إضافة عملية",icon:Tt},{id:"view-operations",label:"استعراض العمليات",icon:Ks},{id:"clients",label:"إدارة العملاء",icon:$g},{id:"guarantees",label:"الضمانات",icon:l_},{id:"warranties",label:"شهادات الضمان",icon:Bi},{id:"checks",label:"الشيكات والمدفوعات",icon:ed},{id:"reports",label:"التقارير",icon:Z0}];return i.jsx("aside",{className:"w-64 bg-gray-50 border-r border-gray-200 min-h-screen",children:i.jsx("nav",{className:"p-4",children:i.jsx("ul",{className:"space-y-2",children:r.map(n=>{const a=n.icon,s=e===n.id;return i.jsx("li",{children:i.jsxs("button",{onClick:()=>t(n.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-right transition-colors ${s?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(a,{className:"w-5 h-5"}),i.jsx("span",{className:"font-medium",children:n.label})]})},n.id)})})})})},Rn=({title:e,value:t,icon:r,color:n,trend:a})=>{const s={blue:"bg-blue-50 text-blue-600 border-blue-200",green:"bg-green-50 text-green-600 border-green-200",yellow:"bg-yellow-50 text-yellow-600 border-yellow-200",red:"bg-red-50 text-red-600 border-red-200",purple:"bg-purple-50 text-purple-600 border-purple-200"};return i.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),a&&i.jsxs("p",{className:`text-sm mt-1 ${a.isPositive?"text-green-600":"text-red-600"}`,children:[a.isPositive?"+":"",a.value,"%"]})]}),i.jsx("div",{className:`p-3 rounded-lg border ${s[n]}`,children:i.jsx(r,{className:"w-6 h-6"})})]})})},d_=e=>e.amount*(e.executionPercentage/100),xl=e=>e.reduce((t,r)=>t+r.amount,0),pl=e=>e.reduce((t,r)=>t+d_(r),0),Wg=(e,t)=>t.reduce((r,n)=>n.isActive?n.type==="percentage"?r+e*n.value/100:r+n.value:r,0),Ua=e=>{const t=pl(e.items),r=Wg(t,e.deductions);return t-r},Dr=e=>{const t=pl(e.items);return Wg(t,e.deductions)},zg=e=>{if(e.length===0)return 0;const t=xl(e),r=pl(e);return t>0?r/t*100:0},Tf=e=>{const t=e.overallExecutionPercentage,r=e.totalAmount,n=e.totalReceived,a=Dr(e);if(t<100)return"in_progress";if(t>=100){const s=n+a;return s>r+.01?"completed_overpaid":Math.abs(s-r)<=.01?"completed_full_payment":s>0?"completed_partial_payment":"completed"}return"in_progress"},yi=(e,t)=>{const r=e.split(" ")[0].substring(0,3).toUpperCase(),n=t.split(" ")[0].substring(0,3).toUpperCase(),a=Date.now().toString().slice(-4);return`${r}-${n}-${a}`},Es=(e,t)=>`${e}-${String(t+1).padStart(3,"0")}`,ne=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)+" EGP",je=e=>!e||!(e instanceof Date)?"":new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"}).format(e),wi=({stats:e,onNavigate:t})=>{const r=e.totalOperations>0?e.completedOperations/e.totalOperations*100:0,n=(e.totalNetAmount||e.totalAmount)>0?e.totalReceived/(e.totalNetAmount||e.totalAmount)*100:0,a=s=>{t&&t(s)};return i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"لوحة التحكم - MEC DOORS"}),i.jsx("p",{className:"text-gray-600",children:"نظرة عامة على أداء العمليات والمشاريع"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8",children:[i.jsx(Rn,{title:"إجمالي العمليات",value:e.totalOperations,icon:Mg,color:"blue"}),i.jsx(Rn,{title:"العمليات المكتملة",value:e.completedOperations,icon:rr,color:"green",trend:{value:r,isPositive:!0}}),i.jsx(Rn,{title:"العمليات الجارية",value:e.inProgressOperations,icon:Zw,color:"yellow"}),i.jsx(Rn,{title:"إجمالي القيمة",value:ne(e.totalAmount),icon:gr,color:"purple"}),e.totalDeductions&&e.totalDeductions>0&&i.jsx(Rn,{title:"إجمالي الخصومات",value:ne(e.totalDeductions),icon:td,color:"red"}),e.totalNetAmount&&i.jsx(Rn,{title:"الصافي المستحق",value:ne(e.totalNetAmount),icon:Hn,color:"purple"}),i.jsx(Rn,{title:"المبلغ المحصل",value:ne(e.totalReceived),icon:Hn,color:"green",trend:{value:n,isPositive:!0}}),i.jsx(Rn,{title:"الضمانات المعلقة",value:e.outstandingGuarantees,icon:He,color:"red"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"معدل الإنجاز"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-600",children:"معدل إكمال العمليات"}),i.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[r.toFixed(1),"%"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-600",children:"معدل التحصيل"}),i.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[n.toFixed(1),"%"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})})]}),e.totalDeductions&&e.totalDeductions>0&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-600",children:"نسبة الخصومات"}),i.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[e.totalAmount>0?(e.totalDeductions/e.totalAmount*100).toFixed(1):0,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-300",style:{width:`${e.totalAmount>0?e.totalDeductions/e.totalAmount*100:0}%`}})})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"الإجراءات السريعة"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("button",{onClick:()=>a("add-operation"),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة عملية جديدة"]}),i.jsxs("button",{onClick:()=>a("view-operations"),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(Ks,{className:"w-4 h-4"}),"استعراض العمليات"]}),i.jsxs("button",{onClick:()=>a("clients"),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[i.jsx($g,{className:"w-4 h-4"}),"إدارة العملاء"]}),i.jsxs("button",{onClick:()=>a("guarantees"),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[i.jsx(He,{className:"w-4 h-4"}),"إدارة الضمانات"]}),i.jsxs("button",{onClick:()=>a("checks"),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[i.jsx(rr,{className:"w-4 h-4"}),"الشيكات والمدفوعات"]}),i.jsxs("button",{onClick:()=>a("reports"),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[i.jsx(Hn,{className:"w-4 h-4"}),"التقارير والإحصائيات"]})]})]})]})]})},f_=({clients:e,onSave:t,onCancel:r})=>{var K;const[n,a]=ye.useState({clientId:"",name:""}),[s,l]=ye.useState([{id:crypto.randomUUID(),code:"",description:"",amount:0,executionPercentage:0,addedAt:new Date}]),[o,c]=ye.useState([]),[u,d]=ye.useState([]),[f,h]=ye.useState([]),[x,g]=ye.useState([]),[m,_]=ye.useState("basic"),v=()=>{var b;const N=n.clientId&&n.name?yi(((b=e.find(S=>S.id===n.clientId))==null?void 0:b.name)||"",n.name):"TEMP",D={id:crypto.randomUUID(),code:Es(N,s.length),description:"",amount:0,executionPercentage:0,addedAt:new Date};l([...s,D])},p=(N,D,b)=>{const S=[...s];S[N]={...S[N],[D]:b},l(S)},w=N=>{var D;if(s.length>1){const b=s.filter((M,U)=>U!==N),S=n.clientId&&n.name?yi(((D=e.find(M=>M.id===n.clientId))==null?void 0:D.name)||"",n.name):"TEMP",W=b.map((M,U)=>({...M,code:Es(S,U)}));l(W)}},T=(N,D,b)=>{const S=[...o];S[N]={...S[N],[D]:b},c(S)},I=()=>{const N={id:crypto.randomUUID(),name:"",type:"percentage",value:0,isActive:!0};c([...o,N])},L=N=>{c(o.filter((D,b)=>b!==N))},j=()=>{const N=new Date,D=new Date(N);D.setFullYear(D.getFullYear()+1);const b={id:crypto.randomUUID(),checkNumber:"",amount:0,checkDate:N,deliveryDate:N,expiryDate:D,bank:"",isReturned:!1,relatedTo:"operation"};d([...u,b])},A=(N,D,b)=>{const S=[...u];S[N]={...S[N],[D]:b},d(S)},y=N=>{d(u.filter((D,b)=>b!==N))},O=()=>{const N=new Date,D=new Date(N);D.setFullYear(D.getFullYear()+1);const b={id:crypto.randomUUID(),bank:"",letterDate:N,letterNumber:"",amount:0,dueDate:D,renewals:[],relatedTo:"operation",isReturned:!1};h([...f,b])},B=(N,D,b)=>{const S=[...f];S[N]={...S[N],[D]:b},h(S)},H=N=>{h(f.filter((D,b)=>b!==N))},Q=()=>{const N={id:crypto.randomUUID(),type:"cash",amount:0,date:new Date};g([...x,N])},ie=(N,D,b)=>{const S=[...x];S[N]={...S[N],[D]:b},g(S)},oe=N=>{g(x.filter((D,b)=>b!==N))},we=N=>{if(N.preventDefault(),!n.clientId||!n.name){alert("يرجى إدخال اسم العميل واسم العملية");return}if(s.some(ce=>!ce.description||ce.amount<=0)){alert("يرجى إدخال وصف وقيمة صحيحة لجميع البنود");return}const D=e.find(ce=>ce.id===n.clientId);if(!D)return;const b=yi(D.name,n.name),S=xl(s),W=zg(s),M=x.reduce((ce,pe)=>ce+pe.amount,0),U=s.map((ce,pe)=>({...ce,code:Es(b,pe)})),J={id:crypto.randomUUID(),code:b,name:n.name,clientId:n.clientId,items:U,deductions:o,guaranteeChecks:u,guaranteeLetters:f,warrantyCertificates:[],receivedPayments:x,totalAmount:S,totalReceived:M,overallExecutionPercentage:W,status:Tf({overallExecutionPercentage:W,totalReceived:M,items:U,deductions:o}),createdAt:new Date,updatedAt:new Date};t(J)},z=[{id:"basic",label:"البيانات الأساسية",icon:nn},{id:"items",label:"بنود العملية",icon:Tt},{id:"deductions",label:"الخصومات",icon:Mt},{id:"guarantees",label:"الضمانات",icon:ml},{id:"payments",label:"المدفوعات",icon:Vr}];return i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"إضافة عملية جديدة"}),i.jsx("p",{className:"text-gray-600",children:"إنشاء عملية إنشائية جديدة مع جميع التفاصيل والبيانات المطلوبة"})]}),i.jsx("div",{className:"mb-8 bg-white rounded-lg border border-gray-200 p-1",children:i.jsx("nav",{className:"flex flex-wrap gap-1",children:z.map(N=>{const D=N.icon;return i.jsxs("button",{onClick:()=>_(N.id),className:`flex items-center gap-2 px-4 py-3 rounded-md font-medium text-sm transition-all ${m===N.id?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[i.jsx(D,{className:"w-4 h-4"}),N.label]},N.id)})})}),i.jsxs("form",{onSubmit:we,className:"space-y-8",children:[m==="basic"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"البيانات الأساسية"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل *"}),i.jsxs("select",{value:n.clientId,onChange:N=>a({...n,clientId:N.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[i.jsx("option",{value:"",children:"اختر العميل"}),e.map(N=>i.jsx("option",{value:N.id,children:N.name},N.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم العملية *"}),i.jsx("input",{type:"text",value:n.name,onChange:N=>a({...n,name:N.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسم العملية",required:!0})]}),n.clientId&&n.name&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كود العملية (سيتم إنشاؤه تلقائياً)"}),i.jsx("input",{type:"text",value:yi(((K=e.find(N=>N.id===n.clientId))==null?void 0:K.name)||"",n.name),className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-600",readOnly:!0})]})]})]}),m==="items"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"بنود العملية"}),i.jsxs("button",{type:"button",onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة بند"]})]}),i.jsx("div",{className:"space-y-6",children:s.map((N,D)=>{var b;return i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-gray-700",children:["البند ",D+1]}),s.length>1&&i.jsx("button",{type:"button",onClick:()=>w(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكود"}),i.jsx("input",{type:"text",value:n.clientId&&n.name?Es(yi(((b=e.find(S=>S.id===n.clientId))==null?void 0:b.name)||"",n.name),D):"TEMP-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-600",readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الوصف *"}),i.jsx("input",{type:"text",value:N.description,onChange:S=>p(D,"description",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"وصف البند",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"القيمة (ج.م) *"}),i.jsx("input",{type:"number",value:N.amount,onChange:S=>p(D,"amount",parseFloat(S.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نسبة التنفيذ (%)"}),i.jsx("input",{type:"number",value:N.executionPercentage,onChange:S=>p(D,"executionPercentage",parseFloat(S.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.1",placeholder:"0.0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم العقد"}),i.jsx("input",{type:"text",value:N.contractNumber||"",onChange:S=>p(D,"contractNumber",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"رقم العقد"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ العقد"}),i.jsx("input",{type:"date",value:N.contractDate?N.contractDate.toISOString().split("T")[0]:"",onChange:S=>p(D,"contractDate",S.target.value?new Date(S.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]},N.id)})}),i.jsx("div",{className:"mt-6 p-6 bg-blue-50 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex justify-between items-center text-lg",children:[i.jsx("span",{className:"font-medium text-blue-900",children:"إجمالي العملية:"}),i.jsx("span",{className:"font-bold text-blue-900",children:ne(xl(s))})]})})]}),m==="deductions"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"الخصومات"}),i.jsxs("button",{type:"button",onClick:I,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة خصم"]})]}),i.jsx("div",{className:"space-y-4",children:o.map((N,D)=>i.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم الخصم"}),i.jsx("input",{type:"text",value:N.name,onChange:b=>T(D,"name",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"اسم الخصم"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"النوع"}),i.jsxs("select",{value:N.type,onChange:b=>T(D,"type",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"percentage",children:"نسبة مئوية"}),i.jsx("option",{value:"fixed",children:"مبلغ ثابت"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["القيمة ",N.type==="percentage"?"(%)":"(ج.م)"]}),i.jsx("input",{type:"number",value:N.value,onChange:b=>T(D,"value",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:N.isActive,onChange:b=>T(D,"isActive",b.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("span",{className:"text-sm text-gray-700",children:"فعال"})]}),i.jsx("button",{type:"button",onClick:()=>L(D),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]})]})},N.id))}),o.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد خصومات مضافة. يمكنك إضافة خصومات حسب الحاجة."})]}),m==="guarantees"&&i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"شيكات الضمان"}),i.jsxs("button",{type:"button",onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة شيك ضمان"]})]}),i.jsx("div",{className:"space-y-6",children:u.map((N,D)=>i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-purple-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-purple-900",children:["شيك الضمان ",D+1]}),i.jsx("button",{type:"button",onClick:()=>y(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الشيك"}),i.jsx("input",{type:"text",value:N.checkNumber,onChange:b=>A(D,"checkNumber",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"رقم الشيك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ج.م)"}),i.jsx("input",{type:"number",value:N.amount,onChange:b=>A(D,"amount",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),i.jsx("input",{type:"text",value:N.bank,onChange:b=>A(D,"bank",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"اسم البنك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الشيك"}),i.jsx("input",{type:"date",value:N.checkDate.toISOString().split("T")[0],onChange:b=>A(D,"checkDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ التسليم"}),i.jsx("input",{type:"date",value:N.deliveryDate.toISOString().split("T")[0],onChange:b=>A(D,"deliveryDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ انتهاء الصلاحية"}),i.jsx("input",{type:"date",value:N.expiryDate.toISOString().split("T")[0],onChange:b=>A(D,"expiryDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]},N.id))}),u.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد شيكات ضمان مضافة. يمكنك إضافة شيكات ضمان حسب الحاجة."})]}),i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"خطابات الضمان"}),i.jsxs("button",{type:"button",onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة خطاب ضمان"]})]}),i.jsx("div",{className:"space-y-6",children:f.map((N,D)=>i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-indigo-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-indigo-900",children:["خطاب الضمان ",D+1]}),i.jsx("button",{type:"button",onClick:()=>H(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),i.jsx("input",{type:"text",value:N.bank,onChange:b=>B(D,"bank",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"اسم البنك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الخطاب"}),i.jsx("input",{type:"text",value:N.letterNumber,onChange:b=>B(D,"letterNumber",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"رقم الخطاب"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ج.م)"}),i.jsx("input",{type:"number",value:N.amount,onChange:b=>B(D,"amount",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الخطاب"}),i.jsx("input",{type:"date",value:N.letterDate.toISOString().split("T")[0],onChange:b=>B(D,"letterDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستحقاق"}),i.jsx("input",{type:"date",value:N.dueDate.toISOString().split("T")[0],onChange:b=>B(D,"dueDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مرتبط بـ"}),i.jsxs("select",{value:N.relatedTo,onChange:b=>B(D,"relatedTo",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[i.jsx("option",{value:"operation",children:"العملية كاملة"}),i.jsx("option",{value:"item",children:"بند محدد"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات"}),i.jsx("input",{type:"text",value:N.notes||"",onChange:b=>B(D,"notes",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"ملاحظات إضافية"})]})]})]},N.id))}),f.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد خطابات ضمان مضافة. يمكنك إضافة خطابات ضمان حسب الحاجة."})]})]}),m==="payments"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"المدفوعات المستلمة"}),i.jsxs("button",{type:"button",onClick:Q,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة دفعة"]})]}),i.jsx("div",{className:"space-y-6",children:x.map((N,D)=>i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-green-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-green-900",children:["الدفعة ",D+1]}),i.jsx("button",{type:"button",onClick:()=>oe(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الدفع"}),i.jsxs("select",{value:N.type,onChange:b=>ie(D,"type",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("option",{value:"cash",children:"نقدي"}),i.jsx("option",{value:"check",children:"شيك"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ج.م)"}),i.jsx("input",{type:"number",value:N.amount,onChange:b=>ie(D,"amount",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التاريخ"}),i.jsx("input",{type:"date",value:N.date.toISOString().split("T")[0],onChange:b=>ie(D,"date",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),N.type==="check"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الشيك"}),i.jsx("input",{type:"text",value:N.checkNumber||"",onChange:b=>ie(D,"checkNumber",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"رقم الشيك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),i.jsx("input",{type:"text",value:N.bank||"",onChange:b=>ie(D,"bank",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"اسم البنك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستلام"}),i.jsx("input",{type:"date",value:N.receiptDate?N.receiptDate.toISOString().split("T")[0]:"",onChange:b=>ie(D,"receiptDate",b.target.value?new Date(b.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات"}),i.jsx("input",{type:"text",value:N.notes||"",onChange:b=>ie(D,"notes",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"ملاحظات إضافية"})]})]})]},N.id))}),x.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد مدفوعات مضافة. يمكنك إضافة المدفوعات المستلمة حسب الحاجة."}),x.length>0&&i.jsx("div",{className:"mt-6 p-6 bg-green-100 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex justify-between items-center text-lg",children:[i.jsx("span",{className:"font-medium text-green-900",children:"إجمالي المدفوعات المستلمة:"}),i.jsx("span",{className:"font-bold text-green-900",children:ne(x.reduce((N,D)=>N+D.amount,0))})]})})]}),i.jsxs("div",{className:"flex gap-4 pt-8 border-t border-gray-200 bg-white p-6 rounded-lg",children:[i.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[i.jsx(Bg,{className:"w-5 h-5"}),"حفظ العملية"]}),i.jsxs("button",{type:"button",onClick:r,className:"flex items-center gap-2 px-8 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors font-medium",children:[i.jsx(la,{className:"w-5 h-5"}),"إلغاء"]})]})]})]})},h_="modulepreload",m_=function(e){return"/"+e},Sm={},x_=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=m_(c),c in Sm)return;Sm[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":h_,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,x)=>{f.addEventListener("load",h),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yc={};yc.version="0.18.5";var Hg=1252,p_=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Vg=function(e){p_.indexOf(e)!=-1&&(Hg=e)};function g_(){Vg(1252)}var gl=function(e){Vg(e)};function v_(){gl(1200),g_()}var ho=function(t){return String.fromCharCode(t)},Tm=function(t){return String.fromCharCode(t)},wc,Xn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function vl(e){for(var t="",r=0,n=0,a=0,s=0,l=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),l=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Xn.charAt(s)+Xn.charAt(l)+Xn.charAt(o)+Xn.charAt(c);return t}function An(e){var t="",r=0,n=0,a=0,s=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Xn.indexOf(e.charAt(u++)),l=Xn.indexOf(e.charAt(u++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=Xn.indexOf(e.charAt(u++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Xn.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Pe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function $a(e){return Pe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function km(e){return Pe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $r=function(t){return Pe?Pn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function au(e){if(typeof ArrayBuffer>"u")return $r(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ll(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function y_(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var kt=Pe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Pn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function w_(e){for(var t=[],r=0,n=e.length+250,a=$a(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|o>>6&15|(l&3)<<4,a[r++]=128|o&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=$a(65535),n=65530)}return t.push(a.slice(0,r)),kt(t)}var Ui=/\u0000/g,mo=/[\u0001-\u0006]/g;function Fs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Wr(e,t){var r=""+e;return r.length>=t?r:it("0",t-r.length)+r}function kf(e,t){var r=""+e;return r.length>=t?r:it(" ",t-r.length)+r}function _c(e,t){var r=""+e;return r.length>=t?r:r+it(" ",t-r.length)}function __(e,t){var r=""+Math.round(e);return r.length>=t?r:it("0",t-r.length)+r}function N_(e,t){var r=""+e;return r.length>=t?r:it("0",t-r.length)+r}var Cm=Math.pow(2,32);function as(e,t){if(e>Cm||e<-Cm)return __(e,t);var r=Math.round(e);return N_(r,t)}function Nc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Am=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ku=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function b_(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Dm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},E_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bc(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,l=1,o=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),o=f*l+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=l,l=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=s):(d=u,o=l)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function xo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=D_(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Kg=new Date(1899,11,31,0,0,0),j_=Kg.getTime(),S_=new Date(1900,2,1,0,0,0);function Gg(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=S_&&(r+=24*60*60*1e3),(r-(j_+(e.getTimezoneOffset()-Kg.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function T_(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function k_(e){var t=e<0?12:11,r=Cf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function C_(e){var t=Cf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function A_(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=k_(e):t===10?r=e.toFixed(10).substr(0,12):r=C_(e),Cf(T_(r.toUpperCase()))}function rd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):A_(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return oa(14,Gg(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function D_(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function F_(e,t,r,n){var a="",s=0,l=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Ku[r.m-1][1];case 5:return Ku[r.m-1][0];default:return Ku[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Am[r.q][0];default:return Am[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Wr(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(a=Wr(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Wr(c,u):"";return d}function Yn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Xg=/%/g;function O_(e,t,r){var n=t.replace(Xg,""),a=t.length-n.length;return _n(e,n,r*Math.pow(10,2*a))+it("%",a)}function P_(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Yg(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Yg(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var qg=/# (\?+)( ?)\/( ?)(\d+)/;function I_(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),l=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?it(" ",e[1].length+1+e[4].length):kf(l,e[1].length)+e[2]+"/"+e[3]+Wr(o,e[4].length))}function R_(e,t,r){return r+(t===0?"":""+t)+it(" ",e[1].length+2+e[4].length)}var Qg=/^#*0*\.([0#]+)/,Jg=/\).*[0#]/,Zg=/\(###\) ###\\?-####/;function Kt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Fm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Om(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function L_(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function M_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Jg)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?jr("n",n,r):"("+jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return P_(e,t,r);if(t.indexOf("%")!==-1)return O_(e,t,r);if(t.indexOf("E")!==-1)return Yg(t,r);if(t.charCodeAt(0)===36)return"$"+jr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+as(c,t.length);if(t.match(/^[#?]+$/))return a=as(r,0),a==="0"&&(a=""),a.length>t.length?a:Kt(t.substr(0,t.length-a.length))+a;if(s=t.match(qg))return I_(s,c,u);if(t.match(/^#+0+$/))return u+as(c,t.length-t.indexOf("0"));if(s=t.match(Qg))return a=Fm(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Kt(s[1])).replace(/\.$/,"."+Kt(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+it("0",Kt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+Fm(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(as(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+jr(e,t,-r):Yn(""+(Math.floor(r)+L_(r,s[1].length)))+"."+Wr(Om(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return jr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fs(jr(e,t.replace(/[\\-]/g,""),r)),l=0,Fs(Fs(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<a.length?a.charAt(l++):g==="0"?"0":""}));if(t.match(Zg))return a=jr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=bc(c,Math.pow(10,l)-1,!1),a=""+u,d=_n("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=_c(o[2],l),d.length<s[4].length&&(d=Kt(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=bc(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kf(o[1],l)+s[2]+"/"+s[3]+_c(o[2],l):it(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=as(r,0),t.length<=a.length?a:Kt(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var f=t.indexOf(".")-l,h=t.length-a.length-f;return Kt(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=Om(r,s[1].length),r<0?"-"+jr(e,t,-r):Yn(M_(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Wr(0,3-g.length):"")+g})+"."+Wr(l,s[1].length);switch(t){case"###,##0.00":return jr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Yn(as(c,0));return x!=="0"?u+x:"";case"###,###.00":return jr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return jr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function B_(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function U_(e,t,r){var n=t.replace(Xg,""),a=t.length-n.length;return _n(e,n,r*Math.pow(10,2*a))+it("%",a)}function e1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+e1(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Jg)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",n,r):"("+Jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return B_(e,t,r);if(t.indexOf("%")!==-1)return U_(e,t,r);if(t.indexOf("E")!==-1)return e1(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Wr(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Kt(t.substr(0,t.length-a.length))+a;if(s=t.match(qg))return R_(s,c,u);if(t.match(/^#+0+$/))return u+Wr(c,t.length-t.indexOf("0"));if(s=t.match(Qg))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Kt(s[1])).replace(/\.$/,"."+Kt(s[1])),a=a.replace(/\.(\d*)$/,function(g,m){return"."+m+it("0",Kt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Yn(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Yn(""+r)+"."+it("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fs(Jr(e,t.replace(/[\\-]/g,""),r)),l=0,Fs(Fs(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<a.length?a.charAt(l++):g==="0"?"0":""}));if(t.match(Zg))return a=Jr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=bc(c,Math.pow(10,l)-1,!1),a=""+u,d=_n("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=_c(o[2],l),d.length<s[4].length&&(d=Kt(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=bc(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kf(o[1],l)+s[2]+"/"+s[3]+_c(o[2],l):it(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Kt(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var f=t.indexOf(".")-l,h=t.length-a.length-f;return Kt(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Yn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Wr(0,3-g.length):"")+g})+"."+Wr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Yn(""+c);return x!=="0"?u+x:"";default:if(t.match(/\.[0#?]*$/))return Jr(e,t.slice(0,t.lastIndexOf(".")),r)+Kt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _n(e,t,r){return(r|0)===r?Jr(e,t,r):jr(e,t,r)}function $_(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var t1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function r1(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Nc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(t1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function W_(e,t,r,n){for(var a=[],s="",l=0,o="",c="t",u,d,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Nc(e,l))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(f=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++l;break;case"\\":var x=e.charAt(++l),g=x==="("||x===")"?x:"t";a[a.length]={t:g,v:x},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=xo(t,r,e.charAt(l+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=xo(t,r),u==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(u==null&&(u=xo(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(u!=null&&(m.v=u.H>=12?"下午":"上午"),m.t="T",l+=5,h="h"):(m.t="t",++l),u==null&&m.t==="T")return"";a[a.length]=m,c=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(t1)){if(u==null&&(u=xo(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",r1(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;a[a.length]={t:o,v:s},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++l;break}var _=0,v=0,p;for(l=a.length-1,c="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=h,c="h",_<1&&(_=1);break;case"s":(p=a[l].v.match(/\.0+$/))&&(v=Math.max(v,p[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=a[l].t;break;case"m":c==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",T;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=F_(a[l].t.charCodeAt(0),a[l].v,u,v),a[l].t="t";break;case"n":case"?":for(T=l+1;a[T]!=null&&((o=a[T].t)==="?"||o==="D"||(o===" "||o==="t")&&a[T+1]!=null&&(a[T+1].t==="?"||a[T+1].t==="t"&&a[T+1].v==="/")||a[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[T].v==="/"||a[T].v===" "&&a[T+1]!=null&&a[T+1].t=="?"));)a[l].v+=a[T].v,a[T]={v:"",t:";"},++T;w+=a[l].v,l=T-1;break;case"G":a[l].t="t",a[l].v=rd(t,r);break}var I="",L,j;if(w.length>0){w.charCodeAt(0)==40?(L=t<0&&w.charCodeAt(0)===45?-t:t,j=_n("n",w,L)):(L=t<0&&n>1?-t:t,j=_n("n",w,L),L<0&&a[0]&&a[0].t=="t"&&(j=j.substr(1),a[0].v="-"+a[0].v)),T=j.length-1;var A=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){A=l;break}var y=a.length;if(A===a.length&&j.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(T>=a[l].v.length-1?(T-=a[l].v.length,a[l].v=j.substr(T+1,a[l].v.length)):T<0?a[l].v="":(a[l].v=j.substr(0,T+1),T=-1),a[l].t="t",y=l);T>=0&&y<a.length&&(a[y].v=j.substr(0,T+1)+a[y].v)}else if(A!==a.length&&j.indexOf("E")===-1){for(T=j.indexOf(".")-1,l=A;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(d=a[l].v.indexOf(".")>-1&&l===A?a[l].v.indexOf(".")-1:a[l].v.length-1,I=a[l].v.substr(d+1);d>=0;--d)T>=0&&(a[l].v.charAt(d)==="0"||a[l].v.charAt(d)==="#")&&(I=j.charAt(T--)+I);a[l].v=I,a[l].t="t",y=l}for(T>=0&&y<a.length&&(a[y].v=j.substr(0,T+1)+a[y].v),T=j.indexOf(".")+1,l=A;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==A)){for(d=a[l].v.indexOf(".")>-1&&l===A?a[l].v.indexOf(".")+1:0,I=a[l].v.substr(0,d);d<a[l].v.length;++d)T<j.length&&(I+=j.charAt(T++));a[l].v=I,a[l].t="t",y=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(L=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=_n(a[l].t,a[l].v,L),a[l].t="t");var O="";for(l=0;l!==a.length;++l)a[l]!=null&&(O+=a[l].v);return O}var Pm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Im(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function z_(e,t){var r=$_(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Pm),o=r[1].match(Pm);return Im(t,l)?[n,r[0]]:Im(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function oa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:lt)[e],n==null&&(n=r.table&&r.table[Dm[e]]||lt[Dm[e]]),n==null&&(n=E_[e]||"General");break}if(Nc(n,0))return rd(t,r);t instanceof Date&&(t=Gg(t,r.date1904));var a=z_(n,t);if(Nc(a[1]))return rd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return W_(a[1],t,r,a[0])}function n1(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(lt[r]==null){t<0&&(t=r);continue}if(lt[r]==e){t=r;break}}t<0&&(t=391)}return lt[t]=e,t}function su(e){for(var t=0;t!=392;++t)e[t]!==void 0&&n1(e[t],t)}function iu(){lt=b_()}var a1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function H_(e){var t=typeof e=="number"?lt[e]:e;return t=t.replace(a1,"(\\d+)"),new RegExp("^"+t+"$")}function V_(e,t,r){var n=-1,a=-1,s=-1,l=-1,o=-1,c=-1;(t.match(a1)||[]).forEach(function(f,h){var x=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":l=x;break;case"s":c=x;break;case"m":l>=0?o=x:a=x;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var K_=function(){var e={};e.version="1.2.0";function t(){for(var j=0,A=new Array(256),y=0;y!=256;++y)j=y,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,A[y]=j;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(j){var A=0,y=0,O=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)B[O]=j[O];for(O=0;O!=256;++O)for(y=j[O],A=256+O;A<4096;A+=256)y=B[A]=y>>>8^j[y&255];var H=[];for(O=1;O!=16;++O)H[O-1]=typeof Int32Array<"u"?B.subarray(O*256,O*256+256):B.slice(O*256,O*256+256);return H}var a=n(r),s=a[0],l=a[1],o=a[2],c=a[3],u=a[4],d=a[5],f=a[6],h=a[7],x=a[8],g=a[9],m=a[10],_=a[11],v=a[12],p=a[13],w=a[14];function T(j,A){for(var y=A^-1,O=0,B=j.length;O<B;)y=y>>>8^r[(y^j.charCodeAt(O++))&255];return~y}function I(j,A){for(var y=A^-1,O=j.length-15,B=0;B<O;)y=w[j[B++]^y&255]^p[j[B++]^y>>8&255]^v[j[B++]^y>>16&255]^_[j[B++]^y>>>24]^m[j[B++]]^g[j[B++]]^x[j[B++]]^h[j[B++]]^f[j[B++]]^d[j[B++]]^u[j[B++]]^c[j[B++]]^o[j[B++]]^l[j[B++]]^s[j[B++]]^r[j[B++]];for(O+=15;B<O;)y=y>>>8^r[(y^j[B++])&255];return~y}function L(j,A){for(var y=A^-1,O=0,B=j.length,H=0,Q=0;O<B;)H=j.charCodeAt(O++),H<128?y=y>>>8^r[(y^H)&255]:H<2048?(y=y>>>8^r[(y^(192|H>>6&31))&255],y=y>>>8^r[(y^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,Q=j.charCodeAt(O++)&1023,y=y>>>8^r[(y^(240|H>>8&7))&255],y=y>>>8^r[(y^(128|H>>2&63))&255],y=y>>>8^r[(y^(128|Q>>6&15|(H&3)<<4))&255],y=y>>>8^r[(y^(128|Q&63))&255]):(y=y>>>8^r[(y^(224|H>>12&15))&255],y=y>>>8^r[(y^(128|H>>6&63))&255],y=y>>>8^r[(y^(128|H&63))&255]);return~y}return e.table=r,e.bstr=T,e.buf=I,e.str=L,e}(),$e=function(){var t={};t.version="1.2.1";function r(E,F){for(var k=E.split("/"),C=F.split("/"),P=0,R=0,G=Math.min(k.length,C.length);P<G;++P){if(R=k[P].length-C[P].length)return R;if(k[P]!=C[P])return k[P]<C[P]?-1:1}return k.length-C.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var F=E.lastIndexOf("/");return F===-1?E:E.slice(0,F+1)}function a(E){if(E.charAt(E.length-1)=="/")return a(E.slice(0,-1));var F=E.lastIndexOf("/");return F===-1?E:E.slice(F+1)}function s(E,F){typeof F=="string"&&(F=new Date(F));var k=F.getHours();k=k<<6|F.getMinutes(),k=k<<5|F.getSeconds()>>>1,E.write_shift(2,k);var C=F.getFullYear()-1980;C=C<<4|F.getMonth()+1,C=C<<5|F.getDate(),E.write_shift(2,C)}function l(E){var F=E.read_shift(2)&65535,k=E.read_shift(2)&65535,C=new Date,P=k&31;k>>>=5;var R=k&15;k>>>=4,C.setMilliseconds(0),C.setFullYear(k+1980),C.setMonth(R-1),C.setDate(P);var G=F&31;F>>>=5;var Z=F&63;return F>>>=6,C.setHours(F),C.setMinutes(Z),C.setSeconds(G<<1),C}function o(E){hr(E,0);for(var F={},k=0;E.l<=E.length-4;){var C=E.read_shift(2),P=E.read_shift(2),R=E.l+P,G={};switch(C){case 21589:k=E.read_shift(1),k&1&&(G.mtime=E.read_shift(4)),P>5&&(k&2&&(G.atime=E.read_shift(4)),k&4&&(G.ctime=E.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}E.l=R,F[C]=G}return F}var c;function u(){return c||(c={})}function d(E,F){if(E[0]==80&&E[1]==75)return ph(E,F);if((E[0]|32)==109&&(E[1]|32)==105)return py(E,F);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var k=3,C=512,P=0,R=0,G=0,Z=0,V=0,X=[],Y=E.slice(0,512);hr(Y,0);var te=f(Y);switch(k=te[0],k){case 3:C=512;break;case 4:C=4096;break;case 0:if(te[1]==0)return ph(E,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+k)}C!==512&&(Y=E.slice(0,C),hr(Y,28));var ue=E.slice(0,C);h(Y,k);var me=Y.read_shift(4,"i");if(k===3&&me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+me);Y.l+=4,G=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),Z=Y.read_shift(4,"i"),P=Y.read_shift(4,"i"),V=Y.read_shift(4,"i"),R=Y.read_shift(4,"i");for(var ae=-1,fe=0;fe<109&&(ae=Y.read_shift(4,"i"),!(ae<0));++fe)X[fe]=ae;var Te=x(E,C);_(V,R,Te,C,X);var Ze=p(Te,G,X,C);Ze[G].name="!Directory",P>0&&Z!==Q&&(Ze[Z].name="!MiniFAT"),Ze[X[0]].name="!FAT",Ze.fat_addrs=X,Ze.ssz=C;var et={},Pt=[],oi=[],ci=[];w(G,Ze,Te,Pt,P,et,oi,Z),g(oi,ci,Pt),Pt.shift();var ui={FileIndex:oi,FullPaths:ci};return F&&F.raw&&(ui.raw={header:ue,sectors:Te}),ui}function f(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(ie,"Header Signature: "),E.l+=16;var F=E.read_shift(2,"u");return[E.read_shift(2,"u"),F]}function h(E,F){var k=9;switch(E.l+=2,k=E.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+k);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+k);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+k)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function x(E,F){for(var k=Math.ceil(E.length/F)-1,C=[],P=1;P<k;++P)C[P-1]=E.slice(P*F,(P+1)*F);return C[k-1]=E.slice(k*F),C}function g(E,F,k){for(var C=0,P=0,R=0,G=0,Z=0,V=k.length,X=[],Y=[];C<V;++C)X[C]=Y[C]=C,F[C]=k[C];for(;Z<Y.length;++Z)C=Y[Z],P=E[C].L,R=E[C].R,G=E[C].C,X[C]===C&&(P!==-1&&X[P]!==P&&(X[C]=X[P]),R!==-1&&X[R]!==R&&(X[C]=X[R])),G!==-1&&(X[G]=C),P!==-1&&C!=X[C]&&(X[P]=X[C],Y.lastIndexOf(P)<Z&&Y.push(P)),R!==-1&&C!=X[C]&&(X[R]=X[C],Y.lastIndexOf(R)<Z&&Y.push(R));for(C=1;C<V;++C)X[C]===C&&(R!==-1&&X[R]!==R?X[C]=X[R]:P!==-1&&X[P]!==P&&(X[C]=X[P]));for(C=1;C<V;++C)if(E[C].type!==0){if(Z=C,Z!=X[Z])do Z=X[Z],F[C]=F[Z]+"/"+F[C];while(Z!==0&&X[Z]!==-1&&Z!=X[Z]);X[C]=-1}for(F[0]+="/",C=1;C<V;++C)E[C].type!==2&&(F[C]+="/")}function m(E,F,k){for(var C=E.start,P=E.size,R=[],G=C;k&&P>0&&G>=0;)R.push(F.slice(G*H,G*H+H)),P-=H,G=Ea(k,G*4);return R.length===0?q(0):kt(R).slice(0,E.size)}function _(E,F,k,C,P){var R=Q;if(E===Q){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var G=k[E],Z=(C>>>2)-1;if(!G)return;for(var V=0;V<Z&&(R=Ea(G,V*4))!==Q;++V)P.push(R);_(Ea(G,C-4),F-1,k,C,P)}}function v(E,F,k,C,P){var R=[],G=[];P||(P=[]);var Z=C-1,V=0,X=0;for(V=F;V>=0;){P[V]=!0,R[R.length]=V,G.push(E[V]);var Y=k[Math.floor(V*4/C)];if(X=V*4&Z,C<4+X)throw new Error("FAT boundary crossed: "+V+" 4 "+C);if(!E[Y])break;V=Ea(E[Y],X)}return{nodes:R,data:zm([G])}}function p(E,F,k,C){var P=E.length,R=[],G=[],Z=[],V=[],X=C-1,Y=0,te=0,ue=0,me=0;for(Y=0;Y<P;++Y)if(Z=[],ue=Y+F,ue>=P&&(ue-=P),!G[ue]){V=[];var ae=[];for(te=ue;te>=0;){ae[te]=!0,G[te]=!0,Z[Z.length]=te,V.push(E[te]);var fe=k[Math.floor(te*4/C)];if(me=te*4&X,C<4+me)throw new Error("FAT boundary crossed: "+te+" 4 "+C);if(!E[fe]||(te=Ea(E[fe],me),ae[te]))break}R[ue]={nodes:Z,data:zm([V])}}return R}function w(E,F,k,C,P,R,G,Z){for(var V=0,X=C.length?2:0,Y=F[E].data,te=0,ue=0,me;te<Y.length;te+=128){var ae=Y.slice(te,te+128);hr(ae,64),ue=ae.read_shift(2),me=Pf(ae,0,ue-X),C.push(me);var fe={name:me,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},Te=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Te!==0&&(fe.ct=T(ae,ae.l-8));var Ze=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Ze!==0&&(fe.mt=T(ae,ae.l-8)),fe.start=ae.read_shift(4,"i"),fe.size=ae.read_shift(4,"i"),fe.size<0&&fe.start<0&&(fe.size=fe.type=0,fe.start=Q,fe.name=""),fe.type===5?(V=fe.start,P>0&&V!==Q&&(F[V].name="!StreamData")):fe.size>=4096?(fe.storage="fat",F[fe.start]===void 0&&(F[fe.start]=v(k,fe.start,F.fat_addrs,F.ssz)),F[fe.start].name=fe.name,fe.content=F[fe.start].data.slice(0,fe.size)):(fe.storage="minifat",fe.size<0?fe.size=0:V!==Q&&fe.start!==Q&&F[V]&&(fe.content=m(fe,F[V].data,(F[Z]||{}).data))),fe.content&&hr(fe.content,0),R[me]=fe,G.push(fe)}}function T(E,F){return new Date((xr(E,F+4)/1e7*Math.pow(2,32)+xr(E,F)/1e7-11644473600)*1e3)}function I(E,F){return u(),d(c.readFileSync(E),F)}function L(E,F){var k=F&&F.type;switch(k||Pe&&Buffer.isBuffer(E)&&(k="buffer"),k||"base64"){case"file":return I(E,F);case"base64":return d($r(An(E)),F);case"binary":return d($r(E),F)}return d(E,F)}function j(E,F){var k=F||{},C=k.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=C+"/",E.FileIndex[0]={name:C,type:5}),k.CLSID&&(E.FileIndex[0].clsid=k.CLSID),A(E)}function A(E){var F="Sh33tJ5";if(!$e.find(E,"/"+F)){var k=q(4);k[0]=55,k[1]=k[3]=50,k[2]=54,E.FileIndex.push({name:F,type:2,content:k,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+F),y(E)}}function y(E,F){j(E);for(var k=!1,C=!1,P=E.FullPaths.length-1;P>=0;--P){var R=E.FileIndex[P];switch(R.type){case 0:C?k=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(R.R*R.L*R.C)&&(k=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(k=!0);break;default:k=!0;break}}if(!(!k&&!F)){var G=new Date(1987,1,19),Z=0,V=Object.create?Object.create(null):{},X=[];for(P=0;P<E.FullPaths.length;++P)V[E.FullPaths[P]]=!0,E.FileIndex[P].type!==0&&X.push([E.FullPaths[P],E.FileIndex[P]]);for(P=0;P<X.length;++P){var Y=n(X[P][0]);C=V[Y],C||(X.push([Y,{name:a(Y).replace("/",""),type:1,clsid:we,ct:G,mt:G,content:null}]),V[Y]=!0)}for(X.sort(function(me,ae){return r(me[0],ae[0])}),E.FullPaths=[],E.FileIndex=[],P=0;P<X.length;++P)E.FullPaths[P]=X[P][0],E.FileIndex[P]=X[P][1];for(P=0;P<X.length;++P){var te=E.FileIndex[P],ue=E.FullPaths[P];if(te.name=a(ue).replace("/",""),te.L=te.R=te.C=-(te.color=1),te.size=te.content?te.content.length:0,te.start=0,te.clsid=te.clsid||we,P===0)te.C=X.length>1?1:-1,te.size=0,te.type=5;else if(ue.slice(-1)=="/"){for(Z=P+1;Z<X.length&&n(E.FullPaths[Z])!=ue;++Z);for(te.C=Z>=X.length?-1:Z,Z=P+1;Z<X.length&&n(E.FullPaths[Z])!=n(ue);++Z);te.R=Z>=X.length?-1:Z,te.type=1}else n(E.FullPaths[P+1]||"")==n(ue)&&(te.R=P+1),te.type=2}}}function O(E,F){var k=F||{};if(k.fileType=="mad")return gy(E,k);switch(y(E),k.fileType){case"zip":return uy(E,k)}var C=function(me){for(var ae=0,fe=0,Te=0;Te<me.FileIndex.length;++Te){var Ze=me.FileIndex[Te];if(Ze.content){var et=Ze.content.length;et>0&&(et<4096?ae+=et+63>>6:fe+=et+511>>9)}}for(var Pt=me.FullPaths.length+3>>2,oi=ae+7>>3,ci=ae+127>>7,ui=oi+fe+Pt+ci,wa=ui+127>>7,yu=wa<=109?0:Math.ceil((wa-109)/127);ui+wa+yu+127>>7>wa;)yu=++wa<=109?0:Math.ceil((wa-109)/127);var dn=[1,yu,wa,ci,Pt,fe,ae,0];return me.FileIndex[0].size=ae<<6,dn[7]=(me.FileIndex[0].start=dn[0]+dn[1]+dn[2]+dn[3]+dn[4]+dn[5])+(dn[6]+7>>3),dn}(E),P=q(C[7]<<9),R=0,G=0;{for(R=0;R<8;++R)P.write_shift(1,oe[R]);for(R=0;R<8;++R)P.write_shift(2,0);for(P.write_shift(2,62),P.write_shift(2,3),P.write_shift(2,65534),P.write_shift(2,9),P.write_shift(2,6),R=0;R<3;++R)P.write_shift(2,0);for(P.write_shift(4,0),P.write_shift(4,C[2]),P.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),P.write_shift(4,0),P.write_shift(4,4096),P.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:Q),P.write_shift(4,C[3]),P.write_shift(-4,C[1]?C[0]-1:Q),P.write_shift(4,C[1]),R=0;R<109;++R)P.write_shift(-4,R<C[2]?C[1]+R:-1)}if(C[1])for(G=0;G<C[1];++G){for(;R<236+G*127;++R)P.write_shift(-4,R<C[2]?C[1]+R:-1);P.write_shift(-4,G===C[1]-1?Q:G+1)}var Z=function(me){for(G+=me;R<G-1;++R)P.write_shift(-4,R+1);me&&(++R,P.write_shift(-4,Q))};for(G=R=0,G+=C[1];R<G;++R)P.write_shift(-4,z.DIFSECT);for(G+=C[2];R<G;++R)P.write_shift(-4,z.FATSECT);Z(C[3]),Z(C[4]);for(var V=0,X=0,Y=E.FileIndex[0];V<E.FileIndex.length;++V)Y=E.FileIndex[V],Y.content&&(X=Y.content.length,!(X<4096)&&(Y.start=G,Z(X+511>>9)));for(Z(C[6]+7>>3);P.l&511;)P.write_shift(-4,z.ENDOFCHAIN);for(G=R=0,V=0;V<E.FileIndex.length;++V)Y=E.FileIndex[V],Y.content&&(X=Y.content.length,!(!X||X>=4096)&&(Y.start=G,Z(X+63>>6)));for(;P.l&511;)P.write_shift(-4,z.ENDOFCHAIN);for(R=0;R<C[4]<<2;++R){var te=E.FullPaths[R];if(!te||te.length===0){for(V=0;V<17;++V)P.write_shift(4,0);for(V=0;V<3;++V)P.write_shift(4,-1);for(V=0;V<12;++V)P.write_shift(4,0);continue}Y=E.FileIndex[R],R===0&&(Y.start=Y.size?Y.start-1:Q);var ue=R===0&&k.root||Y.name;if(X=2*(ue.length+1),P.write_shift(64,ue,"utf16le"),P.write_shift(2,X),P.write_shift(1,Y.type),P.write_shift(1,Y.color),P.write_shift(-4,Y.L),P.write_shift(-4,Y.R),P.write_shift(-4,Y.C),Y.clsid)P.write_shift(16,Y.clsid,"hex");else for(V=0;V<4;++V)P.write_shift(4,0);P.write_shift(4,Y.state||0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,Y.start),P.write_shift(4,Y.size),P.write_shift(4,0)}for(R=1;R<E.FileIndex.length;++R)if(Y=E.FileIndex[R],Y.size>=4096)if(P.l=Y.start+1<<9,Pe&&Buffer.isBuffer(Y.content))Y.content.copy(P,P.l,0,Y.size),P.l+=Y.size+511&-512;else{for(V=0;V<Y.size;++V)P.write_shift(1,Y.content[V]);for(;V&511;++V)P.write_shift(1,0)}for(R=1;R<E.FileIndex.length;++R)if(Y=E.FileIndex[R],Y.size>0&&Y.size<4096)if(Pe&&Buffer.isBuffer(Y.content))Y.content.copy(P,P.l,0,Y.size),P.l+=Y.size+63&-64;else{for(V=0;V<Y.size;++V)P.write_shift(1,Y.content[V]);for(;V&63;++V)P.write_shift(1,0)}if(Pe)P.l=P.length;else for(;P.l<P.length;)P.write_shift(1,0);return P}function B(E,F){var k=E.FullPaths.map(function(V){return V.toUpperCase()}),C=k.map(function(V){var X=V.split("/");return X[X.length-(V.slice(-1)=="/"?2:1)]}),P=!1;F.charCodeAt(0)===47?(P=!0,F=k[0].slice(0,-1)+F):P=F.indexOf("/")!==-1;var R=F.toUpperCase(),G=P===!0?k.indexOf(R):C.indexOf(R);if(G!==-1)return E.FileIndex[G];var Z=!R.match(mo);for(R=R.replace(Ui,""),Z&&(R=R.replace(mo,"!")),G=0;G<k.length;++G)if((Z?k[G].replace(mo,"!"):k[G]).replace(Ui,"")==R||(Z?C[G].replace(mo,"!"):C[G]).replace(Ui,"")==R)return E.FileIndex[G];return null}var H=64,Q=-2,ie="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(E,F,k){u();var C=O(E,k);c.writeFileSync(F,C)}function N(E){for(var F=new Array(E.length),k=0;k<E.length;++k)F[k]=String.fromCharCode(E[k]);return F.join("")}function D(E,F){var k=O(E,F);switch(F&&F.type||"buffer"){case"file":return u(),c.writeFileSync(F.filename,k),k;case"binary":return typeof k=="string"?k:N(k);case"base64":return vl(typeof k=="string"?k:N(k));case"buffer":if(Pe)return Buffer.isBuffer(k)?k:Pn(k);case"array":return typeof k=="string"?$r(k):k}return k}var b;function S(E){try{var F=E.InflateRaw,k=new F;if(k._processChunk(new Uint8Array([3,0]),k._finishFlushFlag),k.bytesRead)b=E;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function W(E,F){if(!b)return mh(E,F);var k=b.InflateRaw,C=new k,P=C._processChunk(E.slice(E.l),C._finishFlushFlag);return E.l+=C.bytesRead,P}function M(E){return b?b.deflateRawSync(E):oh(E)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(E){var F=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(F>>16|F>>8|F)&255}for(var he=typeof Uint8Array<"u",de=he?new Uint8Array(256):[],We=0;We<256;++We)de[We]=pe(We);function De(E,F){var k=de[E&255];return F<=8?k>>>8-F:(k=k<<8|de[E>>8&255],F<=16?k>>>16-F:(k=k<<8|de[E>>16&255],k>>>24-F))}function Ht(E,F){var k=F&7,C=F>>>3;return(E[C]|(k<=6?0:E[C+1]<<8))>>>k&3}function Ie(E,F){var k=F&7,C=F>>>3;return(E[C]|(k<=5?0:E[C+1]<<8))>>>k&7}function cn(E,F){var k=F&7,C=F>>>3;return(E[C]|(k<=4?0:E[C+1]<<8))>>>k&15}function at(E,F){var k=F&7,C=F>>>3;return(E[C]|(k<=3?0:E[C+1]<<8))>>>k&31}function ve(E,F){var k=F&7,C=F>>>3;return(E[C]|(k<=1?0:E[C+1]<<8))>>>k&127}function Er(E,F,k){var C=F&7,P=F>>>3,R=(1<<k)-1,G=E[P]>>>C;return k<8-C||(G|=E[P+1]<<8-C,k<16-C)||(G|=E[P+2]<<16-C,k<24-C)||(G|=E[P+3]<<24-C),G&R}function un(E,F,k){var C=F&7,P=F>>>3;return C<=5?E[P]|=(k&7)<<C:(E[P]|=k<<C&255,E[P+1]=(k&7)>>8-C),F+3}function va(E,F,k){var C=F&7,P=F>>>3;return k=(k&1)<<C,E[P]|=k,F+1}function rs(E,F,k){var C=F&7,P=F>>>3;return k<<=C,E[P]|=k&255,k>>>=8,E[P+1]=k,F+8}function lh(E,F,k){var C=F&7,P=F>>>3;return k<<=C,E[P]|=k&255,k>>>=8,E[P+1]=k&255,E[P+2]=k>>>8,F+16}function xu(E,F){var k=E.length,C=2*k>F?2*k:F+5,P=0;if(k>=F)return E;if(Pe){var R=km(C);if(E.copy)E.copy(R);else for(;P<E.length;++P)R[P]=E[P];return R}else if(he){var G=new Uint8Array(C);if(G.set)G.set(E);else for(;P<k;++P)G[P]=E[P];return G}return E.length=C,E}function Yr(E){for(var F=new Array(E),k=0;k<E;++k)F[k]=0;return F}function Kl(E,F,k){var C=1,P=0,R=0,G=0,Z=0,V=E.length,X=he?new Uint16Array(32):Yr(32);for(R=0;R<32;++R)X[R]=0;for(R=V;R<k;++R)E[R]=0;V=E.length;var Y=he?new Uint16Array(V):Yr(V);for(R=0;R<V;++R)X[P=E[R]]++,C<P&&(C=P),Y[R]=0;for(X[0]=0,R=1;R<=C;++R)X[R+16]=Z=Z+X[R-1]<<1;for(R=0;R<V;++R)Z=E[R],Z!=0&&(Y[R]=X[Z+16]++);var te=0;for(R=0;R<V;++R)if(te=E[R],te!=0)for(Z=De(Y[R],C)>>C-te,G=(1<<C+4-te)-1;G>=0;--G)F[Z|G<<te]=te&15|R<<4;return C}var pu=he?new Uint16Array(512):Yr(512),gu=he?new Uint16Array(32):Yr(32);if(!he){for(var ya=0;ya<512;++ya)pu[ya]=0;for(ya=0;ya<32;++ya)gu[ya]=0}(function(){for(var E=[],F=0;F<32;F++)E.push(5);Kl(E,gu,32);var k=[];for(F=0;F<=143;F++)k.push(8);for(;F<=255;F++)k.push(9);for(;F<=279;F++)k.push(7);for(;F<=287;F++)k.push(8);Kl(k,pu,288)})();var iy=function(){for(var F=he?new Uint8Array(32768):[],k=0,C=0;k<ce.length-1;++k)for(;C<ce[k+1];++C)F[C]=k;for(;C<32768;++C)F[C]=29;var P=he?new Uint8Array(259):[];for(k=0,C=0;k<J.length-1;++k)for(;C<J[k+1];++C)P[C]=k;function R(Z,V){for(var X=0;X<Z.length;){var Y=Math.min(65535,Z.length-X),te=X+Y==Z.length;for(V.write_shift(1,+te),V.write_shift(2,Y),V.write_shift(2,~Y&65535);Y-- >0;)V[V.l++]=Z[X++]}return V.l}function G(Z,V){for(var X=0,Y=0,te=he?new Uint16Array(32768):[];Y<Z.length;){var ue=Math.min(65535,Z.length-Y);if(ue<10){for(X=un(V,X,+(Y+ue==Z.length)),X&7&&(X+=8-(X&7)),V.l=X/8|0,V.write_shift(2,ue),V.write_shift(2,~ue&65535);ue-- >0;)V[V.l++]=Z[Y++];X=V.l*8;continue}X=un(V,X,+(Y+ue==Z.length)+2);for(var me=0;ue-- >0;){var ae=Z[Y];me=(me<<5^ae)&32767;var fe=-1,Te=0;if((fe=te[me])&&(fe|=Y&-32768,fe>Y&&(fe-=32768),fe<Y))for(;Z[fe+Te]==Z[Y+Te]&&Te<250;)++Te;if(Te>2){ae=P[Te],ae<=22?X=rs(V,X,de[ae+1]>>1)-1:(rs(V,X,3),X+=5,rs(V,X,de[ae-23]>>5),X+=3);var Ze=ae<8?0:ae-4>>2;Ze>0&&(lh(V,X,Te-J[ae]),X+=Ze),ae=F[Y-fe],X=rs(V,X,de[ae]>>3),X-=3;var et=ae<4?0:ae-2>>1;et>0&&(lh(V,X,Y-fe-ce[ae]),X+=et);for(var Pt=0;Pt<Te;++Pt)te[me]=Y&32767,me=(me<<5^Z[Y])&32767,++Y;ue-=Te-1}else ae<=143?ae=ae+48:X=va(V,X,1),X=rs(V,X,de[ae]),te[me]=Y&32767,++Y}X=rs(V,X,0)-1}return V.l=(X+7)/8|0,V.l}return function(V,X){return V.length<8?R(V,X):G(V,X)}}();function oh(E){var F=q(50+Math.floor(E.length*1.1)),k=iy(E,F);return F.slice(0,k)}var ch=he?new Uint16Array(32768):Yr(32768),uh=he?new Uint16Array(32768):Yr(32768),dh=he?new Uint16Array(128):Yr(128),fh=1,hh=1;function ly(E,F){var k=at(E,F)+257;F+=5;var C=at(E,F)+1;F+=5;var P=cn(E,F)+4;F+=4;for(var R=0,G=he?new Uint8Array(19):Yr(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,X=he?new Uint8Array(8):Yr(8),Y=he?new Uint8Array(8):Yr(8),te=G.length,ue=0;ue<P;++ue)G[U[ue]]=R=Ie(E,F),V<R&&(V=R),X[R]++,F+=3;var me=0;for(X[0]=0,ue=1;ue<=V;++ue)Y[ue]=me=me+X[ue-1]<<1;for(ue=0;ue<te;++ue)(me=G[ue])!=0&&(Z[ue]=Y[me]++);var ae=0;for(ue=0;ue<te;++ue)if(ae=G[ue],ae!=0){me=de[Z[ue]]>>8-ae;for(var fe=(1<<7-ae)-1;fe>=0;--fe)dh[me|fe<<ae]=ae&7|ue<<3}var Te=[];for(V=1;Te.length<k+C;)switch(me=dh[ve(E,F)],F+=me&7,me>>>=3){case 16:for(R=3+Ht(E,F),F+=2,me=Te[Te.length-1];R-- >0;)Te.push(me);break;case 17:for(R=3+Ie(E,F),F+=3;R-- >0;)Te.push(0);break;case 18:for(R=11+ve(E,F),F+=7;R-- >0;)Te.push(0);break;default:Te.push(me),V<me&&(V=me);break}var Ze=Te.slice(0,k),et=Te.slice(k);for(ue=k;ue<286;++ue)Ze[ue]=0;for(ue=C;ue<30;++ue)et[ue]=0;return fh=Kl(Ze,ch,286),hh=Kl(et,uh,30),F}function oy(E,F){if(E[0]==3&&!(E[1]&3))return[$a(F),2];for(var k=0,C=0,P=km(F||1<<18),R=0,G=P.length>>>0,Z=0,V=0;!(C&1);){if(C=Ie(E,k),k+=3,C>>>1)C>>1==1?(Z=9,V=5):(k=ly(E,k),Z=fh,V=hh);else{k&7&&(k+=8-(k&7));var X=E[k>>>3]|E[(k>>>3)+1]<<8;if(k+=32,X>0)for(!F&&G<R+X&&(P=xu(P,R+X),G=P.length);X-- >0;)P[R++]=E[k>>>3],k+=8;continue}for(;;){!F&&G<R+32767&&(P=xu(P,R+32767),G=P.length);var Y=Er(E,k,Z),te=C>>>1==1?pu[Y]:ch[Y];if(k+=te&15,te>>>=4,!(te>>>8&255))P[R++]=te;else{if(te==256)break;te-=257;var ue=te<8?0:te-4>>2;ue>5&&(ue=0);var me=R+J[te];ue>0&&(me+=Er(E,k,ue),k+=ue),Y=Er(E,k,V),te=C>>>1==1?gu[Y]:uh[Y],k+=te&15,te>>>=4;var ae=te<4?0:te-2>>1,fe=ce[te];for(ae>0&&(fe+=Er(E,k,ae),k+=ae),!F&&G<me&&(P=xu(P,me+100),G=P.length);R<me;)P[R]=P[R-fe],++R}}}return F?[P,k+7>>>3]:[P.slice(0,R),k+7>>>3]}function mh(E,F){var k=E.slice(E.l||0),C=oy(k,F);return E.l+=C[1],C[0]}function xh(E,F){if(E)typeof console<"u"&&console.error(F);else throw new Error(F)}function ph(E,F){var k=E;hr(k,0);var C=[],P=[],R={FileIndex:C,FullPaths:P};j(R,{root:F.root});for(var G=k.length-4;(k[G]!=80||k[G+1]!=75||k[G+2]!=5||k[G+3]!=6)&&G>=0;)--G;k.l=G+4,k.l+=4;var Z=k.read_shift(2);k.l+=6;var V=k.read_shift(4);for(k.l=V,G=0;G<Z;++G){k.l+=20;var X=k.read_shift(4),Y=k.read_shift(4),te=k.read_shift(2),ue=k.read_shift(2),me=k.read_shift(2);k.l+=8;var ae=k.read_shift(4),fe=o(k.slice(k.l+te,k.l+te+ue));k.l+=te+ue+me;var Te=k.l;k.l=ae+4,cy(k,X,Y,R,fe),k.l=Te}return R}function cy(E,F,k,C,P){E.l+=2;var R=E.read_shift(2),G=E.read_shift(2),Z=l(E);if(R&8257)throw new Error("Unsupported ZIP encryption");for(var V=E.read_shift(4),X=E.read_shift(4),Y=E.read_shift(4),te=E.read_shift(2),ue=E.read_shift(2),me="",ae=0;ae<te;++ae)me+=String.fromCharCode(E[E.l++]);if(ue){var fe=o(E.slice(E.l,E.l+ue));(fe[21589]||{}).mt&&(Z=fe[21589].mt),((P||{})[21589]||{}).mt&&(Z=P[21589].mt)}E.l+=ue;var Te=E.slice(E.l,E.l+X);switch(G){case 8:Te=W(E,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var Ze=!1;R&8&&(V=E.read_shift(4),V==134695760&&(V=E.read_shift(4),Ze=!0),X=E.read_shift(4),Y=E.read_shift(4)),X!=F&&xh(Ze,"Bad compressed size: "+F+" != "+X),Y!=k&&xh(Ze,"Bad uncompressed size: "+k+" != "+Y),vu(C,me,Te,{unsafe:!0,mt:Z})}function uy(E,F){var k=F||{},C=[],P=[],R=q(1),G=k.compression?8:0,Z=0,V=0,X=0,Y=0,te=0,ue=E.FullPaths[0],me=ue,ae=E.FileIndex[0],fe=[],Te=0;for(V=1;V<E.FullPaths.length;++V)if(me=E.FullPaths[V].slice(ue.length),ae=E.FileIndex[V],!(!ae.size||!ae.content||me=="Sh33tJ5")){var Ze=Y,et=q(me.length);for(X=0;X<me.length;++X)et.write_shift(1,me.charCodeAt(X)&127);et=et.slice(0,et.l),fe[te]=K_.buf(ae.content,0);var Pt=ae.content;G==8&&(Pt=M(Pt)),R=q(30),R.write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,Z),R.write_shift(2,G),ae.mt?s(R,ae.mt):R.write_shift(4,0),R.write_shift(-4,fe[te]),R.write_shift(4,Pt.length),R.write_shift(4,ae.content.length),R.write_shift(2,et.length),R.write_shift(2,0),Y+=R.length,C.push(R),Y+=et.length,C.push(et),Y+=Pt.length,C.push(Pt),R=q(46),R.write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,Z),R.write_shift(2,G),R.write_shift(4,0),R.write_shift(-4,fe[te]),R.write_shift(4,Pt.length),R.write_shift(4,ae.content.length),R.write_shift(2,et.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,Ze),Te+=R.l,P.push(R),Te+=et.length,P.push(et),++te}return R=q(22),R.write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,te),R.write_shift(2,te),R.write_shift(4,Te),R.write_shift(4,Y),R.write_shift(2,0),kt([kt(C),kt(P),R])}var Gl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function dy(E,F){if(E.ctype)return E.ctype;var k=E.name||"",C=k.match(/\.([^\.]+)$/);return C&&Gl[C[1]]||F&&(C=(k=F).match(/[\.\\]([^\.\\])+$/),C&&Gl[C[1]])?Gl[C[1]]:"application/octet-stream"}function fy(E){for(var F=vl(E),k=[],C=0;C<F.length;C+=76)k.push(F.slice(C,C+76));return k.join(`\r
`)+`\r
`}function hy(E){var F=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var Y=X.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var k=[],C=F.split(`\r
`),P=0;P<C.length;++P){var R=C[P];if(R.length==0){k.push("");continue}for(var G=0;G<R.length;){var Z=76,V=R.slice(G,G+Z);V.charAt(Z-1)=="="?Z--:V.charAt(Z-2)=="="?Z-=2:V.charAt(Z-3)=="="&&(Z-=3),V=R.slice(G,G+Z),G+=Z,G<R.length&&(V+="="),k.push(V)}}return k.join(`\r
`)}function my(E){for(var F=[],k=0;k<E.length;++k){for(var C=E[k];k<=E.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+E[++k];F.push(C)}for(var P=0;P<F.length;++P)F[P]=F[P].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return $r(F.join(`\r
`))}function xy(E,F,k){for(var C="",P="",R="",G,Z=0;Z<10;++Z){var V=F[Z];if(!V||V.match(/^\s*$/))break;var X=V.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":C=X[2].trim();break;case"content-type":R=X[2].trim();break;case"content-transfer-encoding":P=X[2].trim();break}}switch(++Z,P.toLowerCase()){case"base64":G=$r(An(F.slice(Z).join("")));break;case"quoted-printable":G=my(F.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+P)}var Y=vu(E,C.slice(k.length),G,{unsafe:!0});R&&(Y.ctype=R)}function py(E,F){if(N(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var k=F&&F.root||"",C=(Pe&&Buffer.isBuffer(E)?E.toString("binary"):N(E)).split(`\r
`),P=0,R="";for(P=0;P<C.length;++P)if(R=C[P],!!/^Content-Location:/i.test(R)&&(R=R.slice(R.indexOf("file")),k||(k=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,k.length)!=k))for(;k.length>0&&(k=k.slice(0,k.length-1),k=k.slice(0,k.lastIndexOf("/")+1),R.slice(0,k.length)!=k););var G=(C[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Z="--"+(G[1]||""),V=[],X=[],Y={FileIndex:V,FullPaths:X};j(Y);var te,ue=0;for(P=0;P<C.length;++P){var me=C[P];me!==Z&&me!==Z+"--"||(ue++&&xy(Y,C.slice(te,P),k),te=P)}return Y}function gy(E,F){var k=F||{},C=k.boundary||"SheetJS";C="------="+C;for(var P=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],R=E.FullPaths[0],G=R,Z=E.FileIndex[0],V=1;V<E.FullPaths.length;++V)if(G=E.FullPaths[V].slice(R.length),Z=E.FileIndex[V],!(!Z.size||!Z.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Te){return"_x"+Te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Te){return"_u"+Te.charCodeAt(0).toString(16)+"_"});for(var X=Z.content,Y=Pe&&Buffer.isBuffer(X)?X.toString("binary"):N(X),te=0,ue=Math.min(1024,Y.length),me=0,ae=0;ae<=ue;++ae)(me=Y.charCodeAt(ae))>=32&&me<128&&++te;var fe=te>=ue*4/5;P.push(C),P.push("Content-Location: "+(k.root||"file:///C:/SheetJS/")+G),P.push("Content-Transfer-Encoding: "+(fe?"quoted-printable":"base64")),P.push("Content-Type: "+dy(Z,G)),P.push(""),P.push(fe?hy(Y):fy(Y))}return P.push(C+`--\r
`),P.join(`\r
`)}function vy(E){var F={};return j(F,E),F}function vu(E,F,k,C){var P=C&&C.unsafe;P||j(E);var R=!P&&$e.find(E,F);if(!R){var G=E.FullPaths[0];F.slice(0,G.length)==G?G=F:(G.slice(-1)!="/"&&(G+="/"),G=(G+F).replace("//","/")),R={name:a(F),type:2},E.FileIndex.push(R),E.FullPaths.push(G),P||$e.utils.cfb_gc(E)}return R.content=k,R.size=k?k.length:0,C&&(C.CLSID&&(R.clsid=C.CLSID),C.mt&&(R.mt=C.mt),C.ct&&(R.ct=C.ct)),R}function yy(E,F){j(E);var k=$e.find(E,F);if(k){for(var C=0;C<E.FileIndex.length;++C)if(E.FileIndex[C]==k)return E.FileIndex.splice(C,1),E.FullPaths.splice(C,1),!0}return!1}function wy(E,F,k){j(E);var C=$e.find(E,F);if(C){for(var P=0;P<E.FileIndex.length;++P)if(E.FileIndex[P]==C)return E.FileIndex[P].name=a(k),E.FullPaths[P]=k,!0}return!1}function _y(E){y(E,!0)}return t.find=B,t.read=L,t.parse=d,t.write=D,t.writeFile=K,t.utils={cfb_new:vy,cfb_add:vu,cfb_del:yy,cfb_mov:wy,cfb_gc:_y,ReadShift:Wi,CheckField:N1,prep_blob:hr,bconcat:kt,use_zlib:S,_deflateRaw:oh,_inflateRaw:mh,consts:z},t}();function G_(e){return typeof e=="string"?au(e):Array.isArray(e)?y_(e):e}function Ml(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=au(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?wl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([G_(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ll(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Ot(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Rm(e,t){for(var r=[],n=Ot(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Af(e){for(var t=[],r=Ot(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function lu(e){for(var t=[],r=Ot(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function X_(e){for(var t=[],r=Ot(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Ec=new Date(1899,11,30,0,0,0);function lr(e,t){var r=e.getTime(),n=Ec.getTime()+(e.getTimezoneOffset()-Ec.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var s1=new Date,Y_=Ec.getTime()+(s1.getTimezoneOffset()-Ec.getTimezoneOffset())*6e4,Lm=s1.getTimezoneOffset();function i1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Y_),t.getTimezoneOffset()!==Lm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Lm)*6e4),t}var Mm=new Date("2017-02-19T19:06:09.000Z"),l1=isNaN(Mm.getFullYear())?new Date("2/19/17"):Mm,q_=l1.getFullYear()==2017;function qt(e,t){var r=new Date(e);if(q_)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(l1.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ou(e,t){if(Pe&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function or(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=or(e[r]));return t}function it(e,t){for(var r="";r.length<t;)r+=e;return r}function Nn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Q_=["january","february","march","april","may","june","july","august","september","october","november","december"];function yl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&Q_.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function ke(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Pe?n=Pn(r):n=w_(r),$e.utils.cfb_add(e,t,n)}$e.utils.cfb_add(e,t,r)}else e.file(t,r)}function Df(){return $e.utils.cfb_new()}var ht=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,J_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ff=Af(J_),Of=/[&<>'"]/g,Z_=/[\u0000-\u0008\u000b-\u001f]/g;function Me(e){var t=e+"";return t.replace(Of,function(r){return Ff[r]}).replace(Z_,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bm(e){return Me(e).replace(/ /g,"_x0020_")}var o1=/[\u0000-\u001f]/g;function eN(e){var t=e+"";return t.replace(Of,function(r){return Ff[r]}).replace(/\n/g,"<br/>").replace(o1,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function tN(e){var t=e+"";return t.replace(Of,function(r){return Ff[r]}).replace(o1,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function rN(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function nN(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gu(e){for(var t="",r=0,n=0,a=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Um(e){var t=$a(2*e.length),r,n,a=1,s=0,l=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function $m(e){return Pn(e,"binary").toString("utf8")}var po="foo bar bazâð£",$i=Pe&&($m(po)==Gu(po)&&$m||Um(po)==Gu(po)&&Um)||Gu,wl=Pe?function(e){return Pn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},aN=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),c1=/(^\s|\s$|\n)/;function Ct(e,t){return"<"+e+(t.match(c1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function _l(e){return Ot(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function se(e,t,r){return"<"+e+(r!=null?_l(r):"")+(t!=null?(t.match(c1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function nd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function sN(e,t){switch(typeof e){case"string":var r=se("vt:lpwstr",Me(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return se((e|0)==e?"vt:i4":"vt:r8",Me(String(e)));case"boolean":return se("vt:bool",e?"true":"false")}if(e instanceof Date)return se("vt:filetime",nd(e));throw new Error("Unable to serialize "+e)}var wt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ei=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],mr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function iN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function lN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,l=n?-t:t;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Wm=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},zm=Pe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Pn(t)})):Wm(e)}:Wm,Hm=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ti(e,a)));return n.join("").replace(Ui,"")},Pf=Pe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ui,""):Hm(e,t,r)}:Hm,Vm=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},u1=Pe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Vm(e,t,r)}:Vm,Km=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(cs(e,a)));return n.join("")},Bl=Pe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Km(t,r,n)}:Km,d1=function(e,t){var r=xr(e,t);return r>0?Bl(e,t+4,t+4+r-1):""},f1=d1,h1=function(e,t){var r=xr(e,t);return r>0?Bl(e,t+4,t+4+r-1):""},m1=h1,x1=function(e,t){var r=2*xr(e,t);return r>0?Bl(e,t+4,t+4+r-1):""},p1=x1,g1=function(t,r){var n=xr(t,r);return n>0?Pf(t,r+4,r+4+n):""},v1=g1,y1=function(e,t){var r=xr(e,t);return r>0?Bl(e,t+4,t+4+r):""},w1=y1,_1=function(e,t){return iN(e,t)},jc=_1,If=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Pe&&(f1=function(t,r){if(!Buffer.isBuffer(t))return d1(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},m1=function(t,r){if(!Buffer.isBuffer(t))return h1(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},p1=function(t,r){if(!Buffer.isBuffer(t))return x1(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},v1=function(t,r){if(!Buffer.isBuffer(t))return g1(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},w1=function(t,r){if(!Buffer.isBuffer(t))return y1(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},jc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_1(t,r)},If=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var cs=function(e,t){return e[t]},Ti=function(e,t){return e[t+1]*256+e[t]},oN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},xr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ea=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},cN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Wi(e,t){var r="",n,a,s=[],l,o,c,u;switch(t){case"dbcs":if(u=this.l,Pe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ti(this,u)),u+=2;e*=2;break;case"utf8":r=Bl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Pf(this,this.l,this.l+e);break;case"wstr":return Wi.call(this,e,"dbcs");case"lpstr-ansi":r=f1(this,this.l),e=4+xr(this,this.l);break;case"lpstr-cp":r=m1(this,this.l),e=4+xr(this,this.l);break;case"lpwstr":r=p1(this,this.l),e=4+2*xr(this,this.l);break;case"lpp4":e=4+xr(this,this.l),r=v1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+xr(this,this.l),r=w1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=cs(this,this.l+e++))!==0;)s.push(ho(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=Ti(this,this.l+e))!==0;)s.push(ho(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=cs(this,u),this.l=u+1,o=Wi.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ho(Ti(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=cs(this,u),this.l=u+1,o=Wi.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ho(cs(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=cs(this,this.l),this.l++,n;case 2:return n=(t==="i"?oN:Ti)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ea:cN)(this,this.l),this.l+=4,n):(a=xr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=jc(this,this.l):a=jc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=u1(this,this.l,e);break}}return this.l+=e,r}var uN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},dN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},fN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function hN(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)fN(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,uN(this,t,this.l);break;case 8:if(n=8,r==="f"){lN(this,t,this.l);break}case 16:break;case-4:n=4,dN(this,t,this.l);break}return this.l+=n,this}function N1(e,t){var r=u1(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hr(e,t){e.l=t,e.read_shift=Wi,e.chk=N1,e.write_shift=hN}function ln(e,t){e.l+=t}function q(e){var t=$a(e);return hr(t,0),t}function ir(){var e=[],t=Pe?256:2048,r=function(u){var d=q(u);return hr(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},l=function(){return a(),kt(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function ee(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=iS[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&If(r)&&e.push(r)}}function zi(e,t,r){var n=or(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Gm(e,t,r){var n=or(e);return n.s=zi(n.s,t.s,r),n.e=zi(n.e,t.s,r),n}function Hi(e,t){if(e.cRel&&e.c<0)for(e=or(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=or(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=pN(r)),!e.rRel&&e.rRel!=null&&(r=mN(r)),r}function Xu(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dt(e.s.r)+":"+(e.e.rRel?"":"$")+Dt(e.e.r):Hi(e.s,t.biff)+":"+Hi(e.e,t.biff)}function Rf(e){return parseInt(xN(e),10)-1}function Dt(e){return""+(e+1)}function mN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xN(e){return e.replace(/\$(\d+)$/,"$1")}function Lf(e){for(var t=gN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pN(e){return e.replace(/^([A-Z])/,"$$$1")}function gN(e){return e.replace(/^\$([A-Z])/,"$1")}function vN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _t(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function wr(e){var t=e.indexOf(":");return t==-1?{s:_t(e),e:_t(e)}:{s:_t(e.slice(0,t)),e:_t(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Xm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=oa(e.z,r?lr(t):t)}catch{}try{return e.w=oa((e.XF||{}).numFmtId||(r?14:0),r?lr(t):t)}catch{return""+t}}function Dn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ul[e.v]||e.v:t==null?Xm(e,e.v):Xm(e,t))}function Ya(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function b1(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?_t(n.origin):n.origin;l=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=qe(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var x={v:t[f][h]},g=l+f,m=o+h;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))x=t[f][h];else if(Array.isArray(x.v)&&(x.f=t[f][h][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||lt[14],n.cellDates?(x.t="d",x.w=oa(x.z,lr(x.v))):(x.t="n",x.v=lr(x.v),x.w=oa(x.z,x.v))):x.t="s";if(a)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(x.z=s[g][m].z),s[g][m]=x;else{var _=Ue({c:m,r:g});s[_]&&s[_].z&&(x.z=s[_].z),s[_]=x}}}return u.s.c<1e7&&(s["!ref"]=dt(u)),s}function ti(e,t){return b1(null,e,t)}function yN(e){return e.read_shift(4,"i")}function Kr(e,t){return t||(t=q(4)),t.write_shift(4,e),t}function Wt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Nt(e,t){var r=!1;return t==null&&(r=!0,t=q(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function wN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function _N(e,t){return t||(t=q(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Mf(e,t){var r=e.l,n=e.read_shift(1),a=Wt(e),s=[],l={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(wN(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function NN(e,t){var r=!1;return t==null&&(r=!0,t=q(15+4*e.t.length)),t.write_shift(1,0),Nt(e.t,t),r?t.slice(0,t.l):t}var bN=Mf;function EN(e,t){var r=!1;return t==null&&(r=!0,t=q(23+4*e.t.length)),t.write_shift(1,1),Nt(e.t,t),t.write_shift(4,1),_N({},t),r?t.slice(0,t.l):t}function Pr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function qa(e,t){return t==null&&(t=q(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Qa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ja(e,t){return t==null&&(t=q(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var jN=Wt,E1=Nt;function Bf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Sc(e,t){var r=!1;return t==null&&(r=!0,t=q(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var SN=Wt,ad=Bf,Uf=Sc;function j1(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?jc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ea(t,0)>>2;return r?a/100:a}function S1(e,t){t==null&&(t=q(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function T1(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function TN(e,t){return t||(t=q(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Za=T1,ri=TN;function ni(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Wa(e,t){return(t||q(8)).write_shift(8,e,"f")}function kN(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=LN[a];u&&(t.rgb=sx(u));break;case 2:t.rgb=sx([l,o,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Tc(e,t){if(t||(t=q(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function CN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function AN(e,t){t||(t=q(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var k1=2,dr=3,go=11,kc=19,vo=64,DN=65,FN=71,ON=4108,PN=4126,St=80,Ym={1:{n:"CodePage",t:k1},2:{n:"Category",t:St},3:{n:"PresentationFormat",t:St},4:{n:"ByteCount",t:dr},5:{n:"LineCount",t:dr},6:{n:"ParagraphCount",t:dr},7:{n:"SlideCount",t:dr},8:{n:"NoteCount",t:dr},9:{n:"HiddenCount",t:dr},10:{n:"MultimediaClipCount",t:dr},11:{n:"ScaleCrop",t:go},12:{n:"HeadingPairs",t:ON},13:{n:"TitlesOfParts",t:PN},14:{n:"Manager",t:St},15:{n:"Company",t:St},16:{n:"LinksUpToDate",t:go},17:{n:"CharacterCount",t:dr},19:{n:"SharedDoc",t:go},22:{n:"HyperlinksChanged",t:go},23:{n:"AppVersion",t:dr,p:"version"},24:{n:"DigSig",t:DN},26:{n:"ContentType",t:St},27:{n:"ContentStatus",t:St},28:{n:"Language",t:St},29:{n:"Version",t:St},255:{},2147483648:{n:"Locale",t:kc},2147483651:{n:"Behavior",t:kc},1919054434:{}},qm={1:{n:"CodePage",t:k1},2:{n:"Title",t:St},3:{n:"Subject",t:St},4:{n:"Author",t:St},5:{n:"Keywords",t:St},6:{n:"Comments",t:St},7:{n:"Template",t:St},8:{n:"LastAuthor",t:St},9:{n:"RevNumber",t:St},10:{n:"EditTime",t:vo},11:{n:"LastPrinted",t:vo},12:{n:"CreatedDate",t:vo},13:{n:"ModifiedDate",t:vo},14:{n:"PageCount",t:dr},15:{n:"WordCount",t:dr},16:{n:"CharCount",t:dr},17:{n:"Thumbnail",t:FN},18:{n:"Application",t:St},19:{n:"DocSecurity",t:dr},255:{},2147483648:{n:"Locale",t:kc},2147483651:{n:"Behavior",t:kc},1919054434:{}};function IN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var RN=IN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),LN=or(RN),Ul={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},MN={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},yo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function C1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function A1(e,t){var r=X_(MN),n=[],a;n[n.length]=ht,n[n.length]=se("Types",null,{xmlns:wt.CT,"xmlns:xsd":wt.xsd,"xmlns:xsi":wt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return se("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=se("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:yo[c][t.bookType]||yo[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:yo[c][t.bookType]||yo[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Oe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function D1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Os(e){var t=[ht,se("Relationships",null,{xmlns:wt.RELS})];return Ot(e["!id"]).forEach(function(r){t[t.length]=se("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Le(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Oe.HLINK,Oe.XPATH,Oe.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function BN(e){var t=[ht];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Qm(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function UN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function $N(e){var t=[ht];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Qm(e[r][0],e[r][1])),t.push(UN("",e[r][0]));return t.push(Qm("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function F1(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yc.version+"</meta:generator></office:meta></office:document-meta>"}var Da=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Yu(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Me(t),n[n.length]=r?se(e,t,r):Ct(e,t))}function O1(e,t){var r=t||{},n=[ht,se("cp:coreProperties",null,{"xmlns:cp":wt.CORE_PROPS,"xmlns:dc":wt.dc,"xmlns:dcterms":wt.dcterms,"xmlns:dcmitype":wt.dcmitype,"xmlns:xsi":wt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Yu("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:nd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Yu("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:nd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Da.length;++s){var l=Da[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Yu(l[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ps=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],P1=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function I1(e){var t=[],r=se;return e||(e={}),e.Application="SheetJS",t[t.length]=ht,t[t.length]=se("Properties",null,{xmlns:wt.EXT_PROPS,"xmlns:vt":wt.vt}),Ps.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Me(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Me(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function R1(e){var t=[ht,se("Properties",null,{xmlns:wt.CUST_PROPS,"xmlns:vt":wt.vt})];if(!e)return t.join("");var r=1;return Ot(e).forEach(function(a){++r,t[t.length]=se("property",sN(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Me(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Jm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function WN(e,t){var r=[];return Ot(Jm).map(function(n){for(var a=0;a<Da.length;++a)if(Da[a][1]==n)return Da[a];for(a=0;a<Ps.length;++a)if(Ps[a][1]==n)return Ps[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Ct(Jm[n[1]]||n[1],a))}}),se("DocumentProperties",r.join(""),{xmlns:mr.o})}function zN(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Ot(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Da.length;++l)if(s==Da[l][1])return;for(l=0;l<Ps.length;++l)if(s==Ps[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(se(Bm(s),o,{"dt:dt":c}))}}),t&&Ot(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),a.push(se(Bm(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+mr.o+'">'+a.join("")+"</"+n+">"}function HN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=q(8);return l.write_shift(4,n),l.write_shift(4,a),l}function Zm(e,t){var r=q(4),n=q(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=q(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=HN(t);break;case 31:case 80:for(n=q(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return kt([r,n])}var L1=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function VN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ex(e,t,r){var n=q(8),a=[],s=[],l=8,o=0,c=q(8),u=q(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),l+=8+c.length,!t){u=q(8),u.write_shift(4,0),a.unshift(u);var d=[q(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=q(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=kt(d),s.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(L1.indexOf(e[o][0])>-1||P1.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],x=0;if(t){x=+t[e[o][0]];var g=r[x];if(g.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}c=Zm(g.t,h)}else{var _=VN(h);_==-1&&(_=31,h=String(h)),c=Zm(_,h)}s.push(c),u=q(8),u.write_shift(4,t?x:2+o),a.push(u),l+=8+c.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),kt([n].concat(a).concat(s))}function tx(e,t,r,n,a,s){var l=q(a?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var c=ex(e,r,n);if(o.push(c),a){var u=ex(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+c.length),o.push(u)}return kt(o)}function KN(e,t){t||(t=q(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function GN(e,t){return e.read_shift(t)===1}function Gt(e,t){return t||(t=q(2)),t.write_shift(2,+!!e),t}function M1(e){return e.read_shift(2,"u")}function Sr(e,t){return t||(t=q(2)),t.write_shift(2,e),t}function B1(e,t,r){return r||(r=q(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function U1(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function XN(e){var t=e.t||"",r=q(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=q(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return kt(a)}function YN(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function qN(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):YN(e,n,r)}function QN(e,t,r){if(r.biff>5)return qN(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function $1(e,t,r){return r||(r=q(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function rx(e,t){t||(t=q(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function JN(e){var t=q(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),rx(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&rx(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function za(e,t,r,n){return n||(n=q(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function ZN(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,s,l]}function eb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function W1(e,t){return t||(t=q(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function $f(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=q(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function tb(e,t){var r=!t||t.biff==8,n=q(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function rb(e,t){var r=!t||t.biff>=8?2:1,n=q(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function nb(e,t){var r=q(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=XN(e[a]);var s=kt([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function ab(){var e=q(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function sb(e){var t=q(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function ib(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=q(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function lb(e,t,r,n){var a=q(10);return za(e,t,n,a),a.write_shift(4,r),a}function ob(e,t,r,n,a){var s=!a||a.biff==8,l=q(8+ +s+(1+s)*r.length);return za(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function cb(e,t,r,n){var a=r&&r.biff==5;n||(n=q(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function ub(e,t){var r=t.biff==8||!t.biff?4:2,n=q(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function nx(e,t,r,n){var a=r&&r.biff==5;n||(n=q(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function db(e){var t=q(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function fb(e,t,r,n,a,s){var l=q(8);return za(e,t,n,l),B1(r,s,l),l}function hb(e,t,r,n){var a=q(14);return za(e,t,n,a),Wa(r,a),a}function mb(e,t,r){if(r.biff<8)return xb(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(ZN(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function xb(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=U1(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function pb(e){var t=q(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)W1(e[r],t);return t}function gb(e){var t=q(24),r=_t(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return kt([t,JN(e[1])])}function vb(e){var t=e[1].Tooltip,r=q(10+2*(t.length+1));r.write_shift(2,2048);var n=_t(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function yb(e){return e||(e=q(4)),e.write_shift(2,1),e.write_shift(2,1),e}function wb(e,t,r){if(!r.cellStyles)return ln(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function _b(e,t){var r=q(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Nb(e){for(var t=q(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function bb(e,t,r){var n=q(15);return Wl(n,e,t),n.write_shift(8,r,"f"),n}function Eb(e,t,r){var n=q(9);return Wl(n,e,t),n.write_shift(2,r),n}var jb=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Af({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=$a(1);switch(c.type){case"base64":d=$r(An(o));break;case"binary":d=$r(o);break;case"buffer":case"array":d=o;break}hr(d,0);var f=d.read_shift(1),h=!!(f&136),x=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:x=!0,h=!0;break;case 49:x=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,_=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(_=d.read_shift(2));var v=d.read_shift(2),p=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(p=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var w=[],T={},I=Math.min(d.length,f==2?521:_-10-(x?264:0)),L=g?32:11;d.l<I&&d[d.l]!=13;)switch(T={},T.name=wc.utils.decode(p,d.slice(d.l,d.l+L)).replace(/[\u0000\r\n].*$/g,""),d.l+=L,T.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),f==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&w.push(T),f!=2&&(d.l+=g?13:14),T.type){case"B":(!x||T.len!=8)&&c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var j=0,A=0;for(u[0]=[],A=0;A!=w.length;++A)u[0][A]=w[A].name;for(;m-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++j]=[],A=0,A=0;A!=w.length;++A){var y=d.slice(d.l,d.l+w[A].len);d.l+=w[A].len,hr(y,0);var O=wc.utils.decode(p,y);switch(w[A].type){case"C":O.trim().length&&(u[j][A]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[j][A]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[j][A]=O;break;case"F":u[j][A]=parseFloat(O.trim());break;case"+":case"I":u[j][A]=g?y.read_shift(-4,"i")^2147483648:y.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[j][A]=!0;break;case"N":case"F":u[j][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[j][A]="##MEMO##"+(g?parseInt(O.trim(),10):y.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[j][A]=+O||0);break;case"@":u[j][A]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":u[j][A]=new Date((y.read_shift(4)-2440588)*864e5+y.read_shift(4));break;case"Y":u[j][A]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[j][A]=-y.read_shift(-8,"f");break;case"B":if(x&&w[A].len==8){u[j][A]=y.read_shift(8,"f");break}case"G":case"P":y.l+=w[A].len;break;case"0":if(w[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[A].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ti(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(o,c){try{return Ya(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var u=c||{};if(+u.codepage>=0&&gl(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ir(),f=Oc(o,{header:1,raw:!0,cellDates:!0}),h=f[0],x=f.slice(1),g=o["!cols"]||[],m=0,_=0,v=0,p=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(_=0;_<1024;++_)if(h.indexOf(h[m]+"_"+_)==-1){h[m]+="_"+_;break}}}}var w=qe(o["!ref"]),T=[],I=[],L=[];for(m=0;m<=w.e.c-w.s.c;++m){var j="",A="",y=0,O=[];for(_=0;_<x.length;++_)x[_][m]!=null&&O.push(x[_][m]);if(O.length==0||h[m]==null){T[m]="?";continue}for(_=0;_<O.length;++_){switch(typeof O[_]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=O[_]instanceof Date?"D":"C";break;default:A="C"}y=Math.max(y,String(O[_]).length),j=j&&j!=A?"C":A}y>250&&(y=250),A=((g[m]||{}).DBF||{}).type,A=="C"&&g[m].DBF.len>y&&(y=g[m].DBF.len),j=="B"&&A=="N"&&(j="N",L[m]=g[m].DBF.dec,y=g[m].DBF.len),I[m]=j=="C"||A=="N"?y:s[j]||0,p+=I[m],T[m]=j}var B=d.next(32);for(B.write_shift(4,318902576),B.write_shift(4,x.length),B.write_shift(2,296+32*v),B.write_shift(2,p),m=0;m<4;++m)B.write_shift(4,0);for(B.write_shift(4,0|(+t[Hg]||3)<<8),m=0,_=0;m<h.length;++m)if(h[m]!=null){var H=d.next(32),Q=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,Q,"sbcs"),H.write_shift(1,T[m]=="?"?"C":T[m],"sbcs"),H.write_shift(4,_),H.write_shift(1,I[m]||s[T[m]]||0),H.write_shift(1,L[m]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),_+=I[m]||s[T[m]]||0}var ie=d.next(264);for(ie.write_shift(4,13),m=0;m<65;++m)ie.write_shift(4,0);for(m=0;m<x.length;++m){var oe=d.next(p);for(oe.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(T[_]){case"L":oe.write_shift(1,x[m][_]==null?63:x[m][_]?84:70);break;case"B":oe.write_shift(8,x[m][_]||0,"f");break;case"N":var we="0";for(typeof x[m][_]=="number"&&(we=x[m][_].toFixed(L[_]||0)),v=0;v<I[_]-we.length;++v)oe.write_shift(1,32);oe.write_shift(1,we,"sbcs");break;case"D":x[m][_]?(oe.write_shift(4,("0000"+x[m][_].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(x[m][_].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+x[m][_].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var z=String(x[m][_]!=null?x[m][_]:"").slice(0,I[_]);for(oe.write_shift(1,z,"sbcs"),v=0;v<I[_]-z.length;++v)oe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),Sb=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ot(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,x){var g=e[x];return typeof g=="number"?Tm(g):g},n=function(h,x,g){var m=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:Tm(m)};e["|"]=254;function a(h,x){switch(x.type){case"base64":return s(An(h),x);case"binary":return s(h,x);case"buffer":return s(Pe&&Buffer.isBuffer(h)?h.toString("binary"):Ll(h),x);case"array":return s(ou(h),x)}throw new Error("Unrecognized type "+x.type)}function s(h,x){var g=h.split(/[\n\r]+/),m=-1,_=-1,v=0,p=0,w=[],T=[],I=null,L={},j=[],A=[],y=[],O=0,B;for(+x.codepage>=0&&gl(+x.codepage);v!==g.length;++v){O=0;var H=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Q=H.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),ie=Q[0],oe;if(H.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&T.push(H.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,z=!1,K=!1,N=!1,D=-1,b=-1;for(p=1;p<Q.length;++p)switch(Q[p].charAt(0)){case"A":break;case"X":_=parseInt(Q[p].slice(1))-1,z=!0;break;case"Y":for(m=parseInt(Q[p].slice(1))-1,z||(_=0),B=w.length;B<=m;++B)w[B]=[];break;case"K":oe=Q[p].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(Nn(oe))?isNaN(yl(oe).getDate())||(oe=qt(oe)):(oe=Nn(oe),I!==null&&r1(I)&&(oe=i1(oe))),we=!0;break;case"E":N=!0;var S=E4(Q[p].slice(1),{r:m,c:_});w[m][_]=[w[m][_],S];break;case"S":K=!0,w[m][_]=[w[m][_],"S5S"];break;case"G":break;case"R":D=parseInt(Q[p].slice(1))-1;break;case"C":b=parseInt(Q[p].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+H)}if(we&&(w[m][_]&&w[m][_].length==2?w[m][_][0]=oe:w[m][_]=oe,I=null),K){if(N)throw new Error("SYLK shared formula cannot have own formula");var W=D>-1&&w[D][b];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");w[m][_][1]=j4(W[1],{r:m-D,c:_-b})}break;case"F":var M=0;for(p=1;p<Q.length;++p)switch(Q[p].charAt(0)){case"X":_=parseInt(Q[p].slice(1))-1,++M;break;case"Y":for(m=parseInt(Q[p].slice(1))-1,B=w.length;B<=m;++B)w[B]=[];break;case"M":O=parseInt(Q[p].slice(1))/20;break;case"F":break;case"G":break;case"P":I=T[parseInt(Q[p].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(y=Q[p].slice(1).split(" "),B=parseInt(y[0],10);B<=parseInt(y[1],10);++B)O=parseInt(y[2],10),A[B-1]=O===0?{hidden:!0}:{wch:O},Wf(A[B-1]);break;case"C":_=parseInt(Q[p].slice(1))-1,A[_]||(A[_]={});break;case"R":m=parseInt(Q[p].slice(1))-1,j[m]||(j[m]={}),O>0?(j[m].hpt=O,j[m].hpx=G1(O)):O===0&&(j[m].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+H)}M<1&&(I=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+H)}}return j.length>0&&(L["!rows"]=j),A.length>0&&(L["!cols"]=A),x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),[w,L]}function l(h,x){var g=a(h,x),m=g[0],_=g[1],v=ti(m,x);return Ot(_).forEach(function(p){v[p]=_[p]}),v}function o(h,x){return Ya(l(h,x),x)}function c(h,x,g,m){var _="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+Hf(h.f,{r:g,c:m}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(h,x){x.forEach(function(g,m){var _="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Cc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Ac(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function d(h,x){x.forEach(function(g,m){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*Dc(g.hpx)+";"),_.length>2&&h.push(_+"R"+(m+1))})}function f(h,x){var g=["ID;PWXL;N;E"],m=[],_=qe(h["!ref"]),v,p=Array.isArray(h),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&u(g,h["!cols"]),h["!rows"]&&d(g,h["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var T=_.s.r;T<=_.e.r;++T)for(var I=_.s.c;I<=_.e.c;++I){var L=Ue({r:T,c:I});v=p?(h[T]||[])[I]:h[L],!(!v||v.v==null&&(!v.f||v.F))&&m.push(c(v,h,T,I))}return g.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:f}}(),Tb=function(){function e(s,l){switch(l.type){case"base64":return t(An(s),l);case"binary":return t(s,l);case"buffer":return t(Pe&&Buffer.isBuffer(s)?s.toString("binary"):Ll(s),l);case"array":return t(ou(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),x=h[0],g=h[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+x){case-1:if(m==="BOT"){f[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][u]=!0:m==="FALSE"?f[c][u]=!1:isNaN(Nn(g))?isNaN(yl(g).getDate())?f[c][u]=g:f[c][u]=qt(g):f[c][u]=Nn(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(s,l){return ti(e(s,l),l)}function n(s,l){return Ya(r(s,l),l)}var a=function(){var s=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},l=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=qe(c["!ref"]),f,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){l(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var m=Ue({r:x,c:g});if(f=h?(c[x]||[])[g]:c[m],!f){l(u,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?l(u,1,0,"="+f.f):l(u,1,0,""):l(u,0,_,"V");break;case"b":l(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=oa(f.z||lt[14],lr(qt(f.v)))),l(u,0,f.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var v=`\r
`,p=u.join(v);return p}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),z1=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var x=f.split(`
`),g=-1,m=-1,_=0,v=[];_!==x.length;++_){var p=x[_].trim().split(":");if(p[0]==="cell"){var w=_t(p[1]);if(v.length<=w.r)for(g=v.length;g<=w.r;++g)v[g]||(v[g]=[]);switch(g=w.r,m=w.c,p[2]){case"t":v[g][m]=e(p[3]);break;case"v":v[g][m]=+p[3];break;case"vtf":var T=p[p.length-1];case"vtc":switch(p[3]){case"nl":v[g][m]=!!+p[4];break;default:v[g][m]=+p[4];break}p[2]=="vtf"&&(v[g][m]=[v[g][m],T])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return ti(r(f,h),h)}function a(f,h){return Ya(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],x=[],g,m="",_=wr(f["!ref"]),v=Array.isArray(f),p=_.s.r;p<=_.e.r;++p)for(var w=_.s.c;w<=_.e.c;++w)if(m=Ue({r:p,c:w}),g=v?(f[p]||[])[w]:f[m],!(!g||g.v==null||g.t==="z")){switch(x=["cell",m,"t"],g.t){case"s":case"str":x.push(t(g.v));break;case"n":g.f?(x[2]="vtf",x[3]="n",x[4]=g.v,x[5]=t(g.f)):(x[2]="v",x[3]=g.v);break;case"b":x[2]="vt"+(g.f?"f":"c"),x[3]="nl",x[4]=g.v?"1":"0",x[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var T=lr(qt(g.v));x[2]="vtc",x[3]="nd",x[4]=""+T,x[5]=g.w||oa(g.z||lt[14],T);break;case"e":continue}h.push(x.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,l,o,l,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),kb=function(){function e(d,f,h,x,g){g.raw?f[h][x]=d:d===""||(d==="TRUE"?f[h][x]=!0:d==="FALSE"?f[h][x]=!1:isNaN(Nn(d))?isNaN(yl(d).getDate())?f[h][x]=d:f[h][x]=qt(d):f[h][x]=Nn(d))}function t(d,f){var h=f||{},x=[];if(!d||d.length===0)return x;for(var g=d.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var _=10,v=0,p=0;p<=m;++p)v=g[p].indexOf(" "),v==-1?v=g[p].length:v++,_=Math.max(_,v);for(p=0;p<=m;++p){x[p]=[];var w=0;for(e(g[p].slice(0,_).trim(),x,p,w,h),w=1;w<=(g[p].length-_)/10+1;++w)e(g[p].slice(_+(w-1)*10,_+w*10).trim(),x,p,w,h)}return h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,x=0,g=0;x<d.length;++x)(g=d.charCodeAt(x))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&g.push([f[x],x]);if(!g.length){f=n;for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&g.push([f[x],x])}return g.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[g.pop()[1]]||44}function s(d,f){var h=f||{},x="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=a(d.slice(0,1024)):h&&h.FS?x=h.FS:x=a(d.slice(0,1024));var _=0,v=0,p=0,w=0,T=0,I=x.charCodeAt(0),L=!1,j=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var y=h.dateNF!=null?H_(h.dateNF):null;function O(){var B=d.slice(w,T),H={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)H.t="z";else if(h.raw)H.t="s",H.v=B;else if(B.trim().length===0)H.t="s",H.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(H.t="s",H.v=B.slice(2,-1).replace(/""/g,'"')):S4(B)?(H.t="n",H.f=B.slice(1)):(H.t="s",H.v=B);else if(B=="TRUE")H.t="b",H.v=!0;else if(B=="FALSE")H.t="b",H.v=!1;else if(!isNaN(p=Nn(B)))H.t="n",h.cellText!==!1&&(H.w=B),H.v=p;else if(!isNaN(yl(B).getDate())||y&&B.match(y)){H.z=h.dateNF||lt[14];var Q=0;y&&B.match(y)&&(B=V_(B,h.dateNF,B.match(y)||[]),Q=1),h.cellDates?(H.t="d",H.v=qt(B,Q)):(H.t="n",H.v=lr(qt(B,Q))),h.cellText!==!1&&(H.w=oa(H.z,H.v instanceof Date?lr(H.v):H.v)),h.cellNF||delete H.z}else H.t="s",H.v=B;if(H.t=="z"||(h.dense?(g[_]||(g[_]=[]),g[_][v]=H):g[Ue({c:v,r:_})]=H),w=T+1,A=d.charCodeAt(w),m.e.c<v&&(m.e.c=v),m.e.r<_&&(m.e.r=_),j==I)++v;else if(v=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;T<d.length;++T)switch(j=d.charCodeAt(T)){case 34:A===34&&(L=!L);break;case I:case 10:case 13:if(!L&&O())break e;break}return T-w>0&&O(),g["!ref"]=dt(m),g}function l(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):ti(t(d,f),f)}function o(d,f){var h="",x=f.type=="string"?[0,0,0,0]:US(d,f);switch(f.type){case"base64":h=An(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof wc<"u"||(h=Pe&&Buffer.isBuffer(d)?d.toString("binary"):Ll(d));break;case"array":h=ou(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return x[0]==239&&x[1]==187&&x[2]==191?h=$i(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=$i(h):f.type=="binary"&&typeof wc<"u",h.slice(0,19)=="socialcalc:version:"?z1.to_sheet(f.type=="string"?h:$i(h),f):l(h,f)}function c(d,f){return Ya(o(d,f),f)}function u(d){for(var f=[],h=qe(d["!ref"]),x,g=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var _=[],v=h.s.c;v<=h.e.c;++v){var p=Ue({r:m,c:v});if(x=g?(d[m]||[])[v]:d[p],!x||x.v==null){_.push("          ");continue}for(var w=(x.w||(Dn(x),x.w)||"").slice(0,10);w.length<10;)w+=" ";_.push(w+(v===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),ax=function(){function e(S,W,M){if(S){hr(S,S.l||0);for(var U=M.Enum||D;S.l<S.length;){var J=S.read_shift(2),ce=U[J]||U[65535],pe=S.read_shift(2),he=S.l+pe,de=ce.f&&ce.f(S,pe,M);if(S.l=he,W(de,ce,J))return}}}function t(S,W){switch(W.type){case"base64":return r($r(An(S)),W);case"binary":return r($r(S),W);case"buffer":case"array":return r(S,W)}throw"Unsupported type "+W.type}function r(S,W){if(!S)return S;var M=W||{},U=M.dense?[]:{},J="Sheet1",ce="",pe=0,he={},de=[],We=[],De={s:{r:0,c:0},e:{r:0,c:0}},Ht=M.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)M.Enum=D,e(S,function(ve,Er,un){switch(un){case 0:M.vers=ve,ve>=4096&&(M.qpro=!0);break;case 6:De=ve;break;case 204:ve&&(ce=ve);break;case 222:ce=ve;break;case 15:case 51:M.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:un==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=M.dateNF||lt[14],M.cellDates&&(ve[1].t="d",ve[1].v=i1(ve[1].v))),M.qpro&&ve[3]>pe&&(U["!ref"]=dt(De),he[J]=U,de.push(J),U=M.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},pe=ve[3],J=ce||"Sheet"+(pe+1),ce="");var va=M.dense?(U[ve[0].r]||[])[ve[0].c]:U[Ue(ve[0])];if(va){va.t=ve[1].t,va.v=ve[1].v,ve[1].z!=null&&(va.z=ve[1].z),ve[1].f!=null&&(va.f=ve[1].f);break}M.dense?(U[ve[0].r]||(U[ve[0].r]=[]),U[ve[0].r][ve[0].c]=ve[1]):U[Ue(ve[0])]=ve[1];break}},M);else if(S[2]==26||S[2]==14)M.Enum=b,S[2]==14&&(M.qpro=!0,S.l=0),e(S,function(ve,Er,un){switch(un){case 204:J=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>pe&&(U["!ref"]=dt(De),he[J]=U,de.push(J),U=M.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},pe=ve[3],J="Sheet"+(pe+1)),Ht>0&&ve[0].r>=Ht)break;M.dense?(U[ve[0].r]||(U[ve[0].r]=[]),U[ve[0].r][ve[0].c]=ve[1]):U[Ue(ve[0])]=ve[1],De.e.c<ve[0].c&&(De.e.c=ve[0].c),De.e.r<ve[0].r&&(De.e.r=ve[0].r);break;case 27:ve[14e3]&&(We[ve[14e3][0]]=ve[14e3][1]);break;case 1537:We[ve[0]]=ve[1],ve[0]==pe&&(J=ve[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(U["!ref"]=dt(De),he[ce||J]=U,de.push(ce||J),!We.length)return{SheetNames:de,Sheets:he};for(var Ie={},cn=[],at=0;at<We.length;++at)he[de[at]]?(cn.push(We[at]||de[at]),Ie[We[at]]=he[We[at]]||he[de[at]]):(cn.push(We[at]),Ie[We[at]]={"!ref":"A1"});return{SheetNames:cn,Sheets:Ie}}function n(S,W){var M=W||{};if(+M.codepage>=0&&gl(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var U=ir(),J=qe(S["!ref"]),ce=Array.isArray(S),pe=[];le(U,0,s(1030)),le(U,6,c(J));for(var he=Math.min(J.e.r,8191),de=J.s.r;de<=he;++de)for(var We=Dt(de),De=J.s.c;De<=J.e.c;++De){de===J.s.r&&(pe[De]=$t(De));var Ht=pe[De]+We,Ie=ce?(S[de]||[])[De]:S[Ht];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?le(U,13,x(de,De,Ie.v)):le(U,14,m(de,De,Ie.v));else{var cn=Dn(Ie);le(U,15,f(de,De,cn.slice(0,239)))}}return le(U,1),U.end()}function a(S,W){var M=W||{};if(+M.codepage>=0&&gl(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var U=ir();le(U,0,l(S));for(var J=0,ce=0;J<S.SheetNames.length;++J)(S.Sheets[S.SheetNames[J]]||{})["!ref"]&&le(U,27,N(S.SheetNames[J],ce++));var pe=0;for(J=0;J<S.SheetNames.length;++J){var he=S.Sheets[S.SheetNames[J]];if(!(!he||!he["!ref"])){for(var de=qe(he["!ref"]),We=Array.isArray(he),De=[],Ht=Math.min(de.e.r,8191),Ie=de.s.r;Ie<=Ht;++Ie)for(var cn=Dt(Ie),at=de.s.c;at<=de.e.c;++at){Ie===de.s.r&&(De[at]=$t(at));var ve=De[at]+cn,Er=We?(he[Ie]||[])[at]:he[ve];if(!(!Er||Er.t=="z"))if(Er.t=="n")le(U,23,O(Ie,at,pe,Er.v));else{var un=Dn(Er);le(U,22,j(Ie,at,pe,un.slice(0,239)))}}++pe}}return le(U,1),U.end()}function s(S){var W=q(2);return W.write_shift(2,S),W}function l(S){var W=q(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var M=0,U=0,J=0,ce=0;ce<S.SheetNames.length;++ce){var pe=S.SheetNames[ce],he=S.Sheets[pe];if(!(!he||!he["!ref"])){++J;var de=wr(he["!ref"]);M<de.e.r&&(M=de.e.r),U<de.e.c&&(U=de.e.c)}}return M>8191&&(M=8191),W.write_shift(2,M),W.write_shift(1,J),W.write_shift(1,U),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(S,W,M){var U={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&M.qpro?(U.s.c=S.read_shift(1),S.l++,U.s.r=S.read_shift(2),U.e.c=S.read_shift(1),S.l++,U.e.r=S.read_shift(2),U):(U.s.c=S.read_shift(2),U.s.r=S.read_shift(2),W==12&&M.qpro&&(S.l+=2),U.e.c=S.read_shift(2),U.e.r=S.read_shift(2),W==12&&M.qpro&&(S.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function c(S){var W=q(8);return W.write_shift(2,S.s.c),W.write_shift(2,S.s.r),W.write_shift(2,S.e.c),W.write_shift(2,S.e.r),W}function u(S,W,M){var U=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(U[0].c=S.read_shift(1),U[3]=S.read_shift(1),U[0].r=S.read_shift(2),S.l+=2):(U[2]=S.read_shift(1),U[0].c=S.read_shift(2),U[0].r=S.read_shift(2)),U}function d(S,W,M){var U=S.l+W,J=u(S,W,M);if(J[1].t="s",M.vers==20768){S.l++;var ce=S.read_shift(1);return J[1].v=S.read_shift(ce,"utf8"),J}return M.qpro&&S.l++,J[1].v=S.read_shift(U-S.l,"cstr"),J}function f(S,W,M){var U=q(7+M.length);U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,S),U.write_shift(1,39);for(var J=0;J<U.length;++J){var ce=M.charCodeAt(J);U.write_shift(1,ce>=128?95:ce)}return U.write_shift(1,0),U}function h(S,W,M){var U=u(S,W,M);return U[1].v=S.read_shift(2,"i"),U}function x(S,W,M){var U=q(7);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,S),U.write_shift(2,M,"i"),U}function g(S,W,M){var U=u(S,W,M);return U[1].v=S.read_shift(8,"f"),U}function m(S,W,M){var U=q(13);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,S),U.write_shift(8,M,"f"),U}function _(S,W,M){var U=S.l+W,J=u(S,W,M);if(J[1].v=S.read_shift(8,"f"),M.qpro)S.l=U;else{var ce=S.read_shift(2);T(S.slice(S.l,S.l+ce),J),S.l+=ce}return J}function v(S,W,M){var U=W&32768;return W&=-32769,W=(U?S:0)+(W>=8192?W-16384:W),(U?"":"$")+(M?$t(W):Dt(W))}var p={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(S,W){hr(S,0);for(var M=[],U=0,J="",ce="",pe="",he="";S.l<S.length;){var de=S[S.l++];switch(de){case 0:M.push(S.read_shift(8,"f"));break;case 1:ce=v(W[0].c,S.read_shift(2),!0),J=v(W[0].r,S.read_shift(2),!1),M.push(ce+J);break;case 2:{var We=v(W[0].c,S.read_shift(2),!0),De=v(W[0].r,S.read_shift(2),!1);ce=v(W[0].c,S.read_shift(2),!0),J=v(W[0].r,S.read_shift(2),!1),M.push(We+De+":"+ce+J)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(S.read_shift(2));break;case 6:{for(var Ht="";de=S[S.l++];)Ht+=String.fromCharCode(de);M.push('"'+Ht.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:he=M.pop(),pe=M.pop(),M.push(["AND","OR"][de-20]+"("+pe+","+he+")");break;default:if(de<32&&w[de])he=M.pop(),pe=M.pop(),M.push(pe+w[de]+he);else if(p[de]){if(U=p[de][1],U==69&&(U=S[S.l++]),U>M.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+M.join("|")+"|");return}var Ie=M.slice(-U);M.length-=U,M.push(p[de][0]+"("+Ie.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}M.length==1?W[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function I(S){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=S.read_shift(2),W[3]=S[S.l++],W[0].c=S[S.l++],W}function L(S,W){var M=I(S);return M[1].t="s",M[1].v=S.read_shift(W-4,"cstr"),M}function j(S,W,M,U){var J=q(6+U.length);J.write_shift(2,S),J.write_shift(1,M),J.write_shift(1,W),J.write_shift(1,39);for(var ce=0;ce<U.length;++ce){var pe=U.charCodeAt(ce);J.write_shift(1,pe>=128?95:pe)}return J.write_shift(1,0),J}function A(S,W){var M=I(S);M[1].v=S.read_shift(2);var U=M[1].v>>1;if(M[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return M[1].v=U,M}function y(S,W){var M=I(S),U=S.read_shift(4),J=S.read_shift(4),ce=S.read_shift(2);if(ce==65535)return U===0&&J===3221225472?(M[1].t="e",M[1].v=15):U===0&&J===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var pe=ce&32768;return ce=(ce&32767)-16446,M[1].v=(1-pe*2)*(J*Math.pow(2,ce+32)+U*Math.pow(2,ce)),M}function O(S,W,M,U){var J=q(14);if(J.write_shift(2,S),J.write_shift(1,M),J.write_shift(1,W),U==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ce=0,pe=0,he=0,de=0;return U<0&&(ce=1,U=-U),pe=Math.log2(U)|0,U/=Math.pow(2,pe-31),de=U>>>0,de&2147483648||(U/=2,++pe,de=U>>>0),U-=de,de|=2147483648,de>>>=0,U*=Math.pow(2,32),he=U>>>0,J.write_shift(4,he),J.write_shift(4,de),pe+=16383+(ce?32768:0),J.write_shift(2,pe),J}function B(S,W){var M=y(S);return S.l+=W-14,M}function H(S,W){var M=I(S),U=S.read_shift(4);return M[1].v=U>>6,M}function Q(S,W){var M=I(S),U=S.read_shift(8,"f");return M[1].v=U,M}function ie(S,W){var M=Q(S);return S.l+=W-10,M}function oe(S,W){return S[S.l+W-1]==0?S.read_shift(W,"cstr"):""}function we(S,W){var M=S[S.l++];M>W-1&&(M=W-1);for(var U="";U.length<M;)U+=String.fromCharCode(S[S.l++]);return U}function z(S,W,M){if(!(!M.qpro||W<21)){var U=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var J=S.read_shift(W-21,"cstr");return[U,J]}}function K(S,W){for(var M={},U=S.l+W;S.l<U;){var J=S.read_shift(2);if(J==14e3){for(M[J]=[0,""],M[J][0]=S.read_shift(2);S[S.l];)M[J][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return M}function N(S,W){var M=q(5+S.length);M.write_shift(2,14e3),M.write_shift(2,W);for(var U=0;U<S.length;++U){var J=S.charCodeAt(U);M[M.l++]=J>127?95:J}return M[M.l++]=0,M}var D={0:{n:"BOF",f:M1},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:y},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),Cb=/^\s|\s$|[\t\n\r]/;function H1(e,t){if(!t.bookSST)return"";var r=[ht];r[r.length]=se("sst",null,{xmlns:ei[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(Cb)&&(s+=' xml:space="preserve"'),s+=">"+Me(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Ab(e){return[e.read_shift(4),e.read_shift(4)]}function Db(e,t){return t||(t=q(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Fb=NN;function Ob(e){var t=ir();ee(t,159,Db(e));for(var r=0;r<e.length;++r)ee(t,19,Fb(e[r]));return ee(t,160),t.end()}function Pb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function V1(e){var t=0,r,n=Pb(e),a=n.length+1,s,l,o,c,u;for(r=$a(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)l=r[s],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^l;return t^52811}var Ib=function(){function e(a,s){switch(s.type){case"base64":return t(An(a),s);case"binary":return t(a,s);case"buffer":return t(Pe&&Buffer.isBuffer(a)?a.toString("binary"):Ll(a),s);case"array":return t(ou(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var l=s||{},o=l.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,x=0,g,m=-1;g=h.exec(d);){switch(g[0]){case"\\cell":var _=d.slice(x,h.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var v={v:_,t:"s"};Array.isArray(o)?o[f][m]=v:o[Ue({r:f,c:m})]=v}break}x=h.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=dt(u),o}function r(a,s){return Ya(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=qe(a["!ref"]),o,c=Array.isArray(a),u=l.s.r;u<=l.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var f=Ue({r:u,c:d});o=c?(a[u]||[])[d]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Dn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function sx(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Rb=6,bn=Rb;function Cc(e){return Math.floor((e+Math.round(128/bn)/256)*bn)}function Ac(e){return Math.floor((e-5)/bn*100+.5)/100}function sd(e){return Math.round((e*bn+5)/bn*256)/256}function Wf(e){e.width?(e.wpx=Cc(e.width),e.wch=Ac(e.wpx),e.MDW=bn):e.wpx?(e.wch=Ac(e.wpx),e.width=sd(e.wch),e.MDW=bn):typeof e.wch=="number"&&(e.width=sd(e.wch),e.wpx=Cc(e.width),e.MDW=bn),e.customWidth&&delete e.customWidth}var Lb=96,K1=Lb;function Dc(e){return e*96/K1}function G1(e){return e*K1/96}function Mb(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=se("numFmt",null,{numFmtId:n,formatCode:Me(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Bb(e){var t=[];return t[t.length]=se("cellXfs",null),e.forEach(function(r){t[t.length]=se("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function X1(e,t){var r=[ht,se("styleSheet",null,{xmlns:ei[0],"xmlns:vt":wt.vt})],n;return e.SSF&&(n=Mb(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Bb(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ub(e,t){var r=e.read_shift(2),n=Wt(e);return[r,n]}function $b(e,t,r){r||(r=q(6+4*t.length)),r.write_shift(2,e),Nt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Wb(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=CN(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=kN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wt(e),n}function zb(e,t){t||(t=q(25+4*32)),t.write_shift(2,e.sz*20),AN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Tc(e.color,t);var n=0;return n=2,t.write_shift(1,n),Nt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Hb=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],qu,Vb=ln;function ix(e,t){t||(t=q(4*3+8*7+16*1)),qu||(qu=Af(Hb));var r=qu[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Tc({auto:1},t),Tc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Kb(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Y1(e,t,r){r||(r=q(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function _i(e,t){return t||(t=q(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Gb=ln;function Xb(e,t){return t||(t=q(51)),t.write_shift(1,0),_i(null,t),_i(null,t),_i(null,t),_i(null,t),_i(null,t),t.length>t.l?t.slice(0,t.l):t}function Yb(e,t){return t||(t=q(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Sc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function qb(e,t,r){var n=q(2052);return n.write_shift(4,e),Sc(t,n),Sc(r,n),n.length>n.l?n.slice(0,n.l):n}function Qb(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ee(e,615,Kr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ee(e,44,$b(a,t[a]))}),ee(e,616))}}function Jb(e){var t=1;ee(e,611,Kr(t)),ee(e,43,zb({sz:12,color:{theme:1},name:"Calibri",family:2})),ee(e,612)}function Zb(e){var t=2;ee(e,603,Kr(t)),ee(e,45,ix({patternType:"none"})),ee(e,45,ix({patternType:"gray125"})),ee(e,604)}function e4(e){var t=1;ee(e,613,Kr(t)),ee(e,46,Xb()),ee(e,614)}function t4(e){var t=1;ee(e,626,Kr(t)),ee(e,47,Y1({numFmtId:0},65535)),ee(e,627)}function r4(e,t){ee(e,617,Kr(t.length)),t.forEach(function(r){ee(e,47,Y1(r,0))}),ee(e,618)}function n4(e){var t=1;ee(e,619,Kr(t)),ee(e,48,Yb({xfId:0,name:"Normal"})),ee(e,620)}function a4(e){var t=0;ee(e,505,Kr(t)),ee(e,506)}function s4(e){var t=0;ee(e,508,qb(t,"TableStyleMedium9","PivotStyleMedium4")),ee(e,509)}function i4(e,t){var r=ir();return ee(r,278),Qb(r,e.SSF),Jb(r),Zb(r),e4(r),t4(r),r4(r,t.cellXfs),n4(r),a4(r),s4(r),ee(r,279),r.end()}function q1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ht];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function l4(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wt(e)}}function o4(e){var t=q(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Nt(e.name,t),t.slice(0,t.l)}function c4(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function u4(e){var t=q(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function d4(e,t){var r=q(8+2*t.length);return r.write_shift(4,e),Nt(t,r),r.slice(0,r.l)}function f4(e){return e.l+=4,e.read_shift(4)!=0}function h4(e,t){var r=q(8);return r.write_shift(4,e),r.write_shift(4,1),r}function m4(){var e=ir();return ee(e,332),ee(e,334,Kr(1)),ee(e,335,o4({name:"XLDAPR",version:12e4,flags:3496657072})),ee(e,336),ee(e,339,d4(1,"XLDAPR")),ee(e,52),ee(e,35,Kr(514)),ee(e,4096,Kr(0)),ee(e,4097,Sr(1)),ee(e,36),ee(e,53),ee(e,340),ee(e,337,h4(1)),ee(e,51,u4([[1,0]])),ee(e,338),ee(e,333),e.end()}function Q1(){var e=[ht];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function x4(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var js=1024;function J1(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[se("xml",null,{"xmlns:v":mr.v,"xmlns:o":mr.o,"xmlns:x":mr.x,"xmlns:mv":mr.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];js<e*1e3;)js+=1e3;return t.forEach(function(s){var l=_t(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=se("v:fill",c,o),d={on:"t",obscured:"t"};++js,a=a.concat(["<v:shape"+_l({id:"_x0000_s"+js,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,se("v:shadow",null,d),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ct("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Ct("x:AutoFill","False"),Ct("x:Row",String(l.r)),Ct("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Z1(e){var t=[ht,se("comments",null,{xmlns:ei[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Me(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Me(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Ct("t",Me(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(Ct("t",Me(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function p4(e,t,r){var n=[ht,se("ThreadedComments",null,{xmlns:wt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(se("threadedComment",Ct("text",l.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function g4(e){var t=[ht,se("personList",null,{xmlns:wt.TCMNT,"xmlns:x":ei[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(se("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function v4(e){var t={};t.iauthor=e.read_shift(4);var r=Za(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}function y4(e,t){return t==null&&(t=q(36)),t.write_shift(4,e[1].iauthor),ri(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var w4=Wt;function _4(e){return Nt(e.slice(0,54))}function N4(e){var t=ir(),r=[];return ee(t,628),ee(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ee(t,632,_4(a.a)))})}),ee(t,631),ee(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:_t(n[0]),e:_t(n[0])};ee(t,635,y4([s,a])),a.t&&a.t.length>0&&ee(t,637,EN(a)),ee(t,636),delete a.iauthor})}),ee(t,634),ee(t,629),t.end()}function b4(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&$e.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var ev=["xlsb","xlsm","xlam","biff8","xla"],E4=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,l){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,a+(o?"":"$")+$t(d)+(c?"":"$")+Dt(u)}return function(a,s){return t=s,a.replace(e,r)}}(),zf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hf=function(){return function(t,r){return t.replace(zf,function(n,a,s,l,o,c){var u=Lf(l)-(s?0:r.c),d=Rf(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function j4(e,t){return e.replace(zf,function(r,n,a,s,l,o){return n+(a=="$"?a+s:$t(Lf(s)+t.c))+(l=="$"?l+o:Dt(Rf(o)+t.r))})}function S4(e){return e.length!=1}function ct(e){e.l+=1}function ca(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function tv(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return rv(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),l=ca(e),o=ca(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function rv(e){var t=ca(e),r=ca(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function T4(e,t,r){if(r.biff<8)return rv(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=ca(e),l=ca(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function nv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return k4(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ca(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function k4(e){var t=ca(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function C4(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function A4(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return D4(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:o}}function D4(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function F4(e,t,r){var n=(e[e.l++]&96)>>5,a=tv(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function O4(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=tv(e,s,r);return[n,a,l]}function P4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function I4(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function R4(e,t,r){var n=(e[e.l++]&96)>>5,a=T4(e,t-1,r);return[n,a]}function L4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function lx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function M4(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function B4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function U4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function $4(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function W4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function av(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function z4(e){return e.read_shift(2),av(e)}function H4(e){return e.read_shift(2),av(e)}function V4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=nv(e,0,r);return[n,a]}function K4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=A4(e,0,r);return[n,a]}function G4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=nv(e,0,r);return[n,a,s]}function X4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[X3[a],lv[a],n]}function Y4(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:q4(e);return[a,(s[0]===0?lv:G3)[s[1]]]}function q4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Q4(e,t,r){e.l+=r&&r.biff==2?3:4}function J4(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Z4(e){return e.l++,Ul[e.read_shift(1)]}function e3(e){return e.l++,e.read_shift(2)}function t3(e){return e.l++,e.read_shift(1)!==0}function r3(e){return e.l++,ni(e)}function n3(e,t,r){return e.l++,U1(e,t-1,r)}function a3(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=GN(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ul[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ni(e);break;case 2:r[1]=QN(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function s3(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Za:eb)(e));return a}function i3(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=a;++o)l[s][o]=a3(e,r.biff);return l}function l3(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function o3(e,t,r){if(r.biff==5)return c3(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function c3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function u3(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function d3(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function f3(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function h3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var m3=ln,x3=ln,p3=ln;function $l(e,t,r){return e.l+=2,[C4(e)]}function Vf(e){return e.l+=6,[]}var g3=$l,v3=Vf,y3=Vf,w3=$l;function sv(e){return e.l+=2,[M1(e),e.read_shift(2)&1]}var _3=$l,N3=sv,b3=Vf,E3=$l,j3=$l,S3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function T3(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),l=S3[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:s}}function k3(e){return e.l+=2,[e.read_shift(4)]}function C3(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function A3(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function D3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function F3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function O3(e){return e.l+=4,[0,0]}var ox={1:{n:"PtgExp",f:J4},2:{n:"PtgTbl",f:p3},3:{n:"PtgAdd",f:ct},4:{n:"PtgSub",f:ct},5:{n:"PtgMul",f:ct},6:{n:"PtgDiv",f:ct},7:{n:"PtgPower",f:ct},8:{n:"PtgConcat",f:ct},9:{n:"PtgLt",f:ct},10:{n:"PtgLe",f:ct},11:{n:"PtgEq",f:ct},12:{n:"PtgGe",f:ct},13:{n:"PtgGt",f:ct},14:{n:"PtgNe",f:ct},15:{n:"PtgIsect",f:ct},16:{n:"PtgUnion",f:ct},17:{n:"PtgRange",f:ct},18:{n:"PtgUplus",f:ct},19:{n:"PtgUminus",f:ct},20:{n:"PtgPercent",f:ct},21:{n:"PtgParen",f:ct},22:{n:"PtgMissArg",f:ct},23:{n:"PtgStr",f:n3},26:{n:"PtgSheet",f:C3},27:{n:"PtgEndSheet",f:A3},28:{n:"PtgErr",f:Z4},29:{n:"PtgBool",f:t3},30:{n:"PtgInt",f:e3},31:{n:"PtgNum",f:r3},32:{n:"PtgArray",f:L4},33:{n:"PtgFunc",f:X4},34:{n:"PtgFuncVar",f:Y4},35:{n:"PtgName",f:l3},36:{n:"PtgRef",f:V4},37:{n:"PtgArea",f:F4},38:{n:"PtgMemArea",f:u3},39:{n:"PtgMemErr",f:m3},40:{n:"PtgMemNoMem",f:x3},41:{n:"PtgMemFunc",f:d3},42:{n:"PtgRefErr",f:f3},43:{n:"PtgAreaErr",f:P4},44:{n:"PtgRefN",f:K4},45:{n:"PtgAreaN",f:R4},46:{n:"PtgMemAreaN",f:D3},47:{n:"PtgMemNoMemN",f:F3},57:{n:"PtgNameX",f:o3},58:{n:"PtgRef3d",f:G4},59:{n:"PtgArea3d",f:O4},60:{n:"PtgRefErr3d",f:h3},61:{n:"PtgAreaErr3d",f:I4},255:{}},P3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},I3={1:{n:"PtgElfLel",f:sv},2:{n:"PtgElfRw",f:E3},3:{n:"PtgElfCol",f:g3},6:{n:"PtgElfRwV",f:j3},7:{n:"PtgElfColV",f:w3},10:{n:"PtgElfRadical",f:_3},11:{n:"PtgElfRadicalS",f:b3},13:{n:"PtgElfColS",f:v3},15:{n:"PtgElfColSV",f:y3},16:{n:"PtgElfRadicalLel",f:N3},25:{n:"PtgList",f:T3},29:{n:"PtgSxName",f:k3},255:{}},R3={0:{n:"PtgAttrNoop",f:O3},1:{n:"PtgAttrSemi",f:W4},2:{n:"PtgAttrIf",f:U4},4:{n:"PtgAttrChoose",f:M4},8:{n:"PtgAttrGoto",f:B4},16:{n:"PtgAttrSum",f:Q4},32:{n:"PtgAttrBaxcel",f:lx},33:{n:"PtgAttrBaxcel",f:lx},64:{n:"PtgAttrSpace",f:z4},65:{n:"PtgAttrSpaceSemi",f:H4},128:{n:"PtgAttrIfError",f:$4},255:{}};function L3(e,t,r,n){if(n.biff<8)return ln(e,t);for(var a=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=i3(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=s3(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&s.push(ln(e,t)),s}function M3(e,t,r){for(var n=e.l+t,a,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],a=ox[s]||ox[P3[s]],(s===24||s===25)&&(a=(s===24?I3:R3)[e[e.l+1]]),!a||!a.f?ln(e,t):l.push([a.n,a.f(e,t,r)]);return l}function B3(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var U3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function iv(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function cx(e,t,r){var n=iv(e,t,r);return n=="#REF"?n:$3(n,r)}function Xs(e,t,r,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},o=[],c,u,d,f=0,h=0,x,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,_="",v=0,p=e[0].length;v<p;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:_=it(" ",e[0][m][1][1]);break;case 1:_=it("\r",e[0][m][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+_,m=-1}o.push(u+U3[w[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=zi(w[1][1],l,a),o.push(Hi(d,s));break;case"PtgRefN":d=r?zi(w[1][1],r,a):w[1][1],o.push(Hi(d,s));break;case"PtgRef3d":f=w[1][1],d=zi(w[1][2],l,a),g=cx(n,f,a),o.push(g+"!"+Hi(d,s));break;case"PtgFunc":case"PtgFuncVar":var T=w[1][0],I=w[1][1];T||(T=0),T&=127;var L=T==0?[]:o.slice(-T);o.length-=T,I==="User"&&(I=L.shift()),o.push(I+"("+L.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":x=Gm(w[1][1],r?{s:r}:l,a),o.push(Xu(x,a));break;case"PtgArea":x=Gm(w[1][1],l,a),o.push(Xu(x,a));break;case"PtgArea3d":f=w[1][1],x=w[1][2],g=cx(n,f,a),o.push(g+"!"+Xu(x,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var j=(n.names||[])[h-1]||(n[0]||[])[h],A=j?j.Name:"SH33TJSNAME"+String(h);A&&A.slice(0,6)=="_xlfn."&&!a.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var y=w[1][1];h=w[1][2];var O;if(a.biff<=5)y<0&&(y=-y),n[y]&&(O=n[y][h]);else{var B="";if(((n[y]||[])[0]||[])[0]==14849||(((n[y]||[])[0]||[])[0]==1025?n[y][h]&&n[y][h].itab>0&&(B=n.SheetNames[n[y][h].itab-1]+"!"):B=n.SheetNames[h-1]+"!"),n[y]&&n[y][h])B+=n[y][h].Name;else if(n[0]&&n[0][h])B+=n[0][h].Name;else{var H=(iv(n,y,a)||"").split(";;");H[h-1]?B=H[h-1]:B+="SH33TJSERRX"}o.push(B);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var Q="(",ie=")";if(m>=0){switch(_="",e[0][m][1][0]){case 2:Q=it(" ",e[0][m][1][1])+Q;break;case 3:Q=it("\r",e[0][m][1][1])+Q;break;case 4:ie=it(" ",e[0][m][1][1])+ie;break;case 5:ie=it("\r",e[0][m][1][1])+ie;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(Q+o.pop()+ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var oe={c:r.c,r:r.r};if(n.sharedf[Ue(d)]){var we=n.sharedf[Ue(d)];o.push(Xs(we,l,oe,n,a))}else{var z=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Xs(u[1],l,oe,n,a)),z=!0;break}z||o.push(w[1])}break;case"PtgArray":o.push("{"+B3(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&K.indexOf(e[0][v][0])==-1){w=e[0][m];var N=!0;switch(w[1][0]){case 4:N=!1;case 0:_=it(" ",w[1][1]);break;case 5:N=!1;case 1:_=it("\r",w[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((N?_:"")+o.pop()+(N?"":_)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function W3(e){if(e==null){var t=q(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Wa(e);return Wa(0)}function z3(e,t,r,n,a){var s=za(t,r,a),l=W3(e.v),o=q(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=q(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=kt([s,l,o,u]);return f}function cu(e,t,r){var n=e.read_shift(4),a=M3(e,n,r),s=e.read_shift(4),l=s>0?L3(e,s,a,r):null;return[a,l]}var H3=cu,uu=cu,V3=cu,K3=cu,G3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},X3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Y3(e){var t="of:="+e.replace(zf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function q3(e){return e.replace(/\./,"!")}var Vi=typeof Map<"u";function Kf(e,t,r){var n=0,a=e.length;if(r){if(Vi?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Vi?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Vi?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function du(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(bn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Ac(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=sd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ov(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ga(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){n1(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Q3(e,t,r){if(e&&e["!ref"]){var n=qe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function J3(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function Z3(e,t,r,n,a){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,l.codeName=wl(Me(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+se("outlinePr",null,u)}!s&&!o||(a[a.length]=se("sheetPr",o,l))}var eE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],tE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function rE(e){var t={sheet:1};return eE.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),tE.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=V1(e.password).toString(16).toUpperCase()),se("sheetProtection",null,t)}function nE(e){return ov(e),se("pageMargins",null,e)}function aE(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=se("col",null,du(a,n)));return r[r.length]="</cols>",r.join("")}function sE(e,t,r,n){var a=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=wr(a);l.s.r==l.e.r&&(l.e.r=wr(t["!ref"]).e.r,a=dt(l));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),se("autoFilter",null,{ref:a})}function iE(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,a),{})}function lE(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ul[e.v];break;case"d":n&&n.cellDates?a=qt(e.v,-1).toISOString():(e=or(e),e.t="n",a=""+(e.v=lr(qt(e.v)))),typeof e.z>"u"&&(e.z=lt[14]);break;default:a=e.v;break}var o=Ct("v",Me(a)),c={r:t},u=ga(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Ct("v",""+Kf(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=se("f",Me(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),se("c",o,c)}function oE(e,t,r,n){var a=[],s=[],l=qe(e["!ref"]),o="",c,u="",d=[],f=0,h=0,x=e["!rows"],g=Array.isArray(e),m={r:u},_,v=-1;for(h=l.s.c;h<=l.e.c;++h)d[h]=$t(h);for(f=l.s.r;f<=l.e.r;++f){for(s=[],u=Dt(f),h=l.s.c;h<=l.e.c;++h){c=d[h]+u;var p=g?(e[f]||[])[h]:e[c];p!==void 0&&(o=lE(p,c,e,t))!=null&&s.push(o)}(s.length>0||x&&x[f])&&(m={r:u},x&&x[f]&&(_=x[f],_.hidden&&(m.hidden=1),v=-1,_.hpx?v=Dc(_.hpx):_.hpt&&(v=_.hpt),v>-1&&(m.ht=v,m.customHeight=1),_.level&&(m.outlineLevel=_.level)),a[a.length]=se("row",s.join(""),m))}if(x)for(;f<x.length;++f)x&&x[f]&&(m={r:f+1},_=x[f],_.hidden&&(m.hidden=1),v=-1,_.hpx?v=Dc(_.hpx):_.hpt&&(v=_.hpt),v>-1&&(m.ht=v,m.customHeight=1),_.level&&(m.outlineLevel=_.level),a[a.length]=se("row","",m));return a.join("")}function cv(e,t,r,n){var a=[ht,se("worksheet",null,{xmlns:ei[0],"xmlns:r":wt.r})],s=r.SheetNames[e],l=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=qe(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=dt(d)}n||(n={}),c["!comments"]=[];var f=[];Z3(c,r,e,t,a),a[a.length]=se("dimension",null,{ref:u}),a[a.length]=iE(c,t,e,r),t.sheetFormat&&(a[a.length]=se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=aE(c,c["!cols"])),a[l=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=oE(c,t),o.length>0&&(a[a.length]=o)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),c["!protect"]&&(a[a.length]=rE(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=sE(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=J3(c["!merges"]));var h=-1,x,g=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(x={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Le(n,-1,Me(m[1].Target).replace(/#.*$/,""),Oe.HLINK),x["r:id"]="rId"+g),(h=m[1].Target.indexOf("#"))>-1&&(x.location=Me(m[1].Target.slice(h+1))),m[1].Tooltip&&(x.tooltip=Me(m[1].Tooltip)),a[a.length]=se("hyperlink",null,x))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=nE(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Ct("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=Le(n,-1,"../drawings/drawing"+(e+1)+".xml",Oe.DRAW),a[a.length]=se("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=Le(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Oe.VML),a[a.length]=se("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function cE(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function uE(e,t,r){var n=q(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Dc(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,x=d<<10;x<d+1<<10;++x){u.c=x;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ue(u)];g&&(f<0&&(f=x),h=x)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function dE(e,t,r,n){var a=uE(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ee(e,0,a)}var fE=Za,hE=ri;function mE(){}function xE(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=jN(e),r}function pE(e,t,r){r==null&&(r=q(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Tc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),E1(e,r),r.slice(0,r.l)}function gE(e){var t=Pr(e);return[t]}function vE(e,t,r){return r==null&&(r=q(8)),qa(t,r)}function yE(e){var t=Qa(e);return[t]}function wE(e,t,r){return r==null&&(r=q(4)),Ja(t,r)}function _E(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"b"]}function NE(e,t,r){return r==null&&(r=q(9)),qa(t,r),r.write_shift(1,e.v?1:0),r}function bE(e){var t=Qa(e),r=e.read_shift(1);return[t,r,"b"]}function EE(e,t,r){return r==null&&(r=q(5)),Ja(t,r),r.write_shift(1,e.v?1:0),r}function jE(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"e"]}function SE(e,t,r){return r==null&&(r=q(9)),qa(t,r),r.write_shift(1,e.v),r}function TE(e){var t=Qa(e),r=e.read_shift(1);return[t,r,"e"]}function kE(e,t,r){return r==null&&(r=q(8)),Ja(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function CE(e){var t=Pr(e),r=e.read_shift(4);return[t,r,"s"]}function AE(e,t,r){return r==null&&(r=q(12)),qa(t,r),r.write_shift(4,t.v),r}function DE(e){var t=Qa(e),r=e.read_shift(4);return[t,r,"s"]}function FE(e,t,r){return r==null&&(r=q(8)),Ja(t,r),r.write_shift(4,t.v),r}function OE(e){var t=Pr(e),r=ni(e);return[t,r,"n"]}function PE(e,t,r){return r==null&&(r=q(16)),qa(t,r),Wa(e.v,r),r}function IE(e){var t=Qa(e),r=ni(e);return[t,r,"n"]}function RE(e,t,r){return r==null&&(r=q(12)),Ja(t,r),Wa(e.v,r),r}function LE(e){var t=Pr(e),r=j1(e);return[t,r,"n"]}function ME(e,t,r){return r==null&&(r=q(12)),qa(t,r),S1(e.v,r),r}function BE(e){var t=Qa(e),r=j1(e);return[t,r,"n"]}function UE(e,t,r){return r==null&&(r=q(8)),Ja(t,r),S1(e.v,r),r}function $E(e){var t=Pr(e),r=Mf(e);return[t,r,"is"]}function WE(e){var t=Pr(e),r=Wt(e);return[t,r,"str"]}function zE(e,t,r){return r==null&&(r=q(12+4*e.v.length)),qa(t,r),Nt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function HE(e){var t=Qa(e),r=Wt(e);return[t,r,"str"]}function VE(e,t,r){return r==null&&(r=q(8+4*e.v.length)),Ja(t,r),Nt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function KE(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=uu(e,n-e.l,r);l[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return l}function GE(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=uu(e,n-e.l,r);l[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return l}function XE(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=ni(e),l=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=uu(e,n-e.l,r);l[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return l}function YE(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=Wt(e),l=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=uu(e,n-e.l,r);l[3]=Xs(o,null,a,r.supbooks,r)}else e.l=n;return l}var qE=Za,QE=ri;function JE(e,t){return t==null&&(t=q(4)),t.write_shift(4,e),t}function ZE(e,t){var r=e.l+t,n=Za(e),a=Bf(e),s=Wt(e),l=Wt(e),o=Wt(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:o};return l&&(c.Tooltip=l),c}function ej(e,t){var r=q(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ri({s:_t(e[0]),e:_t(e[0])},r),Uf("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Nt(a||"",r),Nt(e[1].Tooltip||"",r),Nt("",r),r.slice(0,r.l)}function tj(){}function rj(e,t,r){var n=e.l+t,a=T1(e),s=e.read_shift(1),l=[a];if(l[2]=s,r.cellFormula){var o=H3(e,n-e.l,r);l[1]=o}else e.l=n;return l}function nj(e,t,r){var n=e.l+t,a=Za(e),s=[a];if(r.cellFormula){var l=K3(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function aj(e,t,r){r==null&&(r=q(18));var n=du(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var uv=["left","right","top","bottom","header","footer"];function sj(e){var t={};return uv.forEach(function(r){t[r]=ni(e)}),t}function ij(e,t){return t==null&&(t=q(6*8)),ov(e),uv.forEach(function(r){Wa(e[r],t)}),t}function lj(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function oj(e,t,r){r==null&&(r=q(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function cj(e){var t=q(24);return t.write_shift(4,4),t.write_shift(4,1),ri(e,t),t}function uj(e,t){return t==null&&(t=q(16*4+2)),t.write_shift(2,e.password?V1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function dj(){}function fj(){}function hj(e,t,r,n,a,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=or(t),t.z=t.z||lt[14],t.v=lr(qt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=ga(a.cellXfs,t,a),t.l&&s["!links"].push([Ue(c),t.l]),t.c&&s["!comments"].push([Ue(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Kf(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,l?ee(e,18,FE(t,c)):ee(e,7,AE(t,c))):(c.t="str",l?ee(e,17,VE(t,c)):ee(e,6,zE(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?ee(e,13,UE(t,c)):ee(e,2,ME(t,c)):l?ee(e,16,RE(t,c)):ee(e,5,PE(t,c)),!0;case"b":return c.t="b",l?ee(e,15,EE(t,c)):ee(e,4,NE(t,c)),!0;case"e":return c.t="e",l?ee(e,14,kE(t,c)):ee(e,3,SE(t,c)),!0}return l?ee(e,12,wE(t,c)):ee(e,1,vE(t,c)),!0}function mj(e,t,r,n){var a=qe(t["!ref"]||"A1"),s,l="",o=[];ee(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){l=Dt(d),dE(e,t,a,d);var f=!1;if(d<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(o[h]=$t(h)),s=o[h]+l;var x=c?(t[d]||[])[h]:t[s];if(!x){f=!1;continue}f=hj(e,x,d,h,n,t,f)}}ee(e,146)}function xj(e,t){!t||!t["!merges"]||(ee(e,177,JE(t["!merges"].length)),t["!merges"].forEach(function(r){ee(e,176,QE(r))}),ee(e,178))}function pj(e,t){!t||!t["!cols"]||(ee(e,390),t["!cols"].forEach(function(r,n){r&&ee(e,60,aj(n,r))}),ee(e,391))}function gj(e,t){!t||!t["!ref"]||(ee(e,648),ee(e,649,cj(qe(t["!ref"]))),ee(e,650))}function vj(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Le(r,-1,n[1].Target.replace(/#.*$/,""),Oe.HLINK);ee(e,494,ej(n,a))}}),delete t["!links"]}function yj(e,t,r,n){if(t["!comments"].length>0){var a=Le(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Oe.VML);ee(e,551,Uf("rId"+a)),t["!legacy"]=a}}function wj(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:dt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=wr(s);o.s.r==o.e.r&&(o.e.r=wr(t["!ref"]).e.r,s=dt(o));for(var c=0;c<l.length;++c){var u=l[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ee(e,161,ri(qe(s))),ee(e,162)}}function _j(e,t,r){ee(e,133),ee(e,137,oj(t,r)),ee(e,138),ee(e,134)}function Nj(e,t){t["!protect"]&&ee(e,535,uj(t["!protect"]))}function bj(e,t,r,n){var a=ir(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=qe(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],ee(a,129),(r.vbaraw||l["!outline"])&&ee(a,147,pE(o,l["!outline"])),ee(a,148,hE(c)),_j(a,l,r.Workbook),pj(a,l),mj(a,l,e,t),Nj(a,l),wj(a,l,r,e),xj(a,l),vj(a,l,n),l["!margins"]&&ee(a,476,ij(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&gj(a,l),yj(a,l,e,n),ee(a,130),a.end()}function Ej(e,t){e.l+=10;var r=Wt(e);return{name:r}}var jj=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Sj(e){return!e.Workbook||!e.Workbook.WBProps?"false":nN(e.Workbook.WBProps.date1904)?"true":"false"}var Tj="][*?/\\".split("");function dv(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Tj.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function kj(e,t,r){e.forEach(function(n,a){dv(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function Cj(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];kj(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Q3(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function fv(e){var t=[ht];t[t.length]=se("workbook",null,{xmlns:ei[0],"xmlns:r":wt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jj.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=se("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Me(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=se("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=se("definedName",Me(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Aj(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ad(e),r.name=Wt(e),r}function Dj(e,t){return t||(t=q(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Uf(e.strRelID,t),Nt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Fj(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Wt(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Oj(e,t){t||(t=q(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),E1(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Pj(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=SN(e),l=V3(e,0,r),o=Bf(e);e.l=n;var c={Name:s,Ptg:l};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function Ij(e,t){ee(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ee(e,156,Dj(a))}ee(e,144)}function Rj(e,t){t||(t=q(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Nt("SheetJS",t),Nt(yc.version,t),Nt(yc.version,t),Nt("7262",t),t.length>t.l?t.slice(0,t.l):t}function Lj(e,t){t||(t=q(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Mj(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(ee(e,135),ee(e,158,Lj(a)),ee(e,136))}}function Bj(e,t){var r=ir();return ee(r,131),ee(r,128,Rj()),ee(r,153,Oj(e.Workbook&&e.Workbook.WBProps||null)),Mj(r,e),Ij(r,e),ee(r,132),r.end()}function Uj(e,t,r){return(t.slice(-4)===".bin"?Bj:fv)(e)}function $j(e,t,r,n,a){return(t.slice(-4)===".bin"?bj:cv)(e,r,n,a)}function Wj(e,t,r){return(t.slice(-4)===".bin"?i4:X1)(e,r)}function zj(e,t,r){return(t.slice(-4)===".bin"?Ob:H1)(e,r)}function Hj(e,t,r){return(t.slice(-4)===".bin"?N4:Z1)(e)}function Vj(e){return(e.slice(-4)===".bin"?m4:Q1)()}function Kj(e,t){var r=[];return e.Props&&r.push(WN(e.Props,t)),e.Custprops&&r.push(zN(e.Props,e.Custprops)),r.join("")}function Gj(){return""}function Xj(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(se("NumberFormat",null,{"ss:Format":Me(lt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(se("Style",s.join(""),l))}),se("Styles",r.join(""))}function hv(e){return se("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Hf(e.Ref,{r:0,c:0})})}function Yj(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(hv(a)))}return se("Names",r.join(""))}function qj(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var o=a[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(hv(o)))}return s.join("")}function Qj(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(se("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(se("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(se("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(se("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Ct("ProtectContents","True")),e["!protect"].objects&&a.push(Ct("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Ct("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Ct("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Ct("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":se("WorksheetOptions",a.join(""),{xmlns:mr.x})}function Jj(e){return e.map(function(t){var r=rN(t.t||""),n=se("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return se("Comment",n,{"ss:Author":t.a})}).join("")}function Zj(e,t,r,n,a,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Me(Hf(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=_t(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Me(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Me(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=l.c||u[d].s.r!=l.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Ul[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||lt[14]);break;case"s":f="String",h=tN(e.v||"");break}var x=ga(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=l.c+1;var g=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=Jj(e.c)),se("Cell",m,o)}function eS(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=G1(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tS(e,t,r,n){if(!e["!ref"])return"";var a=qe(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(_,v){Wf(_);var p=!!_.width,w=du(v,_),T={"ss:Index":v+1};p&&(T["ss:Width"]=Cc(w.width)),_.hidden&&(T["ss:Hidden"]="1"),o.push(se("Column",null,T))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[eS(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>f)&&!(s[l].s.r>u)&&!(s[l].e.c<f)&&!(s[l].e.r<u)){(s[l].s.c!=f||s[l].s.r!=u)&&(h=!0);break}if(!h){var x={r:u,c:f},g=Ue(x),m=c?(e[u]||[])[f]:e[g];d.push(Zj(m,g,e,t,r,n,x))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function rS(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],l=s?qj(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?tS(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(Qj(s,t,e,r)),n.join("")}function nS(e,t){t||(t={}),e.SSF||(e.SSF=or(lt)),e.SSF&&(iu(),su(e.SSF),t.revssf=lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ga(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Kj(e,t)),r.push(Gj()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(se("Worksheet",rS(n,t,e),{"ss:Name":Me(e.SheetNames[n])}));return r[2]=Xj(e,t),r[3]=Yj(e),ht+se("Workbook",r.join(""),{xmlns:mr.ss,"xmlns:o":mr.o,"xmlns:x":mr.x,"xmlns:ss":mr.ss,"xmlns:dt":mr.dt,"xmlns:html":mr.html})}var Qu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function aS(e,t){var r=[],n=[],a=[],s=0,l,o=Rm(Ym,"n"),c=Rm(qm,"n");if(e.Props)for(l=Ot(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(c,l[s])?n:a).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=Ot(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(c,l[s])?n:a).push([l[s],e.Custprops[l[s]]]);var u=[];for(s=0;s<a.length;++s)L1.indexOf(a[s][0])>-1||P1.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&$e.utils.cfb_add(t,"/SummaryInformation",tx(n,Qu.SI,c,qm)),(r.length||u.length)&&$e.utils.cfb_add(t,"/DocumentSummaryInformation",tx(r,Qu.DSI,o,Ym,u.length?u:null,Qu.UDI))}function sS(e,t){var r=t||{},n=$e.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return $e.utils.cfb_add(n,a,mv(e,r)),r.biff==8&&(e.Props||e.Custprops)&&aS(e,n),r.biff==8&&e.vbaraw&&b4(n,$e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var iS={0:{f:cE},1:{f:gE},2:{f:LE},3:{f:jE},4:{f:_E},5:{f:OE},6:{f:WE},7:{f:CE},8:{f:YE},9:{f:XE},10:{f:KE},11:{f:GE},12:{f:yE},13:{f:BE},14:{f:TE},15:{f:bE},16:{f:IE},17:{f:HE},18:{f:DE},19:{f:Mf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Pj},40:{},42:{},43:{f:Wb},44:{f:Ub},45:{f:Vb},46:{f:Gb},47:{f:Kb},48:{},49:{f:yN},50:{},51:{f:c4},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:wb},62:{f:$E},63:{f:x4},64:{f:dj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ln,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xE},148:{f:fE,p:16},151:{f:tj},152:{},153:{f:Fj},154:{},155:{},156:{f:Aj},157:{},158:{},159:{T:1,f:Ab},160:{T:-1},161:{T:1,f:Za},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qE},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:l4},336:{T:-1},337:{f:f4,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ad},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rj},427:{f:nj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:mE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ZE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ad},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:w4},633:{T:1},634:{T:-1},635:{T:1,f:v4},636:{T:-1},637:{f:bN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Ej},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:fj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function le(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&If(r)&&e.push(r)}}function lS(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return le(e,t,r,a);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,c=0,u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Wl(e,t,r){return e||(e=q(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function oS(e,t,r,n){var a=q(9);return Wl(a,e,t),B1(r,n||"b",a),a}function cS(e,t,r){var n=q(8+2*r.length);return Wl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function uS(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?lr(qt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?le(e,2,Eb(r,n,a)):le(e,3,bb(r,n,a));return;case"b":case"e":le(e,5,oS(r,n,t.v,t.t));return;case"s":case"str":le(e,4,cS(r,n,(t.v||"").slice(0,255)));return}le(e,1,Wl(null,r,n))}function dS(e,t,r,n){var a=Array.isArray(t),s=qe(t["!ref"]||"A1"),l,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=dt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Dt(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=$t(d)),l=c[d]+o;var f=a?(t[u]||[])[d]:t[l];f&&uS(e,f,u,d)}}}function fS(e,t){for(var r=t||{},n=ir(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return le(n,r.biff==4?1033:r.biff==3?521:9,$f(e,16,r)),dS(n,e.Sheets[e.SheetNames[a]],a,r),le(n,10),n.end()}function hS(e,t,r){le(e,49,ib({sz:12,name:"Arial"},r))}function mS(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&le(e,1054,cb(a,t[a],r))})}function xS(e,t){var r=q(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),le(e,2151,r),r=q(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),W1(qe(t["!ref"]||"A1"),r),r.write_shift(4,4),le(e,2152,r)}function pS(e,t){for(var r=0;r<16;++r)le(e,224,nx({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){le(e,224,nx(n,0,t))})}function gS(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];le(e,440,gb(n)),n[1].Tooltip&&le(e,2048,vb(n))}delete t["!links"]}function vS(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&le(e,125,_b(du(a,n),a))})}}function yS(e,t,r,n,a){var s=16+ga(a.cellXfs,t,a);if(t.v==null&&!t.bf){le(e,513,za(r,n,s));return}if(t.bf)le(e,6,z3(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?lr(qt(t.v)):t.v;le(e,515,hb(r,n,l,s));break;case"b":case"e":le(e,517,fb(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Kf(a.Strings,t.v,a.revStrings);le(e,253,lb(r,n,o,s))}else le(e,516,ob(r,n,(t.v||"").slice(0,255),s,a));break;default:le(e,513,za(r,n,s))}}function wS(e,t,r){var n=ir(),a=r.SheetNames[e],s=r.Sheets[a]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",h=[],x=qe(s["!ref"]||"A1"),g=u?65536:16384;if(x.e.c>255||x.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,g-1)}le(n,2057,$f(r,16,t)),le(n,13,Sr(1)),le(n,12,Sr(100)),le(n,15,Gt(!0)),le(n,17,Gt(!1)),le(n,16,Wa(.001)),le(n,95,Gt(!0)),le(n,42,Gt(!1)),le(n,43,Gt(!1)),le(n,130,Sr(1)),le(n,128,db()),le(n,131,Gt(!1)),le(n,132,Gt(!1)),u&&vS(n,s["!cols"]),le(n,512,ub(x,t)),u&&(s["!links"]=[]);for(var m=x.s.r;m<=x.e.r;++m){f=Dt(m);for(var _=x.s.c;_<=x.e.c;++_){m===x.s.r&&(h[_]=$t(_)),d=h[_]+f;var v=c?(s[m]||[])[_]:s[d];v&&(yS(n,v,m,_,t),u&&v.l&&s["!links"].push([d,v.l]))}}var p=o.CodeName||o.name||a;return u&&le(n,574,sb((l.Views||[])[0])),u&&(s["!merges"]||[]).length&&le(n,229,pb(s["!merges"])),u&&gS(n,s),le(n,442,$1(p)),u&&xS(n,s),le(n,10),n.end()}function _S(e,t,r){var n=ir(),a=(e||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(le(n,2057,$f(e,5,r)),r.bookType=="xla"&&le(n,135),le(n,225,o?Sr(1200):null),le(n,193,KN(2)),c&&le(n,191),c&&le(n,192),le(n,226),le(n,92,tb("SheetJS",r)),le(n,66,Sr(o?1200:1252)),o&&le(n,353,Sr(0)),o&&le(n,448),le(n,317,Nb(e.SheetNames.length)),o&&e.vbaraw&&le(n,211),o&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";le(n,442,$1(u))}le(n,156,Sr(17)),le(n,25,Gt(!1)),le(n,18,Gt(!1)),le(n,19,Sr(0)),o&&le(n,431,Gt(!1)),o&&le(n,444,Sr(0)),le(n,61,ab()),le(n,64,Gt(!1)),le(n,141,Sr(0)),le(n,34,Gt(Sj(e)=="true")),le(n,14,Gt(!0)),o&&le(n,439,Gt(!1)),le(n,218,Sr(0)),hS(n,e,r),mS(n,e.SSF,r),pS(n,r),o&&le(n,352,Gt(!1));var d=n.end(),f=ir();o&&le(f,140,yb()),o&&r.Strings&&lS(f,252,nb(r.Strings)),le(f,10);var h=f.end(),x=ir(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var _=d.length+g+h.length;for(m=0;m<e.SheetNames.length;++m){var v=s[m]||{};le(x,133,rb({pos:_,hs:v.Hidden||0,dt:0,name:e.SheetNames[m]},r)),_+=t[m].length}var p=x.end();if(g!=p.length)throw new Error("BS8 "+g+" != "+p.length);var w=[];return d.length&&w.push(d),p.length&&w.push(p),h.length&&w.push(h),kt(w)}function NS(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=or(lt)),e&&e.SSF&&(iu(),su(e.SSF),r.revssf=lu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Gf(r),r.cellXfs=[],ga(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=wS(a,r,e);return n.unshift(_S(e,n,r)),kt(n)}function mv(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=wr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return NS(e,t);case 4:case 3:case 2:return fS(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function bS(e,t,r,n){for(var a=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>l)&&!(a[u].e.r<r||a[u].e.c<l)){if(a[u].s.r<r||a[u].s.c<l){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var d=Ue({r,c:l}),f=n.dense?(e[r]||[])[l]:e[d],h=f&&f.v!=null&&(f.h||eN(f.w||(Dn(f),f.w)||""))||"",x={};o>1&&(x.rowspan=o),c>1&&(x.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(x["data-t"]=f&&f.t||"z",f.v!=null&&(x["data-v"]=f.v),f.z!=null&&(x["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),x.id=(n.id||"sjs")+"-"+d,s.push(se("td",h,x))}}var g="<tr>";return g+s.join("")+"</tr>"}var ES='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',jS="</body></html>";function SS(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xv(e,t){var r=t||{},n=r.header!=null?r.header:ES,a=r.footer!=null?r.footer:jS,s=[n],l=wr(e["!ref"]);r.dense=Array.isArray(e),s.push(SS(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(bS(e,l,o,r));return s.push("</table>"+a),s.join("")}function pv(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?_t(n.origin):n.origin;a=l.r,s=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=wr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,x=e["!rows"]||(e["!rows"]=[]),g=0,m=0,_=0,v=0,p=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<c;++g){var T=o[g];if(ux(T)){if(n.display)continue;x[m]={hidden:!0}}var I=T.children;for(_=v=0;_<I.length;++_){var L=I[_];if(!(n.display&&ux(L))){var j=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):aN(L.innerHTML),A=L.getAttribute("data-z")||L.getAttribute("z");for(h=0;h<f.length;++h){var y=f[h];y.s.c==v+s&&y.s.r<m+a&&m+a<=y.e.r&&(v=y.e.c+1-s,h=-1)}w=+L.getAttribute("colspan")||1,((p=+L.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:m+a,c:v+s},e:{r:m+a+(p||1)-1,c:v+s+(w||1)-1}});var O={t:"s",v:j},B=L.getAttribute("data-t")||L.getAttribute("t")||"";j!=null&&(j.length==0?O.t=B||"z":n.raw||j.trim().length==0||B=="s"||(j==="TRUE"?O={t:"b",v:!0}:j==="FALSE"?O={t:"b",v:!1}:isNaN(Nn(j))?isNaN(yl(j).getDate())||(O={t:"d",v:qt(j)},n.cellDates||(O={t:"n",v:lr(O.v)}),O.z=n.dateNF||lt[14]):O={t:"n",v:Nn(j)})),O.z===void 0&&A!=null&&(O.z=A);var H="",Q=L.getElementsByTagName("A");if(Q&&Q.length)for(var ie=0;ie<Q.length&&!(Q[ie].hasAttribute("href")&&(H=Q[ie].getAttribute("href"),H.charAt(0)!="#"));++ie);H&&H.charAt(0)!="#"&&(O.l={Target:H}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+s]=O):e[Ue({c:v+s,r:m+a})]=O,u.e.c<v+s&&(u.e.c=v+s),v+=w}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+a),e["!ref"]=dt(u),m>=c&&(e["!fullref"]=dt((u.e.r=o.length-g+m-1+a,u))),e}function gv(e,t){var r=t||{},n=r.dense?[]:{};return pv(n,e,t)}function TS(e,t){return Ya(gv(e,t),t)}function ux(e){var t="",r=kS(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function kS(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var CS=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+_l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ht+t}}(),dx=function(){var e=function(s){return Me(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var c=[];c.push('      <table:table table:name="'+Me(l.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=wr(s["!ref"]||"A1"),h=s["!merges"]||[],x=0,g=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",_=s["!rows"]||[];for(u=0;u<f.s.r;++u)m=_[u]?' table:style-name="ro'+_[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=f.e.r;++u){for(m=_[u]?' table:style-name="ro'+_[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var v=!1,p={},w="";for(x=0;x!=h.length;++x)if(!(h[x].s.c>d)&&!(h[x].s.r>u)&&!(h[x].e.c<d)&&!(h[x].e.r<u)){(h[x].s.c!=d||h[x].s.r!=u)&&(v=!0),p["table:number-columns-spanned"]=h[x].e.c-h[x].s.c+1,p["table:number-rows-spanned"]=h[x].e.r-h[x].s.r+1;break}if(v){c.push(r);continue}var T=Ue({r:u,c:d}),I=g?(s[u]||[])[d]:s[T];if(I&&I.f&&(p["table:formula"]=Me(Y3(I.f)),I.F&&I.F.slice(0,T.length)==T)){var L=wr(I.F);p["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,p["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!I){c.push(t);continue}switch(I.t){case"b":w=I.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=I.v?"true":"false";break;case"n":w=I.w||String(I.v||0),p["office:value-type"]="float",p["office:value"]=I.v||0;break;case"s":case"str":w=I.v==null?"":I.v,p["office:value-type"]="string";break;case"d":w=I.w||qt(I.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=qt(I.v).toISOString(),p["table:style-name"]="ce1";break;default:c.push(t);continue}var j=e(w);if(I.l&&I.l.Target){var A=I.l.Target;A=A.charAt(0)=="#"?"#"+q3(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),j=se("text:a",j,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+se("table:table-cell",se("text:p",j,{}),p)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Wf(f),f.ods=o;var h=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var c=[ht],u=_l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=_l({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(F1().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)c.push(n(l.Sheets[l.SheetNames[f]],l,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function vv(e,t){if(t.bookType=="fods")return dx(e,t);var r=Df(),n="",a=[],s=[];return n="mimetype",ke(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ke(r,n,dx(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ke(r,n,CS(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ke(r,n,ht+F1()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ke(r,n,$N(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ke(r,n,BN(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function AS(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):$r(wl(e))}function DS(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ua(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function FS(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Nl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Re(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Is(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function mt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Nl(e,r),s=a&7;a=Math.floor(a/8);var l=0,o;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Nl(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Et(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Re(n*8+a.type)),a.type==2&&t.push(Re(a.data.length)),t.push(a.data))})}),ua(t)}function Rr(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Nl(e,n),s=mt(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:Is(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=mt(o.data),u=Is(c[3][0].data);l.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(l.merge=Is(s[3][0].data)>>>0>0),r.push(l)}return r}function ss(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Re(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Re(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Re(l.data.length)}],n[2].push({data:Et(l.meta),type:2})});var s=Et(n);t.push(Re(s.length)),t.push(s),a.forEach(function(l){return t.push(l)})}),ua(t)}function OS(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Nl(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ua(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=ua(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Lr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(OS(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ua(t)}function is(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Re(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return ua(t)}function Ju(e,t){var r=new Uint8Array(32),n=Fc(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,FS(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Zu(e,t){var r=new Uint8Array(32),n=Fc(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function Ln(e){var t=mt(e);return Nl(t[1][0].data)}function PS(e,t,r){var n,a,s,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Is(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Fc(e[7][0].data),d=0,f=[],h=Fc(e[4][0].data),x=0,g=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}u.setUint16(m*2,d,!0),h.setUint16(m*2,x,!0);var _,v;switch(typeof t[m]){case"string":_=Ju({t:"s",v:t[m]},r),v=Zu({t:"s",v:t[m]},r);break;case"number":_=Ju({t:"n",v:t[m]},r),v=Zu({t:"n",v:t[m]},r);break;case"boolean":_=Ju({t:"b",v:t[m]},r),v=Zu({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(_),d+=_.length,g.push(v),x+=v.length,++c}for(e[2][0].data=Re(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=ua(f),e[3][0].data=ua(g),c}function IS(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=wr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(dt(n)));var s=Oc(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(W){return W.forEach(function(M){typeof M=="string"&&l.push(M)})});var o={},c=[],u=$e.read(t.numbers,{type:"base64"});u.FileIndex.map(function(W,M){return[W,u.FullPaths[M]]}).forEach(function(W){var M=W[0],U=W[1];if(M.type==2&&M.name.match(/\.iwa/)){var J=M.content,ce=Lr(J),pe=Rr(ce);pe.forEach(function(he){c.push(he.id),o[he.id]={deps:[],location:U,type:Is(he.messages[0].meta[1][0].data)}})}}),c.sort(function(W,M){return W-M});var d=c.filter(function(W){return W>1}).map(function(W){return[W,Re(W)]});u.FileIndex.map(function(W,M){return[W,u.FullPaths[M]]}).forEach(function(W){var M=W[0];if(W[1],!!M.name.match(/\.iwa/)){var U=Rr(Lr(M.content));U.forEach(function(J){J.messages.forEach(function(ce){d.forEach(function(pe){J.messages.some(function(he){return Is(he.meta[1][0].data)!=11006&&DS(he.data,pe[1])})&&o[pe[0]].deps.push(J.id)})})})}});for(var f=$e.find(u,o[1].location),h=Rr(Lr(f.content)),x,g=0;g<h.length;++g){var m=h[g];m.id==1&&(x=m)}var _=Ln(mt(x.messages[0].data)[1][0].data);for(f=$e.find(u,o[_].location),h=Rr(Lr(f.content)),g=0;g<h.length;++g)m=h[g],m.id==_&&(x=m);for(_=Ln(mt(x.messages[0].data)[2][0].data),f=$e.find(u,o[_].location),h=Rr(Lr(f.content)),g=0;g<h.length;++g)m=h[g],m.id==_&&(x=m);for(_=Ln(mt(x.messages[0].data)[2][0].data),f=$e.find(u,o[_].location),h=Rr(Lr(f.content)),g=0;g<h.length;++g)m=h[g],m.id==_&&(x=m);var v=mt(x.messages[0].data);{v[6][0].data=Re(n.e.r+1),v[7][0].data=Re(n.e.c+1);var p=Ln(v[46][0].data),w=$e.find(u,o[p].location),T=Rr(Lr(w.content));{for(var I=0;I<T.length&&T[I].id!=p;++I);if(T[I].id!=p)throw"Bad ColumnRowUIDMapArchive";var L=mt(T[I].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var j=0;j<=n.e.c;++j){var A=[];A[1]=A[2]=[{type:0,data:Re(j+420690)}],L[1].push({type:2,data:Et(A)}),L[2].push({type:0,data:Re(j)}),L[3].push({type:0,data:Re(j)})}L[4]=[],L[5]=[],L[6]=[];for(var y=0;y<=n.e.r;++y)A=[],A[1]=A[2]=[{type:0,data:Re(y+726270)}],L[4].push({type:2,data:Et(A)}),L[5].push({type:0,data:Re(y)}),L[6].push({type:0,data:Re(y)});T[I].messages[0].data=Et(L)}w.content=is(ss(T)),w.size=w.content.length,delete v[46];var O=mt(v[4][0].data);{O[7][0].data=Re(n.e.r+1);var B=mt(O[1][0].data),H=Ln(B[2][0].data);w=$e.find(u,o[H].location),T=Rr(Lr(w.content));{if(T[0].id!=H)throw"Bad HeaderStorageBucket";var Q=mt(T[0].messages[0].data);for(y=0;y<s.length;++y){var ie=mt(Q[2][0].data);ie[1][0].data=Re(y),ie[4][0].data=Re(s[y].length),Q[2][y]={type:Q[2][0].type,data:Et(ie)}}T[0].messages[0].data=Et(Q)}w.content=is(ss(T)),w.size=w.content.length;var oe=Ln(O[2][0].data);w=$e.find(u,o[oe].location),T=Rr(Lr(w.content));{if(T[0].id!=oe)throw"Bad HeaderStorageBucket";for(Q=mt(T[0].messages[0].data),j=0;j<=n.e.c;++j)ie=mt(Q[2][0].data),ie[1][0].data=Re(j),ie[4][0].data=Re(n.e.r+1),Q[2][j]={type:Q[2][0].type,data:Et(ie)};T[0].messages[0].data=Et(Q)}w.content=is(ss(T)),w.size=w.content.length;var we=Ln(O[4][0].data);(function(){for(var W=$e.find(u,o[we].location),M=Rr(Lr(W.content)),U,J=0;J<M.length;++J){var ce=M[J];ce.id==we&&(U=ce)}var pe=mt(U.messages[0].data);{pe[3]=[];var he=[];l.forEach(function(De,Ht){he[1]=[{type:0,data:Re(Ht)}],he[2]=[{type:0,data:Re(1)}],he[3]=[{type:2,data:AS(De)}],pe[3].push({type:2,data:Et(he)})})}U.messages[0].data=Et(pe);var de=ss(M),We=is(de);W.content=We,W.size=W.content.length})();var z=mt(O[3][0].data);{var K=z[1][0];delete z[2];var N=mt(K.data);{var D=Ln(N[2][0].data);(function(){for(var W=$e.find(u,o[D].location),M=Rr(Lr(W.content)),U,J=0;J<M.length;++J){var ce=M[J];ce.id==D&&(U=ce)}var pe=mt(U.messages[0].data);{delete pe[6],delete z[7];var he=new Uint8Array(pe[5][0].data);pe[5]=[];for(var de=0,We=0;We<=n.e.r;++We){var De=mt(he);de+=PS(De,s[We],l),De[1][0].data=Re(We),pe[5].push({data:Et(De),type:2})}pe[1]=[{type:0,data:Re(n.e.c+1)}],pe[2]=[{type:0,data:Re(n.e.r+1)}],pe[3]=[{type:0,data:Re(de)}],pe[4]=[{type:0,data:Re(n.e.r+1)}]}U.messages[0].data=Et(pe);var Ht=ss(M),Ie=is(Ht);W.content=Ie,W.size=W.content.length})()}K.data=Et(N)}O[3][0].data=Et(z)}v[4][0].data=Et(O)}x.messages[0].data=Et(v);var b=ss(h),S=is(b);return f.content=S,f.size=f.content.length,u}function RS(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Gf(e){RS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function LS(e,t){return t.bookType=="ods"?vv(e,t):t.bookType=="numbers"?IS(e,t):t.bookType=="xlsb"?MS(e,t):BS(e,t)}function MS(e,t){js=1024,e&&!e.SSF&&(e.SSF=or(lt)),e&&e.SSF&&(iu(),su(e.SSF),t.revssf=lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vi?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=ev.indexOf(t.bookType)>-1,a=C1();Gf(t=t||{});var s=Df(),l="",o=0;if(t.cellXfs=[],ga(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ke(s,l,O1(e.Props,t)),a.coreprops.push(l),Le(t.rels,2,l,Oe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,ke(s,l,I1(e.Props)),a.extprops.push(l),Le(t.rels,3,l,Oe.EXT_PROPS),e.Custprops!==e.Props&&Ot(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ke(s,l,R1(e.Custprops)),a.custprops.push(l),Le(t.rels,4,l,Oe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ke(s,l,$j(o-1,l,t,e,d)),a.sheets.push(l),Le(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(f){var x=f["!comments"],g=!1,m="";x&&x.length>0&&(m="xl/comments"+o+"."+r,ke(s,m,Hj(x,m)),a.comments.push(m),Le(d,-1,"../comments"+o+"."+r,Oe.CMNT),g=!0),f["!legacy"]&&g&&ke(s,"xl/drawings/vmlDrawing"+o+".vml",J1(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&ke(s,D1(l),Os(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ke(s,l,zj(t.Strings,l,t)),a.strs.push(l),Le(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),l="xl/workbook."+r,ke(s,l,Uj(e,l)),a.workbooks.push(l),Le(t.rels,1,l,Oe.WB),l="xl/theme/theme1.xml",ke(s,l,q1(e.Themes,t)),a.themes.push(l),Le(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),l="xl/styles."+r,ke(s,l,Wj(e,l,t)),a.styles.push(l),Le(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ke(s,l,e.vbaraw),a.vba.push(l),Le(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),l="xl/metadata."+r,ke(s,l,Vj(l)),a.metadata.push(l),Le(t.wbrels,-1,"metadata."+r,Oe.XLMETA),ke(s,"[Content_Types].xml",A1(a,t)),ke(s,"_rels/.rels",Os(t.rels)),ke(s,"xl/_rels/workbook."+r+".rels",Os(t.wbrels)),delete t.revssf,delete t.ssf,s}function BS(e,t){js=1024,e&&!e.SSF&&(e.SSF=or(lt)),e&&e.SSF&&(iu(),su(e.SSF),t.revssf=lu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vi?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=ev.indexOf(t.bookType)>-1,a=C1();Gf(t=t||{});var s=Df(),l="",o=0;if(t.cellXfs=[],ga(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ke(s,l,O1(e.Props,t)),a.coreprops.push(l),Le(t.rels,2,l,Oe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,ke(s,l,I1(e.Props)),a.extprops.push(l),Le(t.rels,3,l,Oe.EXT_PROPS),e.Custprops!==e.Props&&Ot(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ke(s,l,R1(e.Custprops)),a.custprops.push(l),Le(t.rels,4,l,Oe.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],x=(h||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ke(s,l,cv(o-1,t,e,f)),a.sheets.push(l),Le(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(h){var g=h["!comments"],m=!1,_="";if(g&&g.length>0){var v=!1;g.forEach(function(p){p[1].forEach(function(w){w.T==!0&&(v=!0)})}),v&&(_="xl/threadedComments/threadedComment"+o+"."+r,ke(s,_,p4(g,d,t)),a.threadedcomments.push(_),Le(f,-1,"../threadedComments/threadedComment"+o+"."+r,Oe.TCMNT)),_="xl/comments"+o+"."+r,ke(s,_,Z1(g)),a.comments.push(_),Le(f,-1,"../comments"+o+"."+r,Oe.CMNT),m=!0}h["!legacy"]&&m&&ke(s,"xl/drawings/vmlDrawing"+o+".vml",J1(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&ke(s,D1(l),Os(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ke(s,l,H1(t.Strings,t)),a.strs.push(l),Le(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),l="xl/workbook."+r,ke(s,l,fv(e)),a.workbooks.push(l),Le(t.rels,1,l,Oe.WB),l="xl/theme/theme1.xml",ke(s,l,q1(e.Themes,t)),a.themes.push(l),Le(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),l="xl/styles."+r,ke(s,l,X1(e,t)),a.styles.push(l),Le(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ke(s,l,e.vbaraw),a.vba.push(l),Le(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),l="xl/metadata."+r,ke(s,l,Q1()),a.metadata.push(l),Le(t.wbrels,-1,"metadata."+r,Oe.XLMETA),d.length>1&&(l="xl/persons/person.xml",ke(s,l,g4(d)),a.people.push(l),Le(t.wbrels,-1,"persons/person.xml",Oe.PEOPLE)),ke(s,"[Content_Types].xml",A1(a,t)),ke(s,"_rels/.rels",Os(t.rels)),ke(s,"xl/_rels/workbook."+r+".rels",Os(t.wbrels)),delete t.revssf,delete t.ssf,s}function US(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function yv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ml(t.file,$e.write(e,{type:Pe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $e.write(e,t)}function $S(e,t){var r=or(t||{}),n=LS(e,r);return WS(n,r)}function WS(e,t){var r={},n=Pe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?$e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(au(a))}return t.password&&typeof encrypt_agile<"u"?yv(encrypt_agile(a,t.password),t):t.type==="file"?Ml(t.file,a):t.type=="string"?$i(a):a}function zS(e,t){var r=t||{},n=sS(e,r);return yv(n,r)}function Zr(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return vl(wl(n));case"binary":return wl(n);case"string":return e;case"file":return Ml(t.file,n,"utf8");case"buffer":return Pe?Pn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Zr(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function HS(e,t){switch(t.type){case"base64":return vl(e);case"binary":return e;case"string":return e;case"file":return Ml(t.file,e,"binary");case"buffer":return Pe?Pn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function wo(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?vl(r):t.type=="string"?$i(r):r;case"file":return Ml(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function wv(e,t){v_(),Cj(e);var r=or(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=wv(e,r);return r.type="array",au(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Zr(nS(e,r),r);case"slk":case"sylk":return Zr(Sb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Zr(xv(e.Sheets[e.SheetNames[a]],r),r);case"txt":return HS(_v(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Zr(Xf(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Zr(Tb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return wo(jb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Zr(kb.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Zr(Ib.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Zr(z1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Zr(vv(e,r),r);case"wk1":return wo(ax.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return wo(ax.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),wo(mv(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),zS(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $S(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function VS(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ai(e,t,r){var n={};return n.type="file",n.file=t,VS(n),wv(e,n)}function KS(e,t,r,n,a,s,l,o){var c=Dt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var x=t.s.c;x<=t.e.c;++x){var g=l?e[r][x]:e[n[x]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[x]!=null&&(h[s[x]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[x]!=null){if(m==null)if(g.t=="e"&&m===null)h[s[x]]=null;else if(u!==void 0)h[s[x]]=u;else if(d&&m===null)h[s[x]]=null;else continue;else h[s[x]]=d&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:Dn(g,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Oc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=qe(d);break;case"number":c=qe(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=Dt(c.s.r),h=[],x=[],g=0,m=0,_=Array.isArray(e),v=c.s.r,p=0,w={};_&&!e[v]&&(e[v]=[]);var T=u.skipHidden&&e["!cols"]||[],I=u.skipHidden&&e["!rows"]||[];for(p=c.s.c;p<=c.e.c;++p)if(!(T[p]||{}).hidden)switch(h[p]=$t(p),r=_?e[v][p]:e[h[p]+f],n){case 1:s[p]=p-c.s.c;break;case 2:s[p]=h[p];break;case 3:s[p]=u.header[p-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=Dn(r,null,u),m=w[l]||0,!m)w[l]=1;else{do o=l+"_"+m++;while(w[o]);w[l]=m,w[o]=1}s[p]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(I[v]||{}).hidden){var L=KS(e,c,v,h,n,s,_,u);(L.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(x[g++]=L.row)}return x.length=g,x}var fx=/"/g;function GS(e,t,r,n,a,s,l,o){for(var c=!0,u=[],d="",f=Dt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var x=o.dense?(e[r]||[])[h]:e[n[h]+f];if(x==null)d="";else if(x.v!=null){c=!1,d=""+(o.rawNumbers&&x.t=="n"?x.v:Dn(x,null,o));for(var g=0,m=0;g!==d.length;++g)if((m=d.charCodeAt(g))===a||m===s||m===34||o.forceQuotes){d='"'+d.replace(fx,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(c=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(fx,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(l)}function Xf(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=qe(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(h[g]||{}).hidden||(f[g]=$t(g));for(var m=0,_=a.s.r;_<=a.e.r;++_)(x[_]||{}).hidden||(d=GS(e,a,_,f,l,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function _v(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Xf(e,t);return r}function XS(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=qe(e["!ref"]),s="",l=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)l[o]=$t(o);for(var d=a.s.r;d<=a.e.r;++d)for(s=Dt(d),o=a.s.c;o<=a.e.c;++o)if(t=l[o]+s,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function Nv(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?_t(n.origin):n.origin;l=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+a}};if(s["!ref"]){var f=qe(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+a)}else l==-1&&(l=0,d.e.r=t.length-1+a);var h=n.header||[],x=0;t.forEach(function(m,_){Ot(m).forEach(function(v){(x=h.indexOf(v))==-1&&(h[x=h.length]=v);var p=m[v],w="z",T="",I=Ue({c:o+x,r:l+_+a});u=bl(s,I),p&&typeof p=="object"&&!(p instanceof Date)?s[I]=p:(typeof p=="number"?w="n":typeof p=="boolean"?w="b":typeof p=="string"?w="s":p instanceof Date?(w="d",n.cellDates||(w="n",p=lr(p)),T=n.dateNF||lt[14]):p===null&&n.nullError&&(w="e",p=0),u?(u.t=w,u.v=p,delete u.w,delete u.R,T&&(u.z=T)):s[I]=u={t:w,v:p},T&&(u.z=T))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var g=Dt(l);if(a)for(x=0;x<h.length;++x)s[$t(x+o)+g]={t:"s",v:h[x]};return s["!ref"]=dt(d),s}function YS(e,t){return Nv(null,e,t)}function bl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=_t(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?bl(e,Ue(t)):bl(e,Ue({r:t,c:r||0}))}function qS(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function QS(){return{SheetNames:[],Sheets:{}}}function JS(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(dv(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ZS(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=qS(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function eT(e,t){return e.z=t,e}function bv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function tT(e,t,r){return bv(e,"#"+t,r)}function rT(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nT(e,t,r,n){for(var a=typeof t!="string"?t:qe(t),s=typeof t=="string"?t:dt(t),l=a.s.r;l<=a.e.r;++l)for(var o=a.s.c;o<=a.e.c;++o){var c=bl(e,l,o);c.t="n",c.F=s,delete c.v,l==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Ne={encode_col:$t,encode_row:Dt,encode_cell:Ue,encode_range:dt,decode_col:Lf,decode_row:Rf,split_cell:vN,decode_cell:_t,decode_range:wr,format_cell:Dn,sheet_add_aoa:b1,sheet_add_json:Nv,sheet_add_dom:pv,aoa_to_sheet:ti,json_to_sheet:YS,table_to_sheet:gv,table_to_book:TS,sheet_to_csv:Xf,sheet_to_txt:_v,sheet_to_json:Oc,sheet_to_html:xv,sheet_to_formulae:XS,sheet_to_row_object_array:Oc,sheet_get_cell:bl,book_new:QS,book_append_sheet:JS,book_set_sheet_visibility:ZS,cell_set_number_format:eT,cell_set_hyperlink:bv,cell_set_internal_link:tT,cell_add_comment:rT,sheet_set_array_formula:nT,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const _e={header:{font:{bold:!0,color:{rgb:"FFFFFF"},size:12},fill:{fgColor:{rgb:"2563EB"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}},subHeader:{font:{bold:!0,color:{rgb:"1F2937"},size:11},fill:{fgColor:{rgb:"F3F4F6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}},data:{font:{color:{rgb:"374151"},size:10},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"D1D5DB"}},bottom:{style:"thin",color:{rgb:"D1D5DB"}},left:{style:"thin",color:{rgb:"D1D5DB"}},right:{style:"thin",color:{rgb:"D1D5DB"}}}},currency:{font:{color:{rgb:"059669"},size:10,bold:!0},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"D1D5DB"}},bottom:{style:"thin",color:{rgb:"D1D5DB"}},left:{style:"thin",color:{rgb:"D1D5DB"}},right:{style:"thin",color:{rgb:"D1D5DB"}}}},negative:{font:{color:{rgb:"DC2626"},size:10,bold:!0},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"D1D5DB"}},bottom:{style:"thin",color:{rgb:"D1D5DB"}},left:{style:"thin",color:{rgb:"D1D5DB"}},right:{style:"thin",color:{rgb:"D1D5DB"}}}},status:{completed:{font:{color:{rgb:"FFFFFF"},size:10,bold:!0},fill:{fgColor:{rgb:"059669"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}},inProgress:{font:{color:{rgb:"FFFFFF"},size:10,bold:!0},fill:{fgColor:{rgb:"D97706"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}},partialPayment:{font:{color:{rgb:"FFFFFF"},size:10,bold:!0},fill:{fgColor:{rgb:"EA580C"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}},fullPayment:{font:{color:{rgb:"FFFFFF"},size:10,bold:!0},fill:{fgColor:{rgb:"16A34A"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}},overpaid:{font:{color:{rgb:"FFFFFF"},size:10,bold:!0},fill:{fgColor:{rgb:"7C3AED"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}},title:{font:{bold:!0,color:{rgb:"1F2937"},size:16},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"E5E7EB"}}},summary:{font:{bold:!0,color:{rgb:"1F2937"},size:11},fill:{fgColor:{rgb:"FEF3C7"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"medium",color:{rgb:"000000"}},bottom:{style:"medium",color:{rgb:"000000"}},left:{style:"medium",color:{rgb:"000000"}},right:{style:"medium",color:{rgb:"000000"}}}}},be=(e,t,r)=>{e[t]||(e[t]={}),e[t].s=r},si=(e,t)=>{e["!cols"]=t.map(r=>({width:r}))},Ev=e=>{switch(e){case"completed_full_payment":return _e.status.fullPayment;case"completed_partial_payment":return _e.status.partialPayment;case"completed_overpaid":return _e.status.overpaid;case"completed":return _e.status.completed;case"in_progress":return _e.status.inProgress;default:return _e.data}},fu=e=>({in_progress:"قيد التنفيذ",completed:"مكتملة",completed_partial_payment:"مكتملة - دفع جزئي",completed_full_payment:"مكتملة ومدفوعة بالكامل",completed_overpaid:"مكتملة - سداد بالزيادة"})[e],es=async(e,t)=>{try{const{Document:r,Packer:n,Paragraph:a,TextRun:s,Table:l,TableRow:o,TableCell:c,WidthType:u}=await x_(async()=>{const{Document:m,Packer:_,Paragraph:v,TextRun:p,Table:w,TableRow:T,TableCell:I,WidthType:L}=await import("./index-Cl7su7uW.js");return{Document:m,Packer:_,Paragraph:v,TextRun:p,Table:w,TableRow:T,TableCell:I,WidthType:L}},[]),d=new r({sections:[{properties:{},children:[new a({children:[new s({text:e,bold:!0,size:24})]})]}]}),f=await n.toBuffer(d),h=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),x=URL.createObjectURL(h),g=document.createElement("a");return g.href=x,g.download=t,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(x),!0}catch(r){return console.warn("Word export failed, falling back to HTML:",r),!1}},cr=(e,t)=>{const r=`
    <!DOCTYPE html>
    <html dir="rtl" lang="ar">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>تقرير</title>
      <style>
        body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .header { text-align: center; margin-bottom: 30px; }
        .summary { background-color: #f9f9f9; padding: 15px; margin: 20px 0; }
      </style>
    </head>
    <body>
      ${e}
    </body>
    </html>
  `,n=new Blob([r],{type:"text/html;charset=utf-8"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download=t.replace(".docx",".html"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)},us=(e,t,r="تقرير العمليات")=>{const n=_=>{const v=t.find(p=>p.id===_);return v?v.name:"عميل غير معروف"},a=e.map(_=>{const v=Dr(_),p=Ua(_),w=_.totalReceived+v,T=_.totalAmount-w;return{"كود العملية":_.code,"اسم العملية":_.name,العميل:n(_.clientId),"القيمة الإجمالية":_.totalAmount,الخصومات:v,"الصافي المستحق":p,"المبلغ المحصل":_.totalReceived,"إجمالي المسدد":w,"المبلغ المتبقي":T,"نسبة الإنجاز":`${_.overallExecutionPercentage.toFixed(1)}%`,الحالة:fu(_.status),"تاريخ الإنشاء":je(_.createdAt)}}),s=Ne.json_to_sheet(a);Ne.sheet_add_aoa(s,[[r]],{origin:"A1"}),Ne.sheet_add_aoa(s,[["تاريخ التقرير: "+je(new Date)]],{origin:"A2"}),Ne.sheet_add_aoa(s,[[""]],{origin:"A3"});const l=Ne.decode_range(s["!ref"]||"A1");l.s.r=3,s["!ref"]=Ne.encode_range(l),be(s,"A1",_e.title),be(s,"A2",_e.subHeader);const o=Object.keys(a[0]||{});o.forEach((_,v)=>{const p=Ne.encode_cell({r:3,c:v});be(s,p,_e.header)}),a.forEach((_,v)=>{Object.values(_).forEach((p,w)=>{const T=Ne.encode_cell({r:v+4,c:w});if(w===o.indexOf("القيمة الإجمالية")||w===o.indexOf("الصافي المستحق")||w===o.indexOf("المبلغ المحصل")||w===o.indexOf("إجمالي المسدد"))be(s,T,_e.currency);else if(w===o.indexOf("الخصومات")||w===o.indexOf("المبلغ المتبقي"))be(s,T,_e.negative);else if(w===o.indexOf("الحالة")){const I=e[v];be(s,T,Ev(I.status))}else be(s,T,_e.data)})}),si(s,[15,25,20,15,12,15,15,15,15,12,20,12]);const c=a.length+6,u=e.reduce((_,v)=>_+v.totalAmount,0),d=e.reduce((_,v)=>_+v.totalReceived,0),f=e.reduce((_,v)=>_+Dr(v),0),h=d+f,x=[["","","","","","","","","","","",""],["الملخص الإجمالي","","","","","","","","","","",""],["إجمالي العمليات:",e.length,"","","","","","","","","",""],["إجمالي القيمة:",ne(u),"","","","","","","","","",""],["إجمالي المحصل:",ne(d),"","","","","","","","","",""],["إجمالي الخصومات:",ne(f),"","","","","","","","","",""],["إجمالي المسدد:",ne(h),"","","","","","","","","",""]];Ne.sheet_add_aoa(s,x,{origin:`A${c}`}),be(s,`A${c+1}`,_e.summary);for(let _=2;_<=6;_++)be(s,`A${c+_}`,_e.subHeader),be(s,`B${c+_}`,_e.currency);const g=Ne.book_new();Ne.book_append_sheet(g,s,"العمليات");const m=`${r.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`;ai(g,m)},aT=(e,t="تقرير العملاء")=>{const r=d=>({owner:"مالك",main_contractor:"مقاول رئيسي",consultant:"استشاري"})[d]||d,n=e.map(d=>{var h,x;const f=(h=d.contacts)==null?void 0:h.find(g=>g.isMainContact);return{"اسم العميل":d.name,"نوع العميل":r(d.type),"رقم الهاتف":d.phone||"-","البريد الإلكتروني":d.email||"-",العنوان:d.address||"-","جهة الاتصال الرئيسية":(f==null?void 0:f.name)||"-","منصب جهة الاتصال":(f==null?void 0:f.position)||"-","هاتف جهة الاتصال":(f==null?void 0:f.phone)||"-","عدد جهات الاتصال":((x=d.contacts)==null?void 0:x.length)||0,"تاريخ الإضافة":je(d.createdAt)}}),a=Ne.json_to_sheet(n);Ne.sheet_add_aoa(a,[[t]],{origin:"A1"}),Ne.sheet_add_aoa(a,[["تاريخ التقرير: "+je(new Date)]],{origin:"A2"}),Ne.sheet_add_aoa(a,[[""]],{origin:"A3"}),be(a,"A1",_e.title),be(a,"A2",_e.subHeader),Object.keys(n[0]||{}).forEach((d,f)=>{const h=Ne.encode_cell({r:3,c:f});be(a,h,_e.header)}),n.forEach((d,f)=>{Object.values(d).forEach((h,x)=>{const g=Ne.encode_cell({r:f+4,c:x});be(a,g,_e.data)})}),si(a,[25,15,15,25,30,20,20,15,12,12]);const l=n.length+6,o=[["","","","","","","","","",""],["الملخص الإجمالي","","","","","","","","",""],["إجمالي العملاء:",e.length,"","","","","","","",""],["المالكين:",e.filter(d=>d.type==="owner").length,"","","","","","","",""],["المقاولين الرئيسيين:",e.filter(d=>d.type==="main_contractor").length,"","","","","","","",""],["الاستشاريين:",e.filter(d=>d.type==="consultant").length,"","","","","","","",""]];Ne.sheet_add_aoa(a,o,{origin:`A${l}`}),be(a,`A${l+1}`,_e.summary);for(let d=2;d<=5;d++)be(a,`A${l+d}`,_e.subHeader),be(a,`B${l+d}`,_e.data);const c=Ne.book_new();Ne.book_append_sheet(c,a,"العملاء");const u=`${t.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`;ai(c,u)},sT=(e,t)=>{const r=v=>{const p=t.find(w=>w.id===v);return p?p.name:"عميل غير معروف"},n=e.map(v=>{const p=Dr(v),w=Ua(v),T=v.totalReceived+p,I=v.totalAmount-T,L=v.totalAmount>0?T/v.totalAmount*100:0;return{العملية:v.name,العميل:r(v.clientId),"القيمة الإجمالية":v.totalAmount,"المبلغ المنفذ":v.items.reduce((j,A)=>j+A.amount*A.executionPercentage/100,0),"إجمالي الخصومات":p,"الصافي المستحق":w,"المبلغ المحصل نقداً":v.totalReceived,"إجمالي المسدد":T,"المبلغ المتبقي":I,"معدل السداد":`${L.toFixed(1)}%`,"نسبة التنفيذ":`${v.overallExecutionPercentage.toFixed(1)}%`,الحالة:fu(v.status)}}),a=Ne.json_to_sheet(n);Ne.sheet_add_aoa(a,[["التقرير المالي الشامل"]],{origin:"A1"}),Ne.sheet_add_aoa(a,[["تاريخ التقرير: "+je(new Date)]],{origin:"A2"}),Ne.sheet_add_aoa(a,[[""]],{origin:"A3"}),be(a,"A1",_e.title),be(a,"A2",_e.subHeader);const s=Object.keys(n[0]||{});s.forEach((v,p)=>{const w=Ne.encode_cell({r:3,c:p});be(a,w,_e.header)}),n.forEach((v,p)=>{Object.values(v).forEach((w,T)=>{const I=Ne.encode_cell({r:p+4,c:T});if(s[T].includes("القيمة")||s[T].includes("المبلغ")||s[T].includes("الصافي"))s[T].includes("المتبقي")||s[T].includes("الخصومات")?be(a,I,_e.negative):be(a,I,_e.currency);else if(s[T]==="الحالة"){const L=e[p];be(a,I,Ev(L.status))}else be(a,I,_e.data)})}),si(a,[25,20,15,15,15,15,15,15,15,12,12,20]);const l=n.length+6,o=e.reduce((v,p)=>v+p.totalAmount,0),c=e.reduce((v,p)=>v+p.totalReceived,0),u=e.reduce((v,p)=>v+Dr(p),0),d=e.reduce((v,p)=>v+Ua(p),0),f=c+u,h=o-f,x=o>0?f/o*100:0,g=[["","","","","","","","","","","",""],["الملخص المالي الإجمالي","","","","","","","","","","",""],["إجمالي قيمة العمليات:",ne(o),"","","","","","","","","",""],["إجمالي الخصومات:",ne(u),"","","","","","","","","",""],["إجمالي الصافي المستحق:",ne(d),"","","","","","","","","",""],["إجمالي المحصل نقداً:",ne(c),"","","","","","","","","",""],["إجمالي المسدد (نقدي + خصومات):",ne(f),"","","","","","","","","",""],["إجمالي المبلغ المتبقي:",ne(h),"","","","","","","","","",""],["معدل السداد الإجمالي:",`${x.toFixed(1)}%`,"","","","","","","","","",""]];Ne.sheet_add_aoa(a,g,{origin:`A${l}`}),be(a,`A${l+1}`,_e.summary);for(let v=2;v<=8;v++)be(a,`A${l+v}`,_e.subHeader),be(a,`B${l+v}`,_e.currency);const m=Ne.book_new();Ne.book_append_sheet(m,a,"التقرير المالي");const _=`التقرير_المالي_${new Date().toISOString().split("T")[0]}.xlsx`;ai(m,_)},iT=(e,t)=>{const r=g=>{const m=t.find(_=>_.id===g);return m?m.name:"عميل غير معروف"},n=[];e.forEach(g=>{g.guaranteeChecks.forEach(m=>{n.push({"نوع الضمان":"شيك ضمان","رقم الضمان":m.checkNumber,المبلغ:m.amount,البنك:m.bank,العميل:r(g.clientId),العملية:g.name,"تاريخ الإصدار":je(m.checkDate),"تاريخ التسليم":je(m.deliveryDate),"تاريخ الانتهاء":je(m.expiryDate),الحالة:m.isReturned?"مُسترد":"قائم","تاريخ الاسترداد":m.returnDate?je(m.returnDate):"-"})}),g.guaranteeLetters.forEach(m=>{n.push({"نوع الضمان":"خطاب ضمان","رقم الضمان":m.letterNumber,المبلغ:m.amount,البنك:m.bank,العميل:r(g.clientId),العملية:g.name,"تاريخ الإصدار":je(m.letterDate),"تاريخ التسليم":"-","تاريخ الانتهاء":je(m.dueDate),الحالة:m.isReturned?"مُسترد":"قائم","تاريخ الاسترداد":m.returnDate?je(m.returnDate):"-"})})});const a=Ne.json_to_sheet(n);Ne.sheet_add_aoa(a,[["تقرير الضمانات الشامل"]],{origin:"A1"}),Ne.sheet_add_aoa(a,[["تاريخ التقرير: "+je(new Date)]],{origin:"A2"}),Ne.sheet_add_aoa(a,[[""]],{origin:"A3"}),be(a,"A1",_e.title),be(a,"A2",_e.subHeader);const s=Object.keys(n[0]||{});s.forEach((g,m)=>{const _=Ne.encode_cell({r:3,c:m});be(a,_,_e.header)}),n.forEach((g,m)=>{Object.values(g).forEach((_,v)=>{const p=Ne.encode_cell({r:m+4,c:v});s[v]==="المبلغ"?be(a,p,_e.currency):s[v]==="الحالة"?be(a,p,_==="مُسترد"?_e.status.completed:_e.status.inProgress):be(a,p,_e.data)})}),si(a,[15,15,12,20,20,25,12,12,12,10,12]);const l=n.length+6,o=n.length,c=n.filter(g=>g.الحالة==="قائم").length,u=n.filter(g=>g.الحالة==="مُسترد").length,d=n.reduce((g,m)=>g+(m.المبلغ||0),0),f=[["","","","","","","","","","",""],["ملخص الضمانات","","","","","","","","","",""],["إجمالي الضمانات:",o,"","","","","","","","",""],["الضمانات القائمة:",c,"","","","","","","","",""],["الضمانات المستردة:",u,"","","","","","","","",""],["إجمالي قيمة الضمانات:",ne(d),"","","","","","","","",""]];Ne.sheet_add_aoa(a,f,{origin:`A${l}`}),be(a,`A${l+1}`,_e.summary);for(let g=2;g<=5;g++)be(a,`A${l+g}`,_e.subHeader),be(a,`B${l+g}`,_e.currency);const h=Ne.book_new();Ne.book_append_sheet(h,a,"الضمانات");const x=`تقرير_الضمانات_${new Date().toISOString().split("T")[0]}.xlsx`;ai(h,x)},lT=(e,t)=>{const r=g=>{const m=t.find(_=>_.id===g);return m?m.name:"عميل غير معروف"},n=(g,m)=>{const _=e.find(p=>p.id===g);if(!_)return"بند غير معروف";const v=_.items.find(p=>p.id===m);return v?v.description:"بند غير معروف"},a=[];e.forEach(g=>{(g.warrantyCertificates||[]).forEach(m=>{const _=new Date(m.endDate)<new Date;a.push({"رقم الشهادة":m.certificateNumber,العميل:r(g.clientId),العملية:g.name,البند:m.relatedTo==="item"&&m.relatedItemId?n(g.id,m.relatedItemId):"العملية كاملة","وصف الضمان":m.description,"تاريخ الإصدار":je(m.issueDate),"تاريخ البداية":je(m.startDate),"تاريخ النهاية":je(m.endDate),"مدة الضمان (شهر)":m.warrantyPeriodMonths,الحالة:m.isActive&&!_?"نشط":"منتهي",ملاحظات:m.notes||"-"})})});const s=Ne.json_to_sheet(a);Ne.sheet_add_aoa(s,[["تقرير شهادات الضمان"]],{origin:"A1"}),Ne.sheet_add_aoa(s,[["تاريخ التقرير: "+je(new Date)]],{origin:"A2"}),Ne.sheet_add_aoa(s,[[""]],{origin:"A3"}),be(s,"A1",_e.title),be(s,"A2",_e.subHeader);const l=Object.keys(a[0]||{});l.forEach((g,m)=>{const _=Ne.encode_cell({r:3,c:m});be(s,_,_e.header)}),a.forEach((g,m)=>{Object.values(g).forEach((_,v)=>{const p=Ne.encode_cell({r:m+4,c:v});l[v]==="الحالة"?be(s,p,_==="نشط"?_e.status.completed:_e.status.inProgress):be(s,p,_e.data)})}),si(s,[15,20,25,25,30,12,12,12,10,10,20]);const o=a.length+6,c=a.length,u=a.filter(g=>g.الحالة==="نشط").length,d=a.filter(g=>g.الحالة==="منتهي").length,f=[["","","","","","","","","","",""],["ملخص شهادات الضمان","","","","","","","","","",""],["إجمالي الشهادات:",c,"","","","","","","","",""],["الشهادات النشطة:",u,"","","","","","","","",""],["الشهادات المنتهية:",d,"","","","","","","","",""]];Ne.sheet_add_aoa(s,f,{origin:`A${o}`}),be(s,`A${o+1}`,_e.summary);for(let g=2;g<=4;g++)be(s,`A${o+g}`,_e.subHeader),be(s,`B${o+g}`,_e.data);const h=Ne.book_new();Ne.book_append_sheet(h,s,"شهادات الضمان");const x=`تقرير_شهادات_الضمان_${new Date().toISOString().split("T")[0]}.xlsx`;ai(h,x)},oT=(e,t)=>{const r=g=>{const m=t.find(_=>_.id===g);return m?m.name:"عميل غير معروف"},n=e.flatMap(g=>g.receivedPayments.map(m=>({"نوع الدفع":m.type==="check"?"شيك":"نقدي",المبلغ:m.amount,التاريخ:je(m.date),العميل:r(g.clientId),العملية:g.name,"رقم الشيك":m.checkNumber||"-",البنك:m.bank||"-","تاريخ الاستلام":m.receiptDate?je(m.receiptDate):"-",الحالة:m.type==="check"?m.receiptDate?"مستلم":"معلق":"مستلم",ملاحظات:m.notes||"-"}))),a=Ne.json_to_sheet(n);Ne.sheet_add_aoa(a,[["تقرير الشيكات والمدفوعات"]],{origin:"A1"}),Ne.sheet_add_aoa(a,[["تاريخ التقرير: "+je(new Date)]],{origin:"A2"}),Ne.sheet_add_aoa(a,[[""]],{origin:"A3"}),be(a,"A1",_e.title),be(a,"A2",_e.subHeader);const s=Object.keys(n[0]||{});s.forEach((g,m)=>{const _=Ne.encode_cell({r:3,c:m});be(a,_,_e.header)}),n.forEach((g,m)=>{Object.values(g).forEach((_,v)=>{const p=Ne.encode_cell({r:m+4,c:v});s[v]==="المبلغ"?be(a,p,_e.currency):s[v]==="الحالة"?be(a,p,_==="مستلم"?_e.status.completed:_e.status.inProgress):be(a,p,_e.data)})}),si(a,[12,15,12,20,25,15,20,12,10,20]);const l=n.length+6,o=n.reduce((g,m)=>g+m.المبلغ,0),c=n.filter(g=>g["نوع الدفع"]==="شيك").length,u=n.filter(g=>g["نوع الدفع"]==="نقدي").length,d=n.filter(g=>g["نوع الدفع"]==="شيك"&&g.الحالة==="معلق").length,f=[["","","","","","","","","",""],["ملخص المدفوعات","","","","","","","","",""],["إجمالي المبلغ:",ne(o),"","","","","","","",""],["عدد الشيكات:",c,"","","","","","","",""],["المدفوعات النقدية:",u,"","","","","","","",""],["الشيكات المعلقة:",d,"","","","","","","",""]];Ne.sheet_add_aoa(a,f,{origin:`A${l}`}),be(a,`A${l+1}`,_e.summary);for(let g=2;g<=5;g++)be(a,`A${l+g}`,_e.subHeader),be(a,`B${l+g}`,_e.currency);const h=Ne.book_new();Ne.book_append_sheet(h,a,"الشيكات والمدفوعات");const x=`تقرير_الشيكات_والمدفوعات_${new Date().toISOString().split("T")[0]}.xlsx`;ai(h,x)},Uo=async(e,t,r="تقرير العمليات")=>{const n=l=>{const o=t.find(c=>c.id===l);return o?o.name:"عميل غير معروف"},a=`
    <div class="header">
      <h1>${r}</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <table>
      <thead>
        <tr>
          <th>كود العملية</th>
          <th>اسم العملية</th>
          <th>العميل</th>
          <th>القيمة الإجمالية</th>
          <th>المبلغ المحصل</th>
          <th>الحالة</th>
        </tr>
      </thead>
      <tbody>
        ${e.map(l=>`
          <tr>
            <td>${l.code}</td>
            <td>${l.name}</td>
            <td>${n(l.clientId)}</td>
            <td>${ne(l.totalAmount)}</td>
            <td>${ne(l.totalReceived)}</td>
            <td>${fu(l.status)}</td>
          </tr>
        `).join("")}
      </tbody>
    </table>
    
    <div class="summary">
      <h3>الملخص الإجمالي</h3>
      <p>إجمالي العمليات: ${e.length}</p>
      <p>إجمالي القيمة: ${ne(e.reduce((l,o)=>l+o.totalAmount,0))}</p>
      <p>إجمالي المحصل: ${ne(e.reduce((l,o)=>l+o.totalReceived,0))}</p>
    </div>
  `;await es(a,`${r.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.docx`)||cr(a,`${r.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.docx`)},cT=async(e,t="تقرير العملاء")=>{const r=s=>({owner:"مالك",main_contractor:"مقاول رئيسي",consultant:"استشاري"})[s]||s,n=`
    <div class="header">
      <h1>${t}</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <table>
      <thead>
        <tr>
          <th>اسم العميل</th>
          <th>نوع العميل</th>
          <th>رقم الهاتف</th>
          <th>البريد الإلكتروني</th>
          <th>العنوان</th>
        </tr>
      </thead>
      <tbody>
        ${e.map(s=>`
          <tr>
            <td>${s.name}</td>
            <td>${r(s.type)}</td>
            <td>${s.phone||"-"}</td>
            <td>${s.email||"-"}</td>
            <td>${s.address||"-"}</td>
          </tr>
        `).join("")}
      </tbody>
    </table>
    
    <div class="summary">
      <h3>الملخص الإجمالي</h3>
      <p>إجمالي العملاء: ${e.length}</p>
      <p>المالكين: ${e.filter(s=>s.type==="owner").length}</p>
      <p>المقاولين الرئيسيين: ${e.filter(s=>s.type==="main_contractor").length}</p>
      <p>الاستشاريين: ${e.filter(s=>s.type==="consultant").length}</p>
    </div>
  `;await es(n,`${t.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.docx`)||cr(n,`${t.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.docx`)},uT=async(e,t)=>{const r=`
    <div class="header">
      <h1>التقرير المالي الشامل</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <div class="summary">
      <h3>الملخص المالي الإجمالي</h3>
      <p>إجمالي قيمة العمليات: ${ne(e.reduce((a,s)=>a+s.totalAmount,0))}</p>
      <p>إجمالي المحصل: ${ne(e.reduce((a,s)=>a+s.totalReceived,0))}</p>
      <p>إجمالي الخصومات: ${ne(e.reduce((a,s)=>a+Dr(s),0))}</p>
    </div>
  `;await es(r,`التقرير_المالي_${new Date().toISOString().split("T")[0]}.docx`)||cr(r,`التقرير_المالي_${new Date().toISOString().split("T")[0]}.docx`)},jv=async(e,t)=>{const r=`
    <div class="header">
      <h1>تقرير الضمانات المفصل</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <div class="summary">
      <h3>ملخص الضمانات</h3>
      <p>إجمالي شيكات الضمان: ${e.reduce((a,s)=>a+s.guaranteeChecks.length,0)}</p>
      <p>إجمالي خطابات الضمان: ${e.reduce((a,s)=>a+s.guaranteeLetters.length,0)}</p>
    </div>
  `;await es(r,`تقرير_الضمانات_المفصل_${new Date().toISOString().split("T")[0]}.docx`)||cr(r,`تقرير_الضمانات_المفصل_${new Date().toISOString().split("T")[0]}.docx`)},Sv=async(e,t)=>{const r=`
    <div class="header">
      <h1>تقرير شهادات الضمان</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <div class="summary">
      <h3>ملخص شهادات الضمان</h3>
      <p>إجمالي الشهادات: ${e.reduce((a,s)=>a+(s.warrantyCertificates||[]).length,0)}</p>
    </div>
  `;await es(r,`تقرير_شهادات_الضمان_${new Date().toISOString().split("T")[0]}.docx`)||cr(r,`تقرير_شهادات_الضمان_${new Date().toISOString().split("T")[0]}.docx`)},dT=async(e,t)=>{const r=`
    <div class="header">
      <h1>تقرير الشيكات والمدفوعات</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <div class="summary">
      <h3>ملخص المدفوعات</h3>
      <p>إجمالي المدفوعات: ${e.reduce((a,s)=>a+s.receivedPayments.length,0)}</p>
    </div>
  `;await es(r,`تقرير_الشيكات_والمدفوعات_${new Date().toISOString().split("T")[0]}.docx`)||cr(r,`تقرير_الشيكات_والمدفوعات_${new Date().toISOString().split("T")[0]}.docx`)},fT=async(e,t)=>{const r=`
    <div class="header">
      <h1>تفاصيل العملية: ${e.name}</h1>
      <p>كود العملية: ${e.code}</p>
      <p>العميل: ${t.name}</p>
    </div>
    
    <div class="summary">
      <h3>الملخص المالي</h3>
      <p>القيمة الإجمالية: ${ne(e.totalAmount)}</p>
      <p>المبلغ المحصل: ${ne(e.totalReceived)}</p>
      <p>نسبة الإنجاز: ${e.overallExecutionPercentage.toFixed(1)}%</p>
    </div>
  `;await es(r,`تفاصيل_العملية_${e.code}_${new Date().toISOString().split("T")[0]}.docx`)||cr(r,`تفاصيل_العملية_${e.code}_${new Date().toISOString().split("T")[0]}.docx`)},$o=(e,t,r="تقرير العمليات")=>{console.log("PDF export functionality - using HTML fallback for now");const n=s=>{const l=t.find(o=>o.id===s);return l?l.name:"عميل غير معروف"},a=`
    <div class="header">
      <h1>${r}</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <table>
      <thead>
        <tr>
          <th>كود العملية</th>
          <th>اسم العملية</th>
          <th>العميل</th>
          <th>القيمة الإجمالية</th>
          <th>المبلغ المحصل</th>
          <th>الحالة</th>
        </tr>
      </thead>
      <tbody>
        ${e.map(s=>`
          <tr>
            <td>${s.code}</td>
            <td>${s.name}</td>
            <td>${n(s.clientId)}</td>
            <td>${ne(s.totalAmount)}</td>
            <td>${ne(s.totalReceived)}</td>
            <td>${fu(s.status)}</td>
          </tr>
        `).join("")}
      </tbody>
    </table>
  `;cr(a,`${r.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`)},hT=(e,t="تقرير العملاء")=>{console.log("PDF export functionality - using HTML fallback for now");const r=a=>({owner:"مالك",main_contractor:"مقاول رئيسي",consultant:"استشاري"})[a]||a,n=`
    <div class="header">
      <h1>${t}</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <table>
      <thead>
        <tr>
          <th>اسم العميل</th>
          <th>نوع العميل</th>
          <th>رقم الهاتف</th>
          <th>البريد الإلكتروني</th>
        </tr>
      </thead>
      <tbody>
        ${e.map(a=>`
          <tr>
            <td>${a.name}</td>
            <td>${r(a.type)}</td>
            <td>${a.phone||"-"}</td>
            <td>${a.email||"-"}</td>
          </tr>
        `).join("")}
      </tbody>
    </table>
  `;cr(n,`${t.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`)},mT=(e,t)=>{console.log("PDF export functionality - using HTML fallback for now");const r=`
    <div class="header">
      <h1>التقرير المالي الشامل</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
    
    <div class="summary">
      <h3>الملخص المالي الإجمالي</h3>
      <p>إجمالي قيمة العمليات: ${ne(e.reduce((n,a)=>n+a.totalAmount,0))}</p>
      <p>إجمالي المحصل: ${ne(e.reduce((n,a)=>n+a.totalReceived,0))}</p>
    </div>
  `;cr(r,`التقرير_المالي_${new Date().toISOString().split("T")[0]}.pdf`)},Tv=(e,t)=>{console.log("PDF export functionality - using HTML fallback for now");const r=`
    <div class="header">
      <h1>تقرير الضمانات المفصل</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
  `;cr(r,`تقرير_الضمانات_المفصل_${new Date().toISOString().split("T")[0]}.pdf`)},kv=(e,t)=>{console.log("PDF export functionality - using HTML fallback for now");const r=`
    <div class="header">
      <h1>تقرير شهادات الضمان</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
  `;cr(r,`تقرير_شهادات_الضمان_${new Date().toISOString().split("T")[0]}.pdf`)},xT=(e,t)=>{console.log("PDF export functionality - using HTML fallback for now");const r=`
    <div class="header">
      <h1>تقرير الشيكات والمدفوعات</h1>
      <p>تاريخ التقرير: ${je(new Date)}</p>
    </div>
  `;cr(r,`تقرير_الشيكات_والمدفوعات_${new Date().toISOString().split("T")[0]}.pdf`)},pT=(e,t)=>{console.log("PDF export functionality - using HTML fallback for now");const r=`
    <div class="header">
      <h1>تفاصيل العملية: ${e.name}</h1>
      <p>كود العملية: ${e.code}</p>
      <p>العميل: ${t.name}</p>
    </div>
  `;cr(r,`تفاصيل_العملية_${e.code}_${new Date().toISOString().split("T")[0]}.pdf`)},gT=({operations:e,clients:t,onEdit:r,onDelete:n,onView:a})=>{const[s,l]=ye.useState(""),[o,c]=ye.useState("all"),[u,d]=ye.useState("all"),[f,h]=ye.useState(!1),[x,g]=ye.useState({clientId:"all",status:"all",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchTerm:""}),m=y=>{const O=t.find(B=>B.id===y);return O?O.name:"عميل غير معروف"},_=y=>({in_progress:"قيد التنفيذ",completed:"مكتملة",completed_partial_payment:"مكتملة - دفع جزئي",completed_full_payment:"مكتملة ومدفوعة بالكامل",completed_overpaid:"مكتملة - سداد بالزيادة"})[y],v=y=>({in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-gray-100 text-gray-800",completed_partial_payment:"bg-orange-100 text-orange-800",completed_full_payment:"bg-green-100 text-green-800",completed_overpaid:"bg-purple-100 text-purple-800"})[y],p=y=>{const O=!x.searchTerm||y.name.toLowerCase().includes(x.searchTerm.toLowerCase())||y.code.toLowerCase().includes(x.searchTerm.toLowerCase())||m(y.clientId).toLowerCase().includes(x.searchTerm.toLowerCase()),B=x.clientId==="all"||y.clientId===x.clientId,H=x.status==="all"||y.status===x.status;let Q=!0;if(x.startDate){const oe=new Date(x.startDate);Q=Q&&new Date(y.createdAt)>=oe}if(x.endDate){const oe=new Date(x.endDate);oe.setHours(23,59,59,999),Q=Q&&new Date(y.createdAt)<=oe}let ie=!0;if(x.minAmount){const oe=parseFloat(x.minAmount);ie=ie&&y.totalAmount>=oe}if(x.maxAmount){const oe=parseFloat(x.maxAmount);ie=ie&&y.totalAmount<=oe}return O&&B&&H&&Q&&ie},w=f?e.filter(p):e.filter(y=>{const O=y.name.toLowerCase().includes(s.toLowerCase())||y.code.toLowerCase().includes(s.toLowerCase())||m(y.clientId).toLowerCase().includes(s.toLowerCase()),B=o==="all"||y.status===o,H=u==="all"||y.clientId===u;return O&&B&&H}),T=()=>{g({clientId:"all",status:"all",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchTerm:""})},I=(y,O)=>{g(B=>({...B,[y]:O}))},L=()=>{try{$o(w,t,"تقرير العمليات")}catch(y){console.error("خطأ في تصدير PDF:",y),alert("حدث خطأ أثناء تصدير ملف PDF")}},j=()=>{try{us(w,t,"تقرير العمليات")}catch(y){console.error("خطأ في تصدير Excel:",y),alert("حدث خطأ أثناء تصدير ملف Excel")}},A=()=>{try{Uo(w,t,"تقرير العمليات")}catch(y){console.error("خطأ في تصدير Word:",y),alert("حدث خطأ أثناء تصدير ملف Word")}};return i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"استعراض العمليات"}),i.jsx("p",{className:"text-gray-600",children:"عرض وإدارة جميع العمليات المسجلة في النظام"})]}),i.jsxs("div",{className:"mb-6 flex gap-4",children:[i.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[i.jsx(Xa,{className:"w-4 h-4"}),"تصدير PDF"]}),i.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[i.jsx(Rl,{className:"w-4 h-4"}),"تصدير Excel"]}),i.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Zs,{className:"w-4 h-4"}),"تصدير Word"]})]}),!f&&i.jsx("div",{className:"mb-6 bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"البحث...",value:s,onChange:y=>l(y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("select",{value:o,onChange:y=>c(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الحالات"}),i.jsx("option",{value:"in_progress",children:"قيد التنفيذ"}),i.jsx("option",{value:"completed",children:"مكتملة"}),i.jsx("option",{value:"completed_partial_payment",children:"مكتملة - دفع جزئي"}),i.jsx("option",{value:"completed_full_payment",children:"مكتملة ومدفوعة بالكامل"}),i.jsx("option",{value:"completed_overpaid",children:"مكتملة - سداد بالزيادة"})]}),i.jsxs("select",{value:u,onChange:y=>d(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع العملاء"}),t.map(y=>i.jsx("option",{value:y.id,children:y.name},y.id))]}),i.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Gs,{className:"w-4 h-4"}),"فلاتر متقدمة"]})]})}),f&&i.jsxs("div",{className:"mb-6 bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(Gs,{className:"w-5 h-5"}),"الفلاتر المتقدمة"]}),i.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 p-1 rounded",children:i.jsx(la,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البحث في النص"}),i.jsxs("div",{className:"relative",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"اسم العملية، الكود، أو العميل...",value:x.searchTerm,onChange:y=>I("searchTerm",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل"}),i.jsxs("select",{value:x.clientId,onChange:y=>I("clientId",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع العملاء"}),t.map(y=>i.jsx("option",{value:y.id,children:y.name},y.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"حالة العملية"}),i.jsxs("select",{value:x.status,onChange:y=>I("status",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الحالات"}),i.jsx("option",{value:"in_progress",children:"قيد التنفيذ"}),i.jsx("option",{value:"completed",children:"مكتملة"}),i.jsx("option",{value:"completed_partial_payment",children:"مكتملة - دفع جزئي"}),i.jsx("option",{value:"completed_full_payment",children:"مكتملة ومدفوعة بالكامل"}),i.jsx("option",{value:"completed_overpaid",children:"مكتملة - سداد بالزيادة"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"من تاريخ"}),i.jsxs("div",{className:"relative",children:[i.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",value:x.startDate,onChange:y=>I("startDate",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إلى تاريخ"}),i.jsxs("div",{className:"relative",children:[i.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",value:x.endDate,onChange:y=>I("endDate",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحد الأدنى للمبلغ (ج.م)"}),i.jsxs("div",{className:"relative",children:[i.jsx(gr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"number",placeholder:"0",value:x.minAmount,onChange:y=>I("minAmount",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحد الأقصى للمبلغ (ج.م)"}),i.jsxs("div",{className:"relative",children:[i.jsx(gr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"number",placeholder:"∞",value:x.maxAmount,onChange:y=>I("maxAmount",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:T,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"مسح الفلاتر"}),i.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"إخفاء الفلاتر المتقدمة"})]}),i.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("span",{className:"font-semibold",children:w.length})," عملية من أصل ",e.length]})})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"كود العملية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"اسم العملية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"القيمة الإجمالية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الخصومات"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الصافي المستحق"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المبلغ المحصل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"إجمالي المسدد"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المتبقي"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نسبة الإنجاز"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإنشاء"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(y=>{const O=Dr(y),B=Ua(y),H=y.totalReceived+O,Q=y.totalAmount-H;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:y.code}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.name}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m(y.clientId)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ne(y.totalAmount)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:O>0?`- ${ne(O)}`:"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:ne(B)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:ne(y.totalReceived)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-indigo-600 font-medium",children:ne(H)}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-orange-600",children:[ne(Math.abs(Q)),Q<0&&i.jsx("span",{className:"text-purple-600 text-xs block",children:"(زيادة)"})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${y.overallExecutionPercentage}%`}})}),i.jsxs("span",{className:"text-xs font-medium",children:[y.overallExecutionPercentage.toFixed(1),"%"]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${v(y.status)}`,children:_(y.status)})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:je(y.createdAt)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>a(y),className:"text-blue-600 hover:text-blue-900",title:"عرض التفاصيل",children:i.jsx(Ks,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>r(y),className:"text-green-600 hover:text-green-900",title:"تعديل",children:i.jsx(Sf,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>n(y.id),className:"text-red-600 hover:text-red-900",title:"حذف",children:i.jsx(Mt,{className:"w-4 h-4"})})]})})]},y.id)})})]})}),w.length===0&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"لا توجد عمليات تطابق المعايير المحددة"})})]})]})},vT=({operation:e,client:t,onClose:r})=>{const n=pl(e.items),a=Dr(e),s=Ua(e),l=s-e.totalReceived,o=f=>({in_progress:"قيد التنفيذ",completed:"مكتملة",completed_partial_payment:"مكتملة - دفع جزئي",completed_full_payment:"مكتملة ومدفوعة بالكامل"})[f],c=f=>({in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-gray-100 text-gray-800",completed_partial_payment:"bg-orange-100 text-orange-800",completed_full_payment:"bg-green-100 text-green-800"})[f],u=()=>{try{pT(e,t)}catch(f){console.error("خطأ في تصدير PDF:",f),alert("حدث خطأ أثناء تصدير ملف PDF")}},d=()=>{try{fT(e,t)}catch(f){console.error("خطأ في تصدير Word:",f),alert("حدث خطأ أثناء تصدير ملف Word")}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e.name}),i.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[i.jsxs("p",{className:"text-gray-600",children:["كود العملية: ",e.code]}),i.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${c(e.status)}`,children:o(e.status)})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[i.jsx(Xa,{className:"w-4 h-4"}),"تصدير HTML"]}),i.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Zs,{className:"w-4 h-4"}),"تصدير Word"]}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100",children:i.jsx(la,{className:"w-6 h-6"})})]})]}),i.jsxs("div",{className:"p-6 space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Ug,{className:"w-8 h-8 text-blue-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"العميل"}),i.jsx("p",{className:"text-lg font-bold text-blue-900",children:t.name})]})]})}),i.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(gr,{className:"w-8 h-8 text-green-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-green-600 font-medium",children:"القيمة الإجمالية"}),i.jsx("p",{className:"text-lg font-bold text-green-900",children:ne(e.totalAmount)})]})]})}),i.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rr,{className:"w-8 h-8 text-yellow-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-yellow-600 font-medium",children:"المبلغ المنفذ"}),i.jsx("p",{className:"text-lg font-bold text-yellow-900",children:ne(n)})]})]})}),i.jsx("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(td,{className:"w-8 h-8 text-red-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-red-600 font-medium",children:"إجمالي الخصومات"}),i.jsx("p",{className:"text-lg font-bold text-red-900",children:ne(a)})]})]})}),i.jsx("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rr,{className:"w-8 h-8 text-purple-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"الصافي المستحق"}),i.jsx("p",{className:"text-lg font-bold text-purple-900",children:ne(s)})]})]})}),i.jsx("div",{className:"bg-indigo-50 p-4 rounded-lg border border-indigo-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(gr,{className:"w-8 h-8 text-indigo-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-indigo-600 font-medium",children:"المبلغ المحصل"}),i.jsx("p",{className:"text-lg font-bold text-indigo-900",children:ne(e.totalReceived)})]})]})}),i.jsx("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(He,{className:"w-8 h-8 text-orange-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"المبلغ المتبقي"}),i.jsx("p",{className:"text-lg font-bold text-orange-900",children:ne(l)})]})]})}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rr,{className:"w-8 h-8 text-gray-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"نسبة التحصيل"}),i.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[s>0?(e.totalReceived/s*100).toFixed(1):0,"%"]})]})]})})]}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"الملخص المالي"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"القيمة الإجمالية:"}),i.jsx("span",{className:"font-bold text-gray-900",children:ne(e.totalAmount)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"المبلغ المنفذ:"}),i.jsx("span",{className:"font-bold text-yellow-600",children:ne(n)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"إجمالي الخصومات:"}),i.jsxs("span",{className:"font-bold text-red-600",children:["- ",ne(a)]})]}),i.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-200",children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"الصافي المستحق:"}),i.jsx("span",{className:"font-bold text-purple-600",children:ne(s)})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"المبلغ المحصل:"}),i.jsx("span",{className:"font-bold text-green-600",children:ne(e.totalReceived)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"المبلغ المتبقي:"}),i.jsx("span",{className:"font-bold text-orange-600",children:ne(l)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"نسبة التحصيل:"}),i.jsxs("span",{className:"font-bold text-blue-600",children:[s>0?(e.totalReceived/s*100).toFixed(1):0,"%"]})]}),i.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-200",children:[i.jsx("span",{className:"text-gray-600 font-medium",children:"نسبة التنفيذ:"}),i.jsxs("span",{className:"font-bold text-indigo-600",children:[e.overallExecutionPercentage.toFixed(1),"%"]})]})]})]})]}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(nn,{className:"w-5 h-5"}),"بنود العملية"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الكود"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الوصف"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"القيمة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"نسبة التنفيذ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"القيمة المنفذة"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:e.items.map(f=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:f.code}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:f.description}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ne(f.amount)}),i.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[f.executionPercentage,"%"]}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ne(f.amount*(f.executionPercentage/100))})]},f.id))})]})})]}),e.deductions.length>0&&i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(td,{className:"w-5 h-5"}),"الخصومات"]})}),i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.deductions.filter(f=>f.isActive).map(f=>{const h=pl(e.items),x=f.type==="percentage"?h*f.value/100:f.value;return i.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg border border-red-200",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-900",children:f.name}),i.jsx("div",{className:"text-xs text-gray-500",children:f.type==="percentage"?`${f.value}%`:"مبلغ ثابت"})]}),i.jsxs("span",{className:"text-sm font-bold text-red-600",children:["- ",ne(x)]})]},f.id)})}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium text-gray-900",children:"إجمالي الخصومات:"}),i.jsxs("span",{className:"font-bold text-red-600",children:["- ",ne(a)]})]})})]})]}),e.guaranteeChecks.length>0&&i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(ml,{className:"w-5 h-5"}),"شيكات الضمان"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"رقم الشيك"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المبلغ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"البنك"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"تاريخ الانتهاء"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الحالة"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:e.guaranteeChecks.map(f=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:f.checkNumber}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ne(f.amount)}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:f.bank}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:je(f.expiryDate)}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.isReturned?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.isReturned?"مُسترد":"قائم"})})]},f.id))})]})})]}),e.guaranteeLetters.length>0&&i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(nn,{className:"w-5 h-5"}),"خطابات الضمان"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"رقم الخطاب"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"البنك"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المبلغ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"تاريخ الاستحقاق"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الحالة"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:e.guaranteeLetters.map(f=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:f.letterNumber}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:f.bank}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ne(f.amount)}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:je(f.dueDate)}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.isReturned?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.isReturned?"مُسترد":"قائم"})})]},f.id))})]})})]}),(e.warrantyCertificates||[]).length>0&&i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(rr,{className:"w-5 h-5"}),"شهادات الضمان"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"رقم الشهادة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الوصف"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"تاريخ البداية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"تاريخ النهاية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الحالة"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:e.warrantyCertificates.map(f=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:f.certificateNumber}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:f.description}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:je(f.startDate)}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:je(f.endDate)}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:f.isActive?"نشط":"منتهي"})})]},f.id))})]})})]}),e.receivedPayments.length>0&&i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(gr,{className:"w-5 h-5"}),"المدفوعات المستلمة"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"النوع"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المبلغ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"التاريخ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"التفاصيل"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:e.receivedPayments.map(f=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:f.type==="cash"?"نقدي":"شيك"}),i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:ne(f.amount)}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:je(f.date)}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:f.type==="check"&&f.checkNumber?`شيك رقم: ${f.checkNumber} - ${f.bank}`:f.notes||"-"})]},f.id))})]})})]})]})]})})},yT=({operation:e,clients:t,onSave:r,onCancel:n})=>{const[a,s]=ye.useState({clientId:e.clientId,name:e.name,code:e.code}),[l,o]=ye.useState([]),[c,u]=ye.useState([]),[d,f]=ye.useState([]),[h,x]=ye.useState([]),[g,m]=ye.useState([]),[_,v]=ye.useState("basic");ye.useEffect(()=>{o(e.items.map(N=>({...N,addedAt:N.addedAt instanceof Date?N.addedAt:new Date(N.addedAt),contractDate:N.contractDate?N.contractDate instanceof Date?N.contractDate:new Date(N.contractDate):void 0}))),u(e.deductions||[]),f(e.guaranteeChecks.map(N=>({...N,checkDate:N.checkDate instanceof Date?N.checkDate:new Date(N.checkDate),deliveryDate:N.deliveryDate instanceof Date?N.deliveryDate:new Date(N.deliveryDate),expiryDate:N.expiryDate instanceof Date?N.expiryDate:new Date(N.expiryDate),returnDate:N.returnDate?N.returnDate instanceof Date?N.returnDate:new Date(N.returnDate):void 0}))),x(e.guaranteeLetters.map(N=>({...N,letterDate:N.letterDate instanceof Date?N.letterDate:new Date(N.letterDate),dueDate:N.dueDate instanceof Date?N.dueDate:new Date(N.dueDate),returnDate:N.returnDate?N.returnDate instanceof Date?N.returnDate:new Date(N.returnDate):void 0}))),m(e.receivedPayments.map(N=>({...N,date:N.date instanceof Date?N.date:new Date(N.date),receiptDate:N.receiptDate?N.receiptDate instanceof Date?N.receiptDate:new Date(N.receiptDate):void 0})))},[e]);const p=()=>{const N={id:crypto.randomUUID(),code:Es(a.code,l.length),description:"",amount:0,executionPercentage:0,addedAt:new Date};o([...l,N])},w=(N,D,b)=>{const S=[...l];S[N]={...S[N],[D]:b},o(S)},T=N=>{if(l.length>1){const b=l.filter((S,W)=>W!==N).map((S,W)=>({...S,code:Es(a.code,W)}));o(b)}},I=(N,D,b)=>{const S=[...c];S[N]={...S[N],[D]:b},u(S)},L=()=>{const N={id:crypto.randomUUID(),name:"",type:"percentage",value:0,isActive:!0};u([...c,N])},j=N=>{u(c.filter((D,b)=>b!==N))},A=()=>{const N=new Date,D=new Date(N);D.setFullYear(D.getFullYear()+1);const b={id:crypto.randomUUID(),checkNumber:"",amount:0,checkDate:N,deliveryDate:N,expiryDate:D,bank:"",isReturned:!1,relatedTo:"operation"};f([...d,b])},y=(N,D,b)=>{const S=[...d];S[N]={...S[N],[D]:b},f(S)},O=N=>{f(d.filter((D,b)=>b!==N))},B=()=>{const N=new Date,D=new Date(N);D.setFullYear(D.getFullYear()+1);const b={id:crypto.randomUUID(),bank:"",letterDate:N,letterNumber:"",amount:0,dueDate:D,renewals:[],relatedTo:"operation",isReturned:!1};x([...h,b])},H=(N,D,b)=>{const S=[...h];S[N]={...S[N],[D]:b},x(S)},Q=N=>{x(h.filter((D,b)=>b!==N))},ie=()=>{const N={id:crypto.randomUUID(),type:"cash",amount:0,date:new Date};m([...g,N])},oe=(N,D,b)=>{const S=[...g];S[N]={...S[N],[D]:b},m(S)},we=N=>{m(g.filter((D,b)=>b!==N))},z=N=>{if(N.preventDefault(),!a.clientId||!a.name){alert("يرجى إدخال اسم العميل واسم العملية");return}if(l.some(U=>!U.description||U.amount<=0)){alert("يرجى إدخال وصف وقيمة صحيحة لجميع البنود");return}const D=xl(l),b=zg(l),S=g.reduce((U,J)=>U+J.amount,0),W=Tf({...e,items:l,deductions:c,overallExecutionPercentage:b,totalReceived:S}),M={...e,code:a.code,name:a.name,clientId:a.clientId,items:l,deductions:c,guaranteeChecks:d,guaranteeLetters:h,receivedPayments:g,totalAmount:D,totalReceived:S,overallExecutionPercentage:b,status:W,updatedAt:new Date};r(M)},K=[{id:"basic",label:"البيانات الأساسية",icon:nn},{id:"items",label:"بنود العملية",icon:Tt},{id:"deductions",label:"الخصومات",icon:Mt},{id:"guarantees",label:"الضمانات",icon:ml},{id:"payments",label:"المدفوعات",icon:Vr}];return i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"تعديل العملية"}),i.jsxs("p",{className:"text-gray-600",children:["تعديل بيانات العملية: ",e.name]}),i.jsx("div",{className:"mt-2 text-sm text-blue-600",children:"ملاحظة: يمكن تعديل العملية في أي وقت حتى بعد اكتمالها لإضافة شهادات ضمان أو ملاحق جديدة"})]}),i.jsx("div",{className:"mb-8 bg-white rounded-lg border border-gray-200 p-1",children:i.jsx("nav",{className:"flex flex-wrap gap-1",children:K.map(N=>{const D=N.icon;return i.jsxs("button",{onClick:()=>v(N.id),className:`flex items-center gap-2 px-4 py-3 rounded-md font-medium text-sm transition-all ${_===N.id?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[i.jsx(D,{className:"w-4 h-4"}),N.label]},N.id)})})}),i.jsxs("form",{onSubmit:z,className:"space-y-8",children:[_==="basic"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"البيانات الأساسية"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل *"}),i.jsxs("select",{value:a.clientId,onChange:N=>s({...a,clientId:N.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[i.jsx("option",{value:"",children:"اختر العميل"}),t.map(N=>i.jsx("option",{value:N.id,children:N.name},N.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم العملية *"}),i.jsx("input",{type:"text",value:a.name,onChange:N=>s({...a,name:N.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسم العملية",required:!0})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كود العملية"}),i.jsx("input",{type:"text",value:a.code,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-600",readOnly:!0})]})]})]}),_==="items"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"بنود العملية"}),i.jsxs("button",{type:"button",onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة بند"]})]}),i.jsx("div",{className:"space-y-6",children:l.map((N,D)=>i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-gray-700",children:["البند ",D+1]}),l.length>1&&i.jsx("button",{type:"button",onClick:()=>T(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكود"}),i.jsx("input",{type:"text",value:N.code,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-600",readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الوصف *"}),i.jsx("input",{type:"text",value:N.description,onChange:b=>w(D,"description",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"وصف البند",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"القيمة (ج.م) *"}),i.jsx("input",{type:"number",value:N.amount,onChange:b=>w(D,"amount",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نسبة التنفيذ (%)"}),i.jsx("input",{type:"number",value:N.executionPercentage,onChange:b=>w(D,"executionPercentage",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.1",placeholder:"0.0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم العقد"}),i.jsx("input",{type:"text",value:N.contractNumber||"",onChange:b=>w(D,"contractNumber",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"رقم العقد"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ العقد"}),i.jsx("input",{type:"date",value:N.contractDate?N.contractDate.toISOString().split("T")[0]:"",onChange:b=>w(D,"contractDate",b.target.value?new Date(b.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]},N.id))}),i.jsx("div",{className:"mt-6 p-6 bg-blue-50 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex justify-between items-center text-lg",children:[i.jsx("span",{className:"font-medium text-blue-900",children:"إجمالي العملية:"}),i.jsx("span",{className:"font-bold text-blue-900",children:ne(xl(l))})]})})]}),_==="deductions"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"الخصومات"}),i.jsxs("button",{type:"button",onClick:L,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة خصم"]})]}),i.jsx("div",{className:"space-y-4",children:c.map((N,D)=>i.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم الخصم"}),i.jsx("input",{type:"text",value:N.name,onChange:b=>I(D,"name",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"اسم الخصم"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"النوع"}),i.jsxs("select",{value:N.type,onChange:b=>I(D,"type",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"percentage",children:"نسبة مئوية"}),i.jsx("option",{value:"fixed",children:"مبلغ ثابت"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["القيمة ",N.type==="percentage"?"(%)":"(ج.م)"]}),i.jsx("input",{type:"number",value:N.value,onChange:b=>I(D,"value",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:N.isActive,onChange:b=>I(D,"isActive",b.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("span",{className:"text-sm text-gray-700",children:"فعال"})]}),i.jsx("button",{type:"button",onClick:()=>j(D),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]})]})},N.id))}),c.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد خصومات مضافة. يمكنك إضافة خصومات حسب الحاجة."})]}),_==="guarantees"&&i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"شيكات الضمان"}),i.jsxs("button",{type:"button",onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة شيك ضمان"]})]}),i.jsx("div",{className:"space-y-6",children:d.map((N,D)=>i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-purple-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-purple-900",children:["شيك الضمان ",D+1]}),i.jsx("button",{type:"button",onClick:()=>O(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الشيك"}),i.jsx("input",{type:"text",value:N.checkNumber,onChange:b=>y(D,"checkNumber",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"رقم الشيك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ج.م)"}),i.jsx("input",{type:"number",value:N.amount,onChange:b=>y(D,"amount",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),i.jsx("input",{type:"text",value:N.bank,onChange:b=>y(D,"bank",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"اسم البنك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الشيك"}),i.jsx("input",{type:"date",value:N.checkDate.toISOString().split("T")[0],onChange:b=>y(D,"checkDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ التسليم"}),i.jsx("input",{type:"date",value:N.deliveryDate.toISOString().split("T")[0],onChange:b=>y(D,"deliveryDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ انتهاء الصلاحية"}),i.jsx("input",{type:"date",value:N.expiryDate.toISOString().split("T")[0],onChange:b=>y(D,"expiryDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),i.jsx("div",{className:"flex items-center",children:i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:N.isReturned,onChange:b=>y(D,"isReturned",b.target.checked),className:"mr-2 h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),i.jsx("span",{className:"text-sm text-gray-700",children:"تم الاسترداد"})]})}),N.isReturned&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاسترداد"}),i.jsx("input",{type:"date",value:N.returnDate?N.returnDate.toISOString().split("T")[0]:"",onChange:b=>y(D,"returnDate",b.target.value?new Date(b.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]},N.id))}),d.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد شيكات ضمان مضافة. يمكنك إضافة شيكات ضمان حسب الحاجة."})]}),i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"خطابات الضمان"}),i.jsxs("button",{type:"button",onClick:B,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة خطاب ضمان"]})]}),i.jsx("div",{className:"space-y-6",children:h.map((N,D)=>i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-indigo-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-indigo-900",children:["خطاب الضمان ",D+1]}),i.jsx("button",{type:"button",onClick:()=>Q(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),i.jsx("input",{type:"text",value:N.bank,onChange:b=>H(D,"bank",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"اسم البنك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الخطاب"}),i.jsx("input",{type:"text",value:N.letterNumber,onChange:b=>H(D,"letterNumber",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"رقم الخطاب"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ج.م)"}),i.jsx("input",{type:"number",value:N.amount,onChange:b=>H(D,"amount",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الخطاب"}),i.jsx("input",{type:"date",value:N.letterDate.toISOString().split("T")[0],onChange:b=>H(D,"letterDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستحقاق"}),i.jsx("input",{type:"date",value:N.dueDate.toISOString().split("T")[0],onChange:b=>H(D,"dueDate",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مرتبط بـ"}),i.jsxs("select",{value:N.relatedTo,onChange:b=>H(D,"relatedTo",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[i.jsx("option",{value:"operation",children:"العملية كاملة"}),i.jsx("option",{value:"item",children:"بند محدد"})]})]}),i.jsx("div",{className:"flex items-center",children:i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:N.isReturned,onChange:b=>H(D,"isReturned",b.target.checked),className:"mr-2 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),i.jsx("span",{className:"text-sm text-gray-700",children:"تم الاسترداد"})]})}),N.isReturned&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاسترداد"}),i.jsx("input",{type:"date",value:N.returnDate?N.returnDate.toISOString().split("T")[0]:"",onChange:b=>H(D,"returnDate",b.target.value?new Date(b.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات"}),i.jsx("input",{type:"text",value:N.notes||"",onChange:b=>H(D,"notes",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"ملاحظات إضافية"})]})]})]},N.id))}),h.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد خطابات ضمان مضافة. يمكنك إضافة خطابات ضمان حسب الحاجة."})]})]}),_==="payments"&&i.jsxs("div",{className:"bg-white p-8 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"المدفوعات المستلمة"}),i.jsxs("button",{type:"button",onClick:ie,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة دفعة"]})]}),i.jsx("div",{className:"space-y-6",children:g.map((N,D)=>i.jsxs("div",{className:"p-6 border border-gray-200 rounded-lg bg-green-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("span",{className:"text-lg font-medium text-green-900",children:["الدفعة ",D+1]}),i.jsx("button",{type:"button",onClick:()=>we(D),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الدفع"}),i.jsxs("select",{value:N.type,onChange:b=>oe(D,"type",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[i.jsx("option",{value:"cash",children:"نقدي"}),i.jsx("option",{value:"check",children:"شيك"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ج.م)"}),i.jsx("input",{type:"number",value:N.amount,onChange:b=>oe(D,"amount",parseFloat(b.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التاريخ"}),i.jsx("input",{type:"date",value:N.date.toISOString().split("T")[0],onChange:b=>oe(D,"date",new Date(b.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),N.type==="check"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الشيك"}),i.jsx("input",{type:"text",value:N.checkNumber||"",onChange:b=>oe(D,"checkNumber",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"رقم الشيك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),i.jsx("input",{type:"text",value:N.bank||"",onChange:b=>oe(D,"bank",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"اسم البنك"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستلام"}),i.jsx("input",{type:"date",value:N.receiptDate?N.receiptDate.toISOString().split("T")[0]:"",onChange:b=>oe(D,"receiptDate",b.target.value?new Date(b.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات"}),i.jsx("input",{type:"text",value:N.notes||"",onChange:b=>oe(D,"notes",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"ملاحظات إضافية"})]})]})]},N.id))}),g.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"لا توجد مدفوعات مضافة. يمكنك إضافة المدفوعات المستلمة حسب الحاجة."}),g.length>0&&i.jsx("div",{className:"mt-6 p-6 bg-green-100 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex justify-between items-center text-lg",children:[i.jsx("span",{className:"font-medium text-green-900",children:"إجمالي المدفوعات المستلمة:"}),i.jsx("span",{className:"font-bold text-green-900",children:ne(g.reduce((N,D)=>N+D.amount,0))})]})})]}),i.jsxs("div",{className:"flex gap-4 pt-8 border-t border-gray-200 bg-white p-6 rounded-lg",children:[i.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[i.jsx(Bg,{className:"w-5 h-5"}),"حفظ التعديلات"]}),i.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-2 px-8 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors font-medium",children:[i.jsx(la,{className:"w-5 h-5"}),"إلغاء"]})]})]})]})},wT=({clients:e,onAddClient:t,onUpdateClient:r,onDeleteClient:n})=>{const[a,s]=ye.useState(""),[l,o]=ye.useState(!1),[c,u]=ye.useState(null),[d,f]=ye.useState("basic"),[h,x]=ye.useState({name:"",type:"owner",phone:"",email:"",address:""}),[g,m]=ye.useState([]),_=e.filter(y=>y.name.toLowerCase().includes(a.toLowerCase())||y.phone&&y.phone.includes(a)||y.email&&y.email.toLowerCase().includes(a.toLowerCase())),v=()=>{x({name:"",type:"owner",phone:"",email:"",address:""}),m([]),o(!1),u(null),f("basic")},p=()=>{const y={id:crypto.randomUUID(),name:"",position:"",department:"management",phone:"",email:"",isMainContact:g.length===0};m([...g,y])},w=(y,O,B)=>{const H=[...g];H[y]={...H[y],[O]:B},O==="isMainContact"&&B===!0&&H.forEach((Q,ie)=>{ie!==y&&(Q.isMainContact=!1)}),m(H)},T=y=>{const O=g.filter((B,H)=>H!==y);g[y].isMainContact&&O.length>0&&(O[0].isMainContact=!0),m(O)},I=y=>{if(y.preventDefault(),c){const O={...c,...h,contacts:g,updatedAt:new Date};r(c.id,O)}else{const O={id:crypto.randomUUID(),...h,contacts:g,createdAt:new Date,updatedAt:new Date};t(O)}v()},L=y=>{u(y),x({name:y.name,type:y.type,phone:y.phone||"",email:y.email||"",address:y.address||""}),m(y.contacts||[]),o(!0)},j=y=>({owner:"مالك",main_contractor:"مقاول رئيسي",consultant:"استشاري"})[y]||y,A=y=>({accounts:"الحسابات",engineering:"الهندسة",management:"الإدارة",other:"أخرى"})[y]||y;return i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"إدارة العملاء"}),i.jsx("p",{className:"text-gray-600",children:"إدارة قاعدة بيانات العملاء وجهات الاتصال"})]}),i.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 justify-between",children:[i.jsxs("div",{className:"relative flex-1 max-w-md",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"البحث عن عميل...",value:a,onChange:y=>s(y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة عميل جديد"]})]}),l&&i.jsxs("div",{className:"mb-6 bg-white p-6 rounded-lg border border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:c?"تعديل العميل":"إضافة عميل جديد"}),i.jsx("div",{className:"mb-6 border-b border-gray-200",children:i.jsxs("nav",{className:"flex gap-8",children:[i.jsx("button",{onClick:()=>f("basic"),className:`py-2 px-1 border-b-2 font-medium text-sm ${d==="basic"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"البيانات الأساسية"}),i.jsxs("button",{onClick:()=>f("contacts"),className:`py-2 px-1 border-b-2 font-medium text-sm ${d==="contacts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["جهات الاتصال (",g.length,")"]})]})}),i.jsxs("form",{onSubmit:I,className:"space-y-6",children:[d==="basic"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم العميل *"}),i.jsx("input",{type:"text",value:h.name,onChange:y=>x({...h,name:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع العميل *"}),i.jsxs("select",{value:h.type,onChange:y=>x({...h,type:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"owner",children:"مالك"}),i.jsx("option",{value:"main_contractor",children:"مقاول رئيسي"}),i.jsx("option",{value:"consultant",children:"استشاري"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),i.jsx("input",{type:"tel",value:h.phone,onChange:y=>x({...h,phone:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني"}),i.jsx("input",{type:"email",value:h.email,onChange:y=>x({...h,email:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العنوان"}),i.jsx("input",{type:"text",value:h.address,onChange:y=>x({...h,address:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),d==="contacts"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"text-md font-medium text-gray-900",children:"جهات الاتصال"}),i.jsxs("button",{type:"button",onClick:p,className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة جهة اتصال"]})]}),g.map((y,O)=>i.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h5",{className:"font-medium text-gray-900",children:["جهة الاتصال ",O+1]}),i.jsx("button",{type:"button",onClick:()=>T(O),className:"text-red-600 hover:text-red-800",children:i.jsx(Mt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الاسم *"}),i.jsx("input",{type:"text",value:y.name,onChange:B=>w(O,"name",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المنصب"}),i.jsx("input",{type:"text",value:y.position,onChange:B=>w(O,"position",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"القسم"}),i.jsxs("select",{value:y.department,onChange:B=>w(O,"department",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"management",children:"الإدارة"}),i.jsx("option",{value:"accounts",children:"الحسابات"}),i.jsx("option",{value:"engineering",children:"الهندسة"}),i.jsx("option",{value:"other",children:"أخرى"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الهاتف"}),i.jsx("input",{type:"tel",value:y.phone,onChange:B=>w(O,"phone",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"البريد الإلكتروني"}),i.jsx("input",{type:"email",value:y.email,onChange:B=>w(O,"email",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex items-center",children:i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:y.isMainContact,onChange:B=>w(O,"isMainContact",B.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("span",{className:"text-sm text-gray-700",children:"جهة الاتصال الرئيسية"})]})})]})]},y.id)),g.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:'لا توجد جهات اتصال مضافة. اضغط "إضافة جهة اتصال" لإضافة جهة اتصال جديدة.'})]}),i.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:c?"تحديث":"إضافة"}),i.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"إلغاء"})]})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map(y=>{var B,H;const O=(B=y.contacts)==null?void 0:B.find(Q=>Q.isMainContact);return i.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y.name}),i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:j(y.type)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>L(y),className:"text-blue-600 hover:text-blue-800",title:"تعديل",children:i.jsx(Sf,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>n(y.id),className:"text-red-600 hover:text-red-800",title:"حذف",children:i.jsx(Mt,{className:"w-4 h-4"})})]})]}),i.jsxs("div",{className:"space-y-2",children:[y.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(a_,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm",children:y.phone})]}),y.email&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(r_,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm",children:y.email})]}),y.address&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(n_,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm",children:y.address})]})]}),O&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 text-gray-700 mb-2",children:[i.jsx(Ug,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:"جهة الاتصال الرئيسية:"})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("div",{className:"font-medium",children:O.name}),O.position&&i.jsxs("div",{className:"text-xs",children:[O.position," - ",A(O.department)]}),O.phone&&i.jsx("div",{className:"text-xs",children:O.phone})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(Jw,{className:"w-4 h-4"}),i.jsxs("span",{className:"text-sm",children:["جهات الاتصال: ",((H=y.contacts)==null?void 0:H.length)||0]})]}),i.jsxs("p",{className:"text-xs text-gray-500",children:["تم الإنشاء: ",new Date(y.createdAt).toLocaleDateString("ar-EG")]})]})})]},y.id)})}),_.length===0&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:a?"لا توجد عملاء تطابق البحث":"لا توجد عملاء مسجلين"})})]})},_T=({operations:e,clients:t})=>{const[r,n]=ye.useState("checks"),[a,s]=ye.useState(""),[l,o]=ye.useState("all"),[c,u]=ye.useState(!1),[d,f]=ye.useState(null),[h,x]=ye.useState({clientId:"all",operationId:"all",status:"all",type:"all",startDate:"",endDate:"",minAmount:"",maxAmount:"",bank:""}),g=b=>{const S=t.find(W=>W.id===b);return S?S.name:"عميل غير معروف"},m=(b,S)=>{const W=e.find(U=>U.id===b);if(!W)return"بند غير معروف";const M=W.items.find(U=>U.id===S);return M?M.description:"بند غير معروف"},_=e.flatMap(b=>b.guaranteeChecks.map(S=>({...S,checkDate:S.checkDate instanceof Date?S.checkDate:new Date(S.checkDate),deliveryDate:S.deliveryDate instanceof Date?S.deliveryDate:new Date(S.deliveryDate),expiryDate:S.expiryDate instanceof Date?S.expiryDate:new Date(S.expiryDate),returnDate:S.returnDate?S.returnDate instanceof Date?S.returnDate:new Date(S.returnDate):void 0,operationId:b.id,operationName:b.name,operationCode:b.code,clientId:b.clientId,clientName:g(b.clientId),type:"شيك ضمان"}))),v=e.flatMap(b=>b.guaranteeLetters.map(S=>({...S,letterDate:S.letterDate instanceof Date?S.letterDate:new Date(S.letterDate),dueDate:S.dueDate instanceof Date?S.dueDate:new Date(S.dueDate),returnDate:S.returnDate?S.returnDate instanceof Date?S.returnDate:new Date(S.returnDate):void 0,operationId:b.id,operationName:b.name,operationCode:b.code,clientId:b.clientId,clientName:g(b.clientId),type:"خطاب ضمان"}))),p=b=>{const S=new Date,W=b.getTime()-S.getTime(),M=Math.ceil(W/(1e3*60*60*24));return M<=30&&M>0},w=b=>b<new Date,T=b=>b.filter(S=>{const W=!h.bank||(S.bank||"").toLowerCase().includes(h.bank.toLowerCase())||S.clientName.toLowerCase().includes(h.bank.toLowerCase())||S.operationName.toLowerCase().includes(h.bank.toLowerCase())||(S.checkNumber||S.letterNumber||"").toLowerCase().includes(h.bank.toLowerCase()),M=h.clientId==="all"||S.clientId===h.clientId,U=h.operationId==="all"||S.operationId===h.operationId,J=h.status==="all"||h.status==="active"&&!S.isReturned||h.status==="returned"&&S.isReturned;let ce=!0;if(h.startDate){const he=new Date(h.startDate),de=r==="checks"?S.checkDate:S.letterDate;ce=ce&&new Date(de)>=he}if(h.endDate){const he=new Date(h.endDate);he.setHours(23,59,59,999);const de=r==="checks"?S.checkDate:S.letterDate;ce=ce&&new Date(de)<=he}let pe=!0;if(h.minAmount){const he=parseFloat(h.minAmount);pe=pe&&S.amount>=he}if(h.maxAmount){const he=parseFloat(h.maxAmount);pe=pe&&S.amount<=he}return W&&M&&U&&J&&ce&&pe}),I=c?T(_):_.filter(b=>{const S=(b.checkNumber||"").toLowerCase().includes(a.toLowerCase())||(b.bank||"").toLowerCase().includes(a.toLowerCase())||b.clientName.toLowerCase().includes(a.toLowerCase())||b.operationName.toLowerCase().includes(a.toLowerCase()),W=l==="all"||l==="active"&&!b.isReturned&&!w(b.expiryDate)||l==="returned"&&b.isReturned||l==="expiring"&&!b.isReturned&&p(b.expiryDate)||l==="expired"&&!b.isReturned&&w(b.expiryDate);return S&&W}),L=c?T(v):v.filter(b=>{const S=(b.letterNumber||"").toLowerCase().includes(a.toLowerCase())||(b.bank||"").toLowerCase().includes(a.toLowerCase())||b.clientName.toLowerCase().includes(a.toLowerCase())||b.operationName.toLowerCase().includes(a.toLowerCase()),W=l==="all"||l==="active"&&!b.isReturned&&!w(b.dueDate)||l==="returned"&&b.isReturned||l==="expiring"&&!b.isReturned&&p(b.dueDate)||l==="expired"&&!b.isReturned&&w(b.dueDate);return S&&W}),j=()=>{x({clientId:"all",operationId:"all",status:"all",type:"all",startDate:"",endDate:"",minAmount:"",maxAmount:"",bank:""})},A=(b,S)=>{x(W=>({...W,[b]:S}))},y=b=>{f(b)},O=()=>{try{Tv(e,t)}catch(b){console.error("خطأ في تصدير PDF:",b),alert("حدث خطأ أثناء تصدير ملف PDF")}},B=()=>{try{iT(e,t)}catch(b){console.error("خطأ في تصدير Excel:",b),alert("حدث خطأ أثناء تصدير ملف Excel")}},H=()=>{try{jv(e,t)}catch(b){console.error("خطأ في تصدير Word:",b),alert("حدث خطأ أثناء تصدير ملف Word")}},Q=_.length,ie=v.length,oe=_.filter(b=>!b.isReturned&&!w(b.expiryDate)).length,we=v.filter(b=>!b.isReturned&&!w(b.dueDate)).length,z=_.filter(b=>!b.isReturned&&p(b.expiryDate)).length,K=v.filter(b=>!b.isReturned&&p(b.dueDate)).length,N=_.filter(b=>!b.isReturned&&w(b.expiryDate)).length,D=v.filter(b=>!b.isReturned&&w(b.dueDate)).length;return i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"إدارة الضمانات"}),i.jsx("p",{className:"text-gray-600",children:"متابعة وإدارة شيكات وخطابات الضمان مع تنبيهات الحالة"})]}),(z+K>0||N+D>0)&&i.jsxs("div",{className:"mb-6 space-y-3",children:[z+K>0&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(He,{className:"w-5 h-5 text-yellow-600"}),i.jsxs("span",{className:"text-yellow-800 font-medium",children:["تنبيه: يوجد ",z+K," ضمان ينتهي خلال 30 يوماً (",z," شيك ضمان، ",K," خطاب ضمان)"]})]})}),N+D>0&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(He,{className:"w-5 h-5 text-red-600"}),i.jsxs("span",{className:"text-red-800 font-medium",children:["تحذير: يوجد ",N+D," ضمان منتهي الصلاحية (",N," شيك ضمان، ",D," خطاب ضمان)"]})]})})]}),i.jsx("div",{className:"mb-6 bg-white rounded-lg border border-gray-200 p-1",children:i.jsxs("nav",{className:"flex gap-1",children:[i.jsxs("button",{onClick:()=>n("checks"),className:`flex items-center gap-2 px-6 py-3 rounded-md font-medium text-sm transition-all ${r==="checks"?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[i.jsx(ml,{className:"w-4 h-4"}),"شيكات الضمان (",Q,")",z>0&&i.jsx("span",{className:"bg-yellow-500 text-white text-xs px-2 py-1 rounded-full",children:z}),N>0&&i.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:N})]}),i.jsxs("button",{onClick:()=>n("letters"),className:`flex items-center gap-2 px-6 py-3 rounded-md font-medium text-sm transition-all ${r==="letters"?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[i.jsx(nn,{className:"w-4 h-4"}),"خطابات الضمان (",ie,")",K>0&&i.jsx("span",{className:"bg-yellow-500 text-white text-xs px-2 py-1 rounded-full",children:K}),D>0&&i.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:D})]})]})}),i.jsxs("div",{className:"mb-6 flex gap-4",children:[i.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[i.jsx(Xa,{className:"w-4 h-4"}),"تصدير PDF"]}),i.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[i.jsx(Rl,{className:"w-4 h-4"}),"تصدير Excel"]}),i.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Zs,{className:"w-4 h-4"}),"تصدير Word"]})]}),!c&&i.jsx("div",{className:"mb-6 bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"البحث...",value:a,onChange:b=>s(b.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("select",{value:l,onChange:b=>o(b.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الضمانات"}),i.jsx("option",{value:"active",children:"الضمانات النشطة"}),i.jsx("option",{value:"expiring",children:"تنتهي قريباً (30 يوم)"}),i.jsx("option",{value:"expired",children:"منتهية الصلاحية"}),i.jsx("option",{value:"returned",children:"الضمانات المستردة"})]}),i.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Gs,{className:"w-4 h-4"}),"فلاتر متقدمة"]})]})}),c&&i.jsxs("div",{className:"mb-6 bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(Gs,{className:"w-5 h-5"}),"الفلاتر المتقدمة"]}),i.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600 p-1 rounded",children:i.jsx(la,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البحث في البنك أو العميل"}),i.jsxs("div",{className:"relative",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"اسم البنك، العميل، أو العملية...",value:h.bank,onChange:b=>A("bank",b.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل"}),i.jsxs("select",{value:h.clientId,onChange:b=>A("clientId",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع العملاء"}),t.map(b=>i.jsx("option",{value:b.id,children:b.name},b.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العملية"}),i.jsxs("select",{value:h.operationId,onChange:b=>A("operationId",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع العمليات"}),e.map(b=>i.jsx("option",{value:b.id,children:b.name},b.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"حالة الضمان"}),i.jsxs("select",{value:h.status,onChange:b=>A("status",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الحالات"}),i.jsx("option",{value:"active",children:"نشطة"}),i.jsx("option",{value:"returned",children:"مستردة"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"من تاريخ"}),i.jsxs("div",{className:"relative",children:[i.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",value:h.startDate,onChange:b=>A("startDate",b.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إلى تاريخ"}),i.jsxs("div",{className:"relative",children:[i.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",value:h.endDate,onChange:b=>A("endDate",b.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحد الأدنى للمبلغ (ج.م)"}),i.jsx("input",{type:"number",placeholder:"0",value:h.minAmount,onChange:b=>A("minAmount",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحد الأقصى للمبلغ (ج.م)"}),i.jsx("input",{type:"number",placeholder:"∞",value:h.maxAmount,onChange:b=>A("maxAmount",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:j,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"مسح الفلاتر"}),i.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"إخفاء الفلاتر المتقدمة"})]}),i.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("span",{className:"font-semibold",children:r==="checks"?I.length:L.length})," ضمان من أصل ",r==="checks"?_.length:v.length]})})]}),d&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-center",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["تفاصيل ",d.type]}),i.jsx("button",{onClick:()=>f(null),className:"text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100",children:i.jsx(la,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"معلومات الضمان"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-blue-600 font-medium",children:d.type==="شيك ضمان"?"رقم الشيك:":"رقم الخطاب:"}),i.jsx("p",{className:"text-blue-900",children:d.checkNumber||d.letterNumber})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"المبلغ:"}),i.jsx("p",{className:"text-blue-900",children:ne(d.amount)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"البنك:"}),i.jsx("p",{className:"text-blue-900",children:d.bank})]})]})]}),i.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"معلومات العملية"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-green-600 font-medium",children:"العميل:"}),i.jsx("p",{className:"text-green-900",children:d.clientName})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-green-600 font-medium",children:"العملية:"}),i.jsx("p",{className:"text-green-900",children:d.operationName})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-green-600 font-medium",children:"مرتبط بـ:"}),i.jsx("p",{className:"text-green-900",children:d.relatedTo==="operation"?"العملية كاملة":`البند: ${m(d.operationId,d.relatedItemId||"")}`})]})]})]}),i.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-purple-900 mb-3",children:"التواريخ"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-purple-600 font-medium",children:d.type==="شيك ضمان"?"تاريخ الشيك:":"تاريخ الخطاب:"}),i.jsx("p",{className:"text-purple-900",children:je(d.checkDate||d.letterDate)})]}),d.deliveryDate&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-purple-600 font-medium",children:"تاريخ التسليم:"}),i.jsx("p",{className:"text-purple-900",children:je(d.deliveryDate)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-purple-600 font-medium",children:"تاريخ الانتهاء:"}),i.jsx("p",{className:"text-purple-900",children:je(d.expiryDate||d.dueDate)})]}),d.returnDate&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-purple-600 font-medium",children:"تاريخ الاسترداد:"}),i.jsx("p",{className:"text-purple-900",children:je(d.returnDate)})]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"الحالة"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"حالة الضمان:"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${d.isReturned?"bg-green-100 text-green-800":w(d.expiryDate||d.dueDate)?"bg-red-100 text-red-800":p(d.expiryDate||d.dueDate)?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:d.isReturned?"مُسترد":w(d.expiryDate||d.dueDate)?"منتهي الصلاحية":p(d.expiryDate||d.dueDate)?"ينتهي قريباً":"قائم"})})]}),d.notes&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"ملاحظات:"}),i.jsx("p",{className:"text-gray-900",children:d.notes})]})]})]})]}),!d.isReturned&&i.jsxs(i.Fragment,{children:[p(d.expiryDate||d.dueDate)&&!w(d.expiryDate||d.dueDate)&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(He,{className:"w-5 h-5 text-yellow-600"}),i.jsx("span",{className:"text-yellow-800 font-medium",children:"تنبيه: هذا الضمان سينتهي خلال 30 يوماً"})]})}),w(d.expiryDate||d.dueDate)&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(He,{className:"w-5 h-5 text-red-600"}),i.jsx("span",{className:"text-red-800 font-medium",children:"تحذير: هذا الضمان منتهي الصلاحية"})]})})]})]})]})}),r==="checks"&&i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"رقم الشيك"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المبلغ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"البنك"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العملية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الانتهاء"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.map(b=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.checkNumber}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ne(b.amount)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.bank}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.clientName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.operationName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[w(b.expiryDate)&&i.jsx(He,{className:"w-4 h-4 text-red-500"}),p(b.expiryDate)&&!w(b.expiryDate)&&i.jsx(He,{className:"w-4 h-4 text-yellow-500"}),i.jsx("span",{className:w(b.expiryDate)?"text-red-600":p(b.expiryDate)?"text-yellow-600":"text-gray-900",children:je(b.expiryDate)})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full ${b.isReturned?"bg-green-100 text-green-800":w(b.expiryDate)?"bg-red-100 text-red-800":p(b.expiryDate)?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:b.isReturned?i.jsxs(i.Fragment,{children:[i.jsx(rr,{className:"w-3 h-3"}),"مُسترد"]}):w(b.expiryDate)?i.jsxs(i.Fragment,{children:[i.jsx(He,{className:"w-3 h-3"}),"منتهي الصلاحية"]}):p(b.expiryDate)?i.jsxs(i.Fragment,{children:[i.jsx(He,{className:"w-3 h-3"}),"ينتهي قريباً"]}):"قائم"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsx("button",{onClick:()=>y(b),className:"text-blue-600 hover:text-blue-900",title:"معاينة",children:i.jsx(Ks,{className:"w-4 h-4"})})})]},b.id))})]})}),I.length===0&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"لا توجد شيكات ضمان تطابق المعايير المحددة"})})]}),r==="letters"&&i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"رقم الخطاب"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"البنك"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المبلغ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العملية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الاستحقاق"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L.map(b=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.letterNumber}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.bank}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ne(b.amount)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.clientName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.operationName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[w(b.dueDate)&&i.jsx(He,{className:"w-4 h-4 text-red-500"}),p(b.dueDate)&&!w(b.dueDate)&&i.jsx(He,{className:"w-4 h-4 text-yellow-500"}),i.jsx("span",{className:w(b.dueDate)?"text-red-600":p(b.dueDate)?"text-yellow-600":"text-gray-900",children:je(b.dueDate)})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full ${b.isReturned?"bg-green-100 text-green-800":w(b.dueDate)?"bg-red-100 text-red-800":p(b.dueDate)?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:b.isReturned?i.jsxs(i.Fragment,{children:[i.jsx(rr,{className:"w-3 h-3"}),"مُسترد"]}):w(b.dueDate)?i.jsxs(i.Fragment,{children:[i.jsx(He,{className:"w-3 h-3"}),"منتهي الصلاحية"]}):p(b.dueDate)?i.jsxs(i.Fragment,{children:[i.jsx(He,{className:"w-3 h-3"}),"ينتهي قريباً"]}):"قائم"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsx("button",{onClick:()=>y(b),className:"text-blue-600 hover:text-blue-900",title:"معاينة",children:i.jsx(Ks,{className:"w-4 h-4"})})})]},b.id))})]})}),L.length===0&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"لا توجد خطابات ضمان تطابق المعايير المحددة"})})]}),i.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[i.jsx("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"إجمالي الضمانات"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:_.length+v.length})]}),i.jsx(ml,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"الضمانات النشطة"}),i.jsx("p",{className:"text-2xl font-bold text-green-900",children:oe+we})]}),i.jsx(rr,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-yellow-50 p-6 rounded-lg border border-yellow-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"تنتهي قريباً"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:z+K})]}),i.jsx(He,{className:"w-8 h-8 text-yellow-600"})]})}),i.jsx("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-red-600",children:"منتهية الصلاحية"}),i.jsx("p",{className:"text-2xl font-bold text-red-900",children:N+D})]}),i.jsx(He,{className:"w-8 h-8 text-red-600"})]})}),i.jsx("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"الضمانات المستردة"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.filter(b=>b.isReturned).length+v.filter(b=>b.isReturned).length})]}),i.jsx(rr,{className:"w-8 h-8 text-gray-600"})]})})]})]})},NT=({operations:e,clients:t,onUpdateOperation:r})=>{const[n,a]=ye.useState(""),[s,l]=ye.useState("all"),[o,c]=ye.useState(!1),[u,d]=ye.useState(null),[f,h]=ye.useState(""),[x,g]=ye.useState(null),[m,_]=ye.useState({certificateNumber:"",issueDate:new Date().toISOString().split("T")[0],startDate:new Date().toISOString().split("T")[0],warrantyPeriodMonths:12,description:"",relatedTo:"operation",relatedItemId:"",notes:""}),[v,p]=ye.useState("");ye.useEffect(()=>{const N=new Date(m.startDate),D=new Date(N);D.setMonth(D.getMonth()+m.warrantyPeriodMonths),p(D.toISOString().split("T")[0])},[m.startDate,m.warrantyPeriodMonths]);const w=N=>{const D=t.find(b=>b.id===N);return D?D.name:"عميل غير معروف"},T=N=>{const D=e.find(b=>b.id===N);return D?D.name:"عملية غير معروفة"},I=(N,D)=>{const b=e.find(W=>W.id===N);if(!b)return"بند غير معروف";const S=b.items.find(W=>W.id===D);return S?S.description:"بند غير معروف"},L=e.flatMap(N=>(N.warrantyCertificates||[]).map(D=>({...D,issueDate:D.issueDate instanceof Date?D.issueDate:new Date(D.issueDate),startDate:D.startDate instanceof Date?D.startDate:new Date(D.startDate),endDate:D.endDate instanceof Date?D.endDate:new Date(D.endDate),operationId:N.id,operationName:N.name,operationCode:N.code,clientId:N.clientId,clientName:w(N.clientId)}))),j=N=>{const D=new Date;return new Date(N)<D},A=N=>{const D=new Date,b=new Date(N).getTime()-D.getTime(),S=Math.ceil(b/(1e3*60*60*24));return S<=30&&S>0},y=L.filter(N=>{const D=N.certificateNumber.toLowerCase().includes(n.toLowerCase())||N.description.toLowerCase().includes(n.toLowerCase())||N.clientName.toLowerCase().includes(n.toLowerCase())||N.operationName.toLowerCase().includes(n.toLowerCase()),b=s==="all"||s==="active"&&N.isActive&&!j(N.endDate)||s==="expired"&&(!N.isActive||j(N.endDate));return D&&b}),O=()=>{_({certificateNumber:"",issueDate:new Date().toISOString().split("T")[0],startDate:new Date().toISOString().split("T")[0],warrantyPeriodMonths:12,description:"",relatedTo:"operation",relatedItemId:"",notes:""}),h(""),c(!1),d(null)},B=N=>{if(N.preventDefault(),!f){alert("يرجى اختيار العملية");return}if(!m.certificateNumber.trim()){alert("يرجى إدخال رقم الشهادة");return}if(!m.description.trim()){alert("يرجى إدخال وصف الضمان");return}const D=e.find(J=>J.id===f);if(!D)return;const b=new Date(m.startDate),S=new Date(b);S.setMonth(S.getMonth()+m.warrantyPeriodMonths);const W={id:(u==null?void 0:u.warranty.id)||crypto.randomUUID(),certificateNumber:m.certificateNumber.trim(),issueDate:new Date(m.issueDate),startDate:b,endDate:S,warrantyPeriodMonths:m.warrantyPeriodMonths,description:m.description.trim(),relatedTo:m.relatedTo,relatedItemId:m.relatedTo==="item"?m.relatedItemId:void 0,isActive:!0,notes:m.notes.trim()||void 0};let M;u?M=(D.warrantyCertificates||[]).map(J=>J.id===u.warranty.id?W:J):M=[...D.warrantyCertificates||[],W];const U={...D,warrantyCertificates:M,updatedAt:new Date};r(U),O()},H=N=>{d({warranty:N,operationId:N.operationId}),h(N.operationId),_({certificateNumber:N.certificateNumber,issueDate:N.issueDate.toISOString().split("T")[0],startDate:N.startDate.toISOString().split("T")[0],warrantyPeriodMonths:N.warrantyPeriodMonths,description:N.description,relatedTo:N.relatedTo,relatedItemId:N.relatedItemId||"",notes:N.notes||""}),c(!0)},Q=N=>{g({warranty:N,operationId:N.operationId,clientName:N.clientName})},ie=N=>{if(window.confirm("هل أنت متأكد من حذف شهادة الضمان؟")){const D=e.find(W=>W.id===N.operationId);if(!D)return;const b=(D.warrantyCertificates||[]).filter(W=>W.id!==N.id),S={...D,warrantyCertificates:b,updatedAt:new Date};r(S)}},oe=()=>{try{kv(e,t)}catch(N){console.error("خطأ في تصدير PDF:",N),alert("حدث خطأ أثناء تصدير ملف PDF")}},we=()=>{try{lT(e,t)}catch(N){console.error("خطأ في تصدير Excel:",N),alert("حدث خطأ أثناء تصدير ملف Excel")}},z=()=>{try{Sv(e,t)}catch(N){console.error("خطأ في تصدير Word:",N),alert("حدث خطأ أثناء تصدير ملف Word")}},K=e.find(N=>N.id===f);return i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"إدارة شهادات الضمان"}),i.jsx("p",{className:"text-gray-600",children:"متابعة وإدارة شهادات الضمان للعمليات المكتملة"})]}),i.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"إجمالي الشهادات"}),i.jsx("p",{className:"text-2xl font-bold text-green-900",children:L.length})]}),i.jsx(Bi,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"الشهادات النشطة"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:L.filter(N=>N.isActive&&!j(N.endDate)).length})]}),i.jsx(rr,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-yellow-50 p-6 rounded-lg border border-yellow-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"تنتهي قريباً"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:L.filter(N=>N.isActive&&A(N.endDate)).length})]}),i.jsx(He,{className:"w-8 h-8 text-yellow-600"})]})}),i.jsx("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-red-600",children:"منتهية الصلاحية"}),i.jsx("p",{className:"text-2xl font-bold text-red-900",children:L.filter(N=>!N.isActive||j(N.endDate)).length})]}),i.jsx(He,{className:"w-8 h-8 text-red-600"})]})})]}),i.jsxs("div",{className:"mb-6 flex gap-4",children:[i.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[i.jsx(Xa,{className:"w-4 h-4"}),"تصدير PDF"]}),i.jsxs("button",{onClick:we,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[i.jsx(Rl,{className:"w-4 h-4"}),"تصدير Excel"]}),i.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Zs,{className:"w-4 h-4"}),"تصدير Word"]})]}),i.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 justify-between",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{className:"relative flex-1 max-w-md",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"البحث...",value:n,onChange:N=>a(N.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("select",{value:s,onChange:N=>l(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الشهادات"}),i.jsx("option",{value:"active",children:"الشهادات النشطة"}),i.jsx("option",{value:"expired",children:"الشهادات المنتهية"})]})]}),i.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[i.jsx(Tt,{className:"w-4 h-4"}),"إضافة شهادة ضمان"]})]}),o&&i.jsxs("div",{className:"mb-6 bg-white p-6 rounded-lg border border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:u?"تعديل شهادة الضمان":"إضافة شهادة ضمان جديدة"}),i.jsxs("form",{onSubmit:B,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العملية *"}),i.jsxs("select",{value:f,onChange:N=>h(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!u,children:[i.jsx("option",{value:"",children:"اختر العملية"}),e.map(N=>i.jsxs("option",{value:N.id,children:[N.name," - ",w(N.clientId)]},N.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الشهادة *"}),i.jsx("input",{type:"text",value:m.certificateNumber,onChange:N=>_({...m,certificateNumber:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"أدخل رقم الشهادة"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الإصدار *"}),i.jsx("input",{type:"date",value:m.issueDate,onChange:N=>_({...m,issueDate:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ بداية الضمان *"}),i.jsx("input",{type:"date",value:m.startDate,onChange:N=>_({...m,startDate:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مدة الضمان (بالأشهر) *"}),i.jsx("input",{type:"number",value:m.warrantyPeriodMonths,onChange:N=>_({...m,warrantyPeriodMonths:parseInt(N.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ انتهاء الضمان (محسوب تلقائياً)"}),i.jsx("input",{type:"date",value:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600",readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مرتبط بـ"}),i.jsxs("select",{value:m.relatedTo,onChange:N=>_({...m,relatedTo:N.target.value,relatedItemId:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"operation",children:"العملية كاملة"}),i.jsx("option",{value:"item",children:"بند محدد"})]})]}),m.relatedTo==="item"&&K&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البند"}),i.jsxs("select",{value:m.relatedItemId,onChange:N=>_({...m,relatedItemId:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"اختر البند"}),K.items.map(N=>i.jsx("option",{value:N.id,children:N.description},N.id))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الضمان *"}),i.jsx("textarea",{value:m.description,onChange:N=>_({...m,description:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,required:!0,placeholder:"أدخل وصف الضمان"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات"}),i.jsx("textarea",{value:m.notes,onChange:N=>_({...m,notes:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"ملاحظات إضافية (اختياري)"})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:u?"تحديث":"إضافة"}),i.jsx("button",{type:"button",onClick:O,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"إلغاء"})]})]})]}),x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"تفاصيل شهادة الضمان"}),i.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100",children:i.jsx(la,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"معلومات الشهادة"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"رقم الشهادة:"}),i.jsx("p",{className:"text-blue-900",children:x.warranty.certificateNumber})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"تاريخ الإصدار:"}),i.jsx("p",{className:"text-blue-900",children:je(x.warranty.issueDate)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"مدة الضمان:"}),i.jsxs("p",{className:"text-blue-900",children:[x.warranty.warrantyPeriodMonths," شهر"]})]})]})]}),i.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"معلومات العملية"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-green-600 font-medium",children:"العميل:"}),i.jsx("p",{className:"text-green-900",children:x.clientName})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-green-600 font-medium",children:"العملية:"}),i.jsx("p",{className:"text-green-900",children:T(x.operationId)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-green-600 font-medium",children:"مرتبط بـ:"}),i.jsx("p",{className:"text-green-900",children:x.warranty.relatedTo==="operation"?"العملية كاملة":`البند: ${I(x.operationId,x.warranty.relatedItemId||"")}`})]})]})]}),i.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-purple-900 mb-3",children:"فترة الضمان"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-purple-600 font-medium",children:"تاريخ البداية:"}),i.jsx("p",{className:"text-purple-900",children:je(x.warranty.startDate)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-purple-600 font-medium",children:"تاريخ النهاية:"}),i.jsx("p",{className:"text-purple-900",children:je(x.warranty.endDate)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-purple-600 font-medium",children:"الحالة:"}),i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${x.warranty.isActive&&!j(x.warranty.endDate)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.warranty.isActive&&!j(x.warranty.endDate)?"نشط":"منتهي"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"الوصف والملاحظات"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"وصف الضمان:"}),i.jsx("p",{className:"text-gray-900",children:x.warranty.description})]}),x.warranty.notes&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"ملاحظات:"}),i.jsx("p",{className:"text-gray-900",children:x.warranty.notes})]})]})]})]}),A(x.warranty.endDate)&&!j(x.warranty.endDate)&&i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(He,{className:"w-5 h-5 text-yellow-600"}),i.jsx("span",{className:"text-yellow-800 font-medium",children:"تنبيه: هذه الشهادة ستنتهي خلال 30 يوماً"})]})}),j(x.warranty.endDate)&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(He,{className:"w-5 h-5 text-red-600"}),i.jsx("span",{className:"text-red-800 font-medium",children:"تحذير: هذه الشهادة منتهية الصلاحية"})]})})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"رقم الشهادة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العملية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"البند"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الوصف"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ البداية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ النهاية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"مدة الضمان"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(N=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:N.certificateNumber}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N.clientName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:N.operationName}),i.jsx("div",{className:"text-xs text-gray-500",children:N.operationCode})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N.relatedTo==="item"&&N.relatedItemId?I(N.operationId,N.relatedItemId):"العملية كاملة"}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:N.description}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:je(N.startDate)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[j(N.endDate)&&i.jsx(He,{className:"w-4 h-4 text-red-500"}),A(N.endDate)&&!j(N.endDate)&&i.jsx(He,{className:"w-4 h-4 text-yellow-500"}),i.jsx("span",{className:j(N.endDate)?"text-red-600":A(N.endDate)?"text-yellow-600":"text-gray-900",children:je(N.endDate)})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[N.warrantyPeriodMonths," شهر"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full ${N.isActive&&!j(N.endDate)?A(N.endDate)?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:N.isActive&&!j(N.endDate)?A(N.endDate)?i.jsxs(i.Fragment,{children:[i.jsx(He,{className:"w-3 h-3"}),"ينتهي قريباً"]}):i.jsxs(i.Fragment,{children:[i.jsx(rr,{className:"w-3 h-3"}),"نشط"]}):i.jsxs(i.Fragment,{children:[i.jsx(He,{className:"w-3 h-3"}),"منتهي"]})})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>Q(N),className:"text-blue-600 hover:text-blue-900",title:"معاينة",children:i.jsx(Ks,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>H(N),className:"text-green-600 hover:text-green-900",title:"تعديل",children:i.jsx(Sf,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>ie(N),className:"text-red-600 hover:text-red-900",title:"حذف",children:i.jsx(Mt,{className:"w-4 h-4"})})]})})]},N.id))})]})}),y.length===0&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"لا توجد شهادات ضمان تطابق المعايير المحددة"})})]})]})},bT=({operations:e,clients:t})=>{const[r,n]=ye.useState(""),[a,s]=ye.useState("all"),[l,o]=ye.useState("all"),[c,u]=ye.useState(!1),[d,f]=ye.useState({clientId:"all",operationId:"all",status:"all",type:"all",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchTerm:""}),h=y=>{const O=t.find(B=>B.id===y);return O?O.name:"عميل غير معروف"},x=e.flatMap(y=>y.receivedPayments.map(O=>({...O,operationId:y.id,operationName:y.name,operationCode:y.code,clientId:y.clientId,clientName:h(y.clientId)}))),m=c?(y=>y.filter(O=>{const B=!d.searchTerm||(O.checkNumber||"").toLowerCase().includes(d.searchTerm.toLowerCase())||(O.bank||"").toLowerCase().includes(d.searchTerm.toLowerCase())||O.clientName.toLowerCase().includes(d.searchTerm.toLowerCase())||O.operationName.toLowerCase().includes(d.searchTerm.toLowerCase())||O.operationCode.toLowerCase().includes(d.searchTerm.toLowerCase()),H=d.clientId==="all"||O.clientId===d.clientId,Q=d.operationId==="all"||O.operationId===d.operationId,ie=d.type==="all"||O.type===d.type,oe=d.status==="all"||d.status==="received"&&O.receiptDate||d.status==="pending"&&!O.receiptDate&&O.type==="check";let we=!0;if(d.startDate){const K=new Date(d.startDate);we=we&&new Date(O.date)>=K}if(d.endDate){const K=new Date(d.endDate);K.setHours(23,59,59,999),we=we&&new Date(O.date)<=K}let z=!0;if(d.minAmount){const K=parseFloat(d.minAmount);z=z&&O.amount>=K}if(d.maxAmount){const K=parseFloat(d.maxAmount);z=z&&O.amount<=K}return B&&H&&Q&&ie&&oe&&we&&z}))(x):x.filter(y=>{const O=(y.checkNumber||"").toLowerCase().includes(r.toLowerCase())||(y.bank||"").toLowerCase().includes(r.toLowerCase())||y.clientName.toLowerCase().includes(r.toLowerCase())||y.operationName.toLowerCase().includes(r.toLowerCase())||y.operationCode.toLowerCase().includes(r.toLowerCase()),B=l==="all"||y.type===l,H=a==="all"||a==="received"&&y.receiptDate||a==="pending"&&!y.receiptDate&&y.type==="check";return O&&B&&H}),_=()=>{f({clientId:"all",operationId:"all",status:"all",type:"all",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchTerm:""})},v=(y,O)=>{f(B=>({...B,[y]:O}))},p=x.reduce((y,O)=>y+O.amount,0),w=x.filter(y=>y.type==="check").length,T=x.filter(y=>y.type==="cash").length,I=x.filter(y=>y.type==="check"&&!y.receiptDate).length,L=()=>{try{xT(e,t)}catch(y){console.error("خطأ في تصدير PDF:",y),alert("حدث خطأ أثناء تصدير ملف PDF")}},j=()=>{try{oT(e,t)}catch(y){console.error("خطأ في تصدير Excel:",y),alert("حدث خطأ أثناء تصدير ملف Excel")}},A=()=>{try{dT(e,t)}catch(y){console.error("خطأ في تصدير Word:",y),alert("حدث خطأ أثناء تصدير ملف Word")}};return i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"إدارة الشيكات والمدفوعات"}),i.jsx("p",{className:"text-gray-600",children:"متابعة وإدارة جميع المدفوعات المستلمة"})]}),i.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"إجمالي المدفوعات"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ne(p)})]}),i.jsx(gr,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"الشيكات"}),i.jsx("p",{className:"text-2xl font-bold text-green-900",children:w})]}),i.jsx(ed,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-purple-600",children:"المدفوعات النقدية"}),i.jsx("p",{className:"text-2xl font-bold text-purple-900",children:T})]}),i.jsx(gr,{className:"w-8 h-8 text-purple-600"})]})}),i.jsx("div",{className:"bg-yellow-50 p-6 rounded-lg border border-yellow-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"شيكات معلقة"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:I})]}),i.jsx(He,{className:"w-8 h-8 text-yellow-600"})]})})]}),i.jsxs("div",{className:"mb-6 flex gap-4",children:[i.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[i.jsx(Xa,{className:"w-4 h-4"}),"تصدير PDF"]}),i.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[i.jsx(Rl,{className:"w-4 h-4"}),"تصدير Excel"]}),i.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Zs,{className:"w-4 h-4"}),"تصدير Word"]})]}),!c&&i.jsx("div",{className:"mb-6 bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"البحث...",value:r,onChange:y=>n(y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("select",{value:l,onChange:y=>o(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الأنواع"}),i.jsx("option",{value:"check",children:"شيكات"}),i.jsx("option",{value:"cash",children:"نقدي"})]}),i.jsxs("select",{value:a,onChange:y=>s(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الحالات"}),i.jsx("option",{value:"received",children:"مستلمة"}),i.jsx("option",{value:"pending",children:"معلقة"})]}),i.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[i.jsx(Gs,{className:"w-4 h-4"}),"فلاتر متقدمة"]})]})}),c&&i.jsxs("div",{className:"mb-6 bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(Gs,{className:"w-5 h-5"}),"الفلاتر المتقدمة"]}),i.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600 p-1 rounded",children:i.jsx(la,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البحث النصي"}),i.jsxs("div",{className:"relative",children:[i.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"رقم الشيك، البنك، العميل...",value:d.searchTerm,onChange:y=>v("searchTerm",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل"}),i.jsxs("select",{value:d.clientId,onChange:y=>v("clientId",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع العملاء"}),t.map(y=>i.jsx("option",{value:y.id,children:y.name},y.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العملية"}),i.jsxs("select",{value:d.operationId,onChange:y=>v("operationId",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع العمليات"}),e.map(y=>i.jsx("option",{value:y.id,children:y.name},y.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الدفع"}),i.jsxs("select",{value:d.type,onChange:y=>v("type",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الأنواع"}),i.jsx("option",{value:"check",children:"شيكات"}),i.jsx("option",{value:"cash",children:"نقدي"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"حالة الدفع"}),i.jsxs("select",{value:d.status,onChange:y=>v("status",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع الحالات"}),i.jsx("option",{value:"received",children:"مستلمة"}),i.jsx("option",{value:"pending",children:"معلقة"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"من تاريخ"}),i.jsxs("div",{className:"relative",children:[i.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",value:d.startDate,onChange:y=>v("startDate",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إلى تاريخ"}),i.jsxs("div",{className:"relative",children:[i.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"date",value:d.endDate,onChange:y=>v("endDate",y.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحد الأدنى للمبلغ (ج.م)"}),i.jsx("input",{type:"number",placeholder:"0",value:d.minAmount,onChange:y=>v("minAmount",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحد الأقصى للمبلغ (ج.م)"}),i.jsx("input",{type:"number",placeholder:"∞",value:d.maxAmount,onChange:y=>v("maxAmount",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:_,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"مسح الفلاتر"}),i.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"إخفاء الفلاتر المتقدمة"})]}),i.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("span",{className:"font-semibold",children:m.length})," مدفوعة من أصل ",x.length]})})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"النوع"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المبلغ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التاريخ"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العملية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التفاصيل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(y=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center gap-2",children:[y.type==="check"?i.jsx(ed,{className:"w-4 h-4 text-blue-600"}):i.jsx(gr,{className:"w-4 h-4 text-green-600"}),i.jsx("span",{className:"text-sm font-medium text-gray-900",children:y.type==="check"?"شيك":"نقدي"})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ne(y.amount)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:je(y.date)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.clientName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:y.operationName}),i.jsx("div",{className:"text-xs text-gray-500",children:y.operationCode})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.type==="check"?i.jsxs("div",{children:[y.checkNumber&&i.jsxs("div",{className:"font-medium",children:["رقم: ",y.checkNumber]}),y.bank&&i.jsx("div",{className:"text-xs text-gray-500",children:y.bank})]}):i.jsx("span",{className:"text-gray-500",children:"-"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:y.type==="check"?i.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full ${y.receiptDate?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:y.receiptDate?i.jsxs(i.Fragment,{children:[i.jsx(rr,{className:"w-3 h-3"}),"مستلم"]}):i.jsxs(i.Fragment,{children:[i.jsx(He,{className:"w-3 h-3"}),"معلق"]})}):i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:[i.jsx(rr,{className:"w-3 h-3"}),"مستلم"]})})]},y.id))})]})}),m.length===0&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"لا توجد مدفوعات تطابق المعايير المحددة"})})]})]})},ET=({operations:e,clients:t})=>{const[r,n]=ye.useState("summary"),[a,s]=ye.useState("all"),[l,o]=ye.useState(""),[c,u]=ye.useState(""),d=z=>{const K=t.find(N=>N.id===z);return K?K.name:"عميل غير معروف"},f=e.filter(z=>{const K=a==="all"||z.clientId===a;let N=!0;return l&&(N=N&&new Date(z.createdAt)>=new Date(l)),c&&(N=N&&new Date(z.createdAt)<=new Date(c)),K&&N}),h=f.length,x=f.filter(z=>z.status==="completed"||z.status==="completed_partial_payment"||z.status==="completed_full_payment").length,g=f.filter(z=>z.status==="in_progress").length,m=f.reduce((z,K)=>z+K.totalAmount,0),_=f.reduce((z,K)=>z+K.totalReceived,0),v=f.reduce((z,K)=>z+Dr(K),0),p=f.reduce((z,K)=>z+Ua(K),0),w=_+v,T=p-_,I=t.map(z=>{const K=f.filter(W=>W.clientId===z.id),N=K.reduce((W,M)=>W+M.totalAmount,0),D=K.reduce((W,M)=>W+M.totalReceived,0),b=K.reduce((W,M)=>W+Dr(M),0),S=D+b;return{client:z,operationsCount:K.length,totalAmount:N,totalReceived:D,totalDeductions:b,totalPaid:S,outstanding:N-S}}).filter(z=>z.operationsCount>0),L=f.reduce((z,K)=>z+K.guaranteeChecks.length,0),j=f.reduce((z,K)=>z+K.guaranteeLetters.length,0),A=f.reduce((z,K)=>z+K.guaranteeChecks.filter(N=>!N.isReturned).length,0),y=f.reduce((z,K)=>z+K.guaranteeLetters.filter(N=>!N.isReturned).length,0),O=f.reduce((z,K)=>z+(K.warrantyCertificates||[]).length,0),B=f.reduce((z,K)=>z+(K.warrantyCertificates||[]).filter(N=>N.isActive).length,0),H=()=>{try{switch(r){case"summary":$o(f,t,"تقرير العمليات الإجمالي");break;case"client":hT(t,"تقرير العملاء");break;case"financial":mT(f,t);break;case"guarantees":$o(f,t,"تقرير الضمانات");break;case"detailed-guarantees":Tv(f,t);break;case"warranties":kv(f,t);break;default:$o(f,t)}}catch(z){console.error("خطأ في تصدير PDF:",z),alert("حدث خطأ أثناء تصدير ملف PDF")}},Q=()=>{try{switch(r){case"summary":us(f,t,"تقرير العمليات الإجمالي");break;case"client":aT(t,"تقرير العملاء");break;case"financial":sT(f,t);break;case"guarantees":us(f,t,"تقرير الضمانات");break;case"detailed-guarantees":us(f,t,"تقرير الضمانات المفصل");break;case"warranties":us(f,t,"تقرير شهادات الضمان");break;default:us(f,t)}}catch(z){console.error("خطأ في تصدير Excel:",z),alert("حدث خطأ أثناء تصدير ملف Excel")}},ie=()=>{try{switch(r){case"summary":Uo(f,t,"تقرير العمليات الإجمالي");break;case"client":cT(t,"تقرير العملاء");break;case"financial":uT(f,t);break;case"guarantees":Uo(f,t,"تقرير الضمانات");break;case"detailed-guarantees":jv(f,t);break;case"warranties":Sv(f,t);break;default:Uo(f,t)}}catch(z){console.error("خطأ في تصدير Word:",z),alert("حدث خطأ أثناء تصدير ملف Word")}},oe=()=>{const z={reportType:r,generatedAt:new Date().toISOString(),filters:{client:a,dateFrom:l,dateTo:c},summary:{totalOperations:h,completedOperations:x,inProgressOperations:g,totalAmount:m,totalReceived:_,totalDeductions:v,totalPaid:w,totalOutstanding:T,totalWarranties:O,activeWarranties:B},operations:f,clientStats:r==="client"?I:void 0},K=new Blob([JSON.stringify(z,null,2)],{type:"application/json"}),N=URL.createObjectURL(K),D=document.createElement("a");D.href=N,D.download=`construction-report-${r}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(N)},we=[{id:"summary",label:"تقرير إجمالي",icon:Z0},{id:"client",label:"تقرير العملاء",icon:nn},{id:"financial",label:"التقرير المالي",icon:gr},{id:"guarantees",label:"ملخص الضمانات",icon:s_},{id:"detailed-guarantees",label:"الضمانات المفصلة",icon:nn},{id:"warranties",label:"شهادات الضمان",icon:Bi}];return i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"التقارير والإحصائيات"}),i.jsx("p",{className:"text-gray-600",children:"تقارير شاملة ومفصلة عن أداء العمليات والمشاريع"})]}),i.jsx("div",{className:"mb-6 bg-white rounded-lg border border-gray-200 p-1",children:i.jsx("nav",{className:"flex flex-wrap gap-1",children:we.map(z=>{const K=z.icon;return i.jsxs("button",{onClick:()=>n(z.id),className:`flex items-center gap-2 px-4 py-3 rounded-md font-medium text-sm transition-all ${r===z.id?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[i.jsx(K,{className:"w-4 h-4"}),z.label]},z.id)})})}),i.jsx("div",{className:"mb-6 bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل"}),i.jsxs("select",{value:a,onChange:z=>s(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"جميع العملاء"}),t.map(z=>i.jsx("option",{value:z.id,children:z.name},z.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"من تاريخ"}),i.jsx("input",{type:"date",value:l,onChange:z=>o(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إلى تاريخ"}),i.jsx("input",{type:"date",value:c,onChange:z=>u(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex items-end",children:i.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors w-full justify-center",children:[i.jsx(nn,{className:"w-4 h-4"}),"PDF"]})}),i.jsx("div",{className:"flex items-end",children:i.jsxs("button",{onClick:Q,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors w-full justify-center",children:[i.jsx(Rl,{className:"w-4 h-4"}),"Excel"]})}),i.jsx("div",{className:"flex items-end",children:i.jsxs("button",{onClick:ie,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors w-full justify-center",children:[i.jsx(Zs,{className:"w-4 h-4"}),"Word"]})}),i.jsx("div",{className:"flex items-end",children:i.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors w-full justify-center",children:[i.jsx(Xa,{className:"w-4 h-4"}),"JSON"]})})]})}),r==="summary"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"إجمالي العمليات"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:h})]}),i.jsx(Z0,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"العمليات المكتملة"}),i.jsx("p",{className:"text-2xl font-bold text-green-900",children:x})]}),i.jsx(Hn,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-yellow-50 p-6 rounded-lg border border-yellow-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"العمليات الجارية"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:g})]}),i.jsx(Vr,{className:"w-8 h-8 text-yellow-600"})]})}),i.jsx("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-purple-600",children:"إجمالي القيمة"}),i.jsx("p",{className:"text-2xl font-bold text-purple-900",children:ne(m)})]}),i.jsx(gr,{className:"w-8 h-8 text-purple-600"})]})}),i.jsx("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-red-600",children:"إجمالي الخصومات"}),i.jsx("p",{className:"text-2xl font-bold text-red-900",children:ne(v)})]}),i.jsx(Hn,{className:"w-8 h-8 text-red-600"})]})}),i.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"المبلغ المحصل"}),i.jsx("p",{className:"text-2xl font-bold text-green-900",children:ne(_)})]}),i.jsx(Hn,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-indigo-50 p-6 rounded-lg border border-indigo-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-indigo-600",children:"إجمالي المسدد"}),i.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:ne(w)}),i.jsx("p",{className:"text-xs text-indigo-600",children:"(نقدي + خصومات)"})]}),i.jsx(gr,{className:"w-8 h-8 text-indigo-600"})]})}),i.jsx("div",{className:"bg-orange-50 p-6 rounded-lg border border-orange-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-orange-600",children:"المبلغ المتبقي"}),i.jsx("p",{className:"text-2xl font-bold text-orange-900",children:ne(T)})]}),i.jsx(gr,{className:"w-8 h-8 text-orange-600"})]})}),i.jsx("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"معدل السداد الإجمالي"}),i.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[m>0?(w/m*100).toFixed(1):0,"%"]})]}),i.jsx(Hn,{className:"w-8 h-8 text-gray-600"})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"تفاصيل العمليات"})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"العملية"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"القيمة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الخصومات"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المحصل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المسدد"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المتبقي"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الحالة"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:f.map(z=>{const K=Dr(z),N=z.totalReceived+K,D=z.totalAmount-N;return i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:z.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:d(z.clientId)}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ne(z.totalAmount)}),i.jsx("td",{className:"px-6 py-4 text-sm text-red-600",children:ne(K)}),i.jsx("td",{className:"px-6 py-4 text-sm text-green-600",children:ne(z.totalReceived)}),i.jsx("td",{className:"px-6 py-4 text-sm text-indigo-600",children:ne(N)}),i.jsx("td",{className:"px-6 py-4 text-sm text-orange-600",children:ne(D)}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${z.status==="completed_full_payment"?"bg-green-100 text-green-800":z.status==="completed_partial_payment"?"bg-orange-100 text-orange-800":z.status==="completed"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:z.status==="completed_full_payment"?"مكتملة ومدفوعة بالكامل":z.status==="completed_partial_payment"?"مكتملة - دفع جزئي":z.status==="completed"?"مكتملة":"قيد التنفيذ"})})]},z.id)})})]})})]})]}),r==="client"&&i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"تقرير العملاء"})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"النوع"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"عدد العمليات"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"إجمالي القيمة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المبلغ المحصل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الخصومات"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"إجمالي المسدد"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المبلغ المتبقي"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"معدل السداد"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:I.map(z=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:z.client.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:z.client.type==="owner"?"مالك":z.client.type==="main_contractor"?"مقاول رئيسي":"استشاري"}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:z.operationsCount}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ne(z.totalAmount)}),i.jsx("td",{className:"px-6 py-4 text-sm text-green-600",children:ne(z.totalReceived)}),i.jsx("td",{className:"px-6 py-4 text-sm text-red-600",children:ne(z.totalDeductions)}),i.jsx("td",{className:"px-6 py-4 text-sm text-indigo-600",children:ne(z.totalPaid)}),i.jsx("td",{className:"px-6 py-4 text-sm text-orange-600",children:ne(z.outstanding)}),i.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[z.totalAmount>0?(z.totalPaid/z.totalAmount*100).toFixed(1):0,"%"]})]},z.client.id))})]})})]}),r==="financial"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"الملخص المالي"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"إجمالي القيمة:"}),i.jsx("span",{className:"font-bold text-gray-900",children:ne(m)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"إجمالي الخصومات:"}),i.jsx("span",{className:"font-bold text-red-600",children:ne(v)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"الصافي المستحق:"}),i.jsx("span",{className:"font-bold text-purple-600",children:ne(p)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"المبلغ المحصل نقداً:"}),i.jsx("span",{className:"font-bold text-green-600",children:ne(_)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"إجمالي المسدد (نقدي + خصومات):"}),i.jsx("span",{className:"font-bold text-indigo-600",children:ne(w)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"المبلغ المتبقي:"}),i.jsx("span",{className:"font-bold text-orange-600",children:ne(T)})]}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[i.jsx("span",{className:"text-gray-600",children:"معدل السداد الإجمالي:"}),i.jsxs("span",{className:"font-bold text-blue-600",children:[m>0?(w/m*100).toFixed(1):0,"%"]})]})]})]}),i.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"توزيع الحالات"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"مكتملة:"}),i.jsx("span",{className:"font-bold text-green-600",children:x})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"قيد التنفيذ:"}),i.jsx("span",{className:"font-bold text-yellow-600",children:g})]}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[i.jsx("span",{className:"text-gray-600",children:"معدل الإنجاز:"}),i.jsxs("span",{className:"font-bold text-blue-600",children:[h>0?(x/h*100).toFixed(1):0,"%"]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"التفاصيل المالية حسب العميل"})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"العميل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"عدد العمليات"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"إجمالي القيمة"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المبلغ المحصل"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"الخصومات"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"إجمالي المسدد"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"المبلغ المتبقي"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"معدل السداد"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"نسبة من الإجمالي"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:I.map(z=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:z.client.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:z.operationsCount}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ne(z.totalAmount)}),i.jsx("td",{className:"px-6 py-4 text-sm text-green-600 font-medium",children:ne(z.totalReceived)}),i.jsx("td",{className:"px-6 py-4 text-sm text-red-600 font-medium",children:ne(z.totalDeductions)}),i.jsx("td",{className:"px-6 py-4 text-sm text-indigo-600 font-medium",children:ne(z.totalPaid)}),i.jsx("td",{className:"px-6 py-4 text-sm text-orange-600 font-medium",children:ne(z.outstanding)}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${z.totalAmount>0?z.totalPaid/z.totalAmount*100:0}%`}})}),i.jsxs("span",{className:"text-xs font-medium",children:[z.totalAmount>0?(z.totalPaid/z.totalAmount*100).toFixed(1):0,"%"]})]})}),i.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[m>0?(z.totalAmount/m*100).toFixed(1):0,"%"]})]},z.client.id))})]})})]})]}),r==="guarantees"&&i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"شيكات الضمان"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:L})]}),i.jsx(nn,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-purple-600",children:"خطابات الضمان"}),i.jsx("p",{className:"text-2xl font-bold text-purple-900",children:j})]}),i.jsx(nn,{className:"w-8 h-8 text-purple-600"})]})}),i.jsx("div",{className:"bg-yellow-50 p-6 rounded-lg border border-yellow-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"ضمانات قائمة"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:A+y})]}),i.jsx(Vr,{className:"w-8 h-8 text-yellow-600"})]})}),i.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"شهادات الضمان"}),i.jsx("p",{className:"text-2xl font-bold text-green-900",children:O})]}),i.jsx(Bi,{className:"w-8 h-8 text-green-600"})]})})]})}),r==="detailed-guarantees"&&i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"تقرير الضمانات المفصل"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"عرض تفصيلي لجميع شيكات وخطابات الضمان مع البنود المرتبطة"})]}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[i.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:L}),i.jsx("p",{className:"text-sm text-blue-600",children:"شيكات الضمان"})]})}),i.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-purple-900",children:j}),i.jsx("p",{className:"text-sm text-purple-600",children:"خطابات الضمان"})]})}),i.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-green-900",children:A+y}),i.jsx("p",{className:"text-sm text-green-600",children:"ضمانات نشطة"})]})}),i.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-red-900",children:L+j-(A+y)}),i.jsx("p",{className:"text-sm text-red-600",children:"ضمانات مستردة"})]})})]}),i.jsx("p",{className:"text-gray-600",children:"يحتوي هذا التقرير على تفاصيل شاملة لجميع الضمانات مع معلومات العميل والعملية والبند المرتبط وتواريخ الانتهاء وحالة الاسترداد. استخدم أزرار التصدير أعلاه للحصول على التقرير المفصل الكامل."})]})]})}),r==="warranties"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"إجمالي الشهادات"}),i.jsx("p",{className:"text-2xl font-bold text-green-900",children:O})]}),i.jsx(Bi,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"الشهادات النشطة"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:B})]}),i.jsx(Hn,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-red-600",children:"الشهادات المنتهية"}),i.jsx("p",{className:"text-2xl font-bold text-red-900",children:O-B})]}),i.jsx(Vr,{className:"w-8 h-8 text-red-600"})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"تفاصيل شهادات الضمان"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"عرض تفصيلي لجميع شهادات الضمان الصادرة"})]}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"توزيع الشهادات حسب الحالة"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"نشطة:"}),i.jsx("span",{className:"text-sm font-medium text-green-600",children:B})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"منتهية:"}),i.jsx("span",{className:"text-sm font-medium text-red-600",children:O-B})]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"معدل الشهادات النشطة"}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mr-3",children:i.jsx("div",{className:"bg-green-600 h-3 rounded-full",style:{width:`${O>0?B/O*100:0}%`}})}),i.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[O>0?(B/O*100).toFixed(1):0,"%"]})]})]})]}),i.jsx("p",{className:"text-gray-600",children:"يحتوي هذا التقرير على تفاصيل شاملة لجميع شهادات الضمان مع تواريخ البداية والنهاية وحالة كل شهادة. استخدم أزرار التصدير أعلاه للحصول على التقرير المفصل."})]})]})]})]})},Xe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ft=Object.keys,Ut=Array.isArray;function Qt(e,t){return typeof t!="object"||ft(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||Xe.Promise||(Xe.Promise=Promise);const El=Object.getPrototypeOf,jT={}.hasOwnProperty;function _r(e,t){return jT.call(e,t)}function Ys(e,t){typeof t=="function"&&(t=t(El(e))),(typeof Reflect>"u"?ft:Reflect.ownKeys)(t).forEach(r=>{En(e,r,t[r])})}const Cv=Object.defineProperty;function En(e,t,r,n){Cv(e,t,Qt(r&&_r(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Rs(e){return{from:function(t){return e.prototype=Object.create(t.prototype),En(e.prototype,"constructor",e),{extend:Ys.bind(null,e.prototype)}}}}const ST=Object.getOwnPropertyDescriptor;function Yf(e,t){let r;return ST(e,t)||(r=El(e))&&Yf(r,t)}const TT=[].slice;function Pc(e,t,r){return TT.call(e,t,r)}function Av(e,t){return t(e)}function ki(e){if(!e)throw new Error("Assertion Failed")}function Dv(e){Xe.setImmediate?setImmediate(e):setTimeout(e,0)}function Fv(e,t){return e.reduce((r,n,a)=>{var s=t(n,a);return s&&(r[s[0]]=s[1]),r},{})}function jn(e,t){if(typeof t=="string"&&_r(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,a=t.length;n<a;++n){var s=jn(e,t[n]);r.push(s)}return r}var l=t.indexOf(".");if(l!==-1){var o=e[t.substr(0,l)];return o==null?void 0:jn(o,t.substr(l+1))}}function Gr(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){ki(typeof r!="string"&&"length"in r);for(var n=0,a=t.length;n<a;++n)Gr(e,t[n],r[n])}else{var s=t.indexOf(".");if(s!==-1){var l=t.substr(0,s),o=t.substr(s+1);if(o==="")r===void 0?Ut(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=r;else{var c=e[l];c&&_r(e,l)||(c=e[l]={}),Gr(c,o,r)}}else r===void 0?Ut(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Ov(e){var t={};for(var r in e)_r(e,r)&&(t[r]=e[r]);return t}const kT=[].concat;function Pv(e){return kT.apply([],e)}const Iv="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Pv([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>Xe[e]),CT=Iv.map(e=>Xe[e]);Fv(Iv,e=>[e,!0]);let $n=null;function zl(e){$n=typeof WeakMap<"u"&&new WeakMap;const t=id(e);return $n=null,t}function id(e){if(!e||typeof e!="object")return e;let t=$n&&$n.get(e);if(t)return t;if(Ut(e)){t=[],$n&&$n.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(id(e[r]))}else if(CT.indexOf(e.constructor)>=0)t=e;else{const s=El(e);for(var a in t=s===Object.prototype?{}:Object.create(s),$n&&$n.set(e,t),e)_r(e,a)&&(t[a]=id(e[a]))}return t}const{toString:AT}={};function ld(e){return AT.call(e).slice(8,-1)}const od=typeof Symbol<"u"?Symbol.iterator:"@@iterator",DT=typeof od=="symbol"?function(e){var t;return e!=null&&(t=e[od])&&t.apply(e)}:function(){return null},ds={};function pn(e){var t,r,n,a;if(arguments.length===1){if(Ut(e))return e.slice();if(this===ds&&typeof e=="string")return[e];if(a=DT(e)){for(r=[];!(n=a.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const qf=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var on=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Rv(e,t){on=e,Lv=t}var Lv=()=>!0;const FT=!new Error("").stack;function ts(){if(FT)try{throw ts.arguments,new Error}catch(e){return e}return new Error}function cd(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(Lv).map(n=>`
`+n).join("")):""}var Mv=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Qf=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Mv),OT={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ls(e,t){this._e=ts(),this.name=e,this.message=t}function Bv(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,a)=>a.indexOf(r)===n).join(`
`)}function Ic(e,t,r,n){this._e=ts(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=Bv(e,t)}function Ki(e,t){this._e=ts(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=Bv(e,t)}Rs(Ls).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+cd(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Rs(Ic).from(Ls),Rs(Ki).from(Ls);var Jf=Qf.reduce((e,t)=>(e[t]=t+"Error",e),{});const PT=Ls;var Se=Qf.reduce((e,t)=>{var r=t+"Error";function n(a,s){this._e=ts(),this.name=r,a?typeof a=="string"?(this.message=`${a}${s?`
 `+s:""}`,this.inner=s||null):typeof a=="object"&&(this.message=`${a.name} ${a.message}`,this.inner=a):(this.message=OT[t]||r,this.inner=null)}return Rs(n).from(PT),e[t]=n,e},{});Se.Syntax=SyntaxError,Se.Type=TypeError,Se.Range=RangeError;var hx=Mv.reduce((e,t)=>(e[t+"Error"]=Se[t],e),{}),Wo=Qf.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Se[t]),e),{});function Ve(){}function jl(e){return e}function IT(e,t){return e==null||e===jl?t:function(r){return t(e(r))}}function Ha(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function RT(e,t){return e===Ve?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Ha(n,this.onsuccess):n),a&&(this.onerror=this.onerror?Ha(a,this.onerror):a),s!==void 0?s:r}}function LT(e,t){return e===Ve?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Ha(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Ha(n,this.onerror):n)}}function MT(e,t){return e===Ve?t:function(r){var n=e.apply(this,arguments);Qt(r,n);var a=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?Ha(a,this.onsuccess):a),s&&(this.onerror=this.onerror?Ha(s,this.onerror):s),n===void 0?l===void 0?void 0:l:Qt(n,l)}}function BT(e,t){return e===Ve?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Zf(e,t){return e===Ve?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,a=arguments.length,s=new Array(a);a--;)s[a]=arguments[a];return r.then(function(){return t.apply(n,s)})}return t.apply(this,arguments)}}Wo.ModifyError=Ic,Wo.DexieError=Ls,Wo.BulkError=Ki;var Sl={};const Uv=100,[ud,Rc,dd]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,El(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,El(t),e]})(),$v=Rc&&Rc.then,zo=ud&&ud.constructor,eh=!!dd;var fd=!1,UT=dd?()=>{dd.then(_o)}:Xe.setImmediate?setImmediate.bind(null,_o):Xe.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{_o(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(_o,0)},Gi=function(e,t){Ci.push([e,t]),Lc&&(UT(),Lc=!1)},hd=!0,Lc=!0,Fa=[],Ho=[],md=null,xd=jl,Ms={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:px,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{px(e[0],e[1])}catch{}})}},Ee=Ms,Ci=[],Oa=0,Vo=[];function xe(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Ve,this._lib=!1;var t=this._PSD=Ee;if(on&&(this._stackHolder=ts(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Sl)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&gd(this,this._value))}this._state=null,this._value=null,++t.ref,zv(this,e)}const pd={get:function(){var e=Ee,t=Mc;function r(n,a){var s=!e.global&&(e!==Ee||t!==Mc);const l=s&&!Fn();var o=new xe((c,u)=>{th(this,new Wv(Bc(n,e,s,l),Bc(a,e,s,l),c,u,e))});return on&&Kv(o,this),o}return r.prototype=Sl,r},set:function(e){En(this,"then",e&&e.prototype===Sl?pd:{get:function(){return e},set:pd.set})}};function Wv(e,t,r,n,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=a}function zv(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Hl();r&&typeof r.then=="function"?zv(e,(a,s)=>{r instanceof xe?r._then(a,s):r.then(a,s)}):(e._state=!0,e._value=r,Hv(e)),n&&Vl()}},gd.bind(null,e))}catch(r){gd(e,r)}}function gd(e,t){if(Ho.push(t),e._state===null){var r=e._lib&&Hl();t=xd(t),e._state=!1,e._value=t,on&&t!==null&&typeof t=="object"&&!t._promise&&function(n,a,s){try{n.apply(null,s)}catch{}}(()=>{var n=Yf(t,"stack");t._promise=e,En(t,"stack",{get:()=>fd?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){Fa.some(a=>a._value===n._value)||Fa.push(n)}(e),Hv(e),r&&Vl()}}function Hv(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)th(e,t[r]);var a=e._PSD;--a.ref||a.finalize(),Oa===0&&(++Oa,Gi(()=>{--Oa==0&&rh()},[]))}function th(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Oa,Gi($T,[r,e,t])}else e._listeners.push(t)}function $T(e,t,r){try{md=t;var n,a=t._value;t._state?n=e(a):(Ho.length&&(Ho=[]),n=e(a),Ho.indexOf(a)===-1&&function(s){for(var l=Fa.length;l;)if(Fa[--l]._value===s._value)return void Fa.splice(l,1)}(t)),r.resolve(n)}catch(s){r.reject(s)}finally{md=null,--Oa==0&&rh(),--r.psd.ref||r.psd.finalize()}}function Vv(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var a,s,l=e._value;l!=null?(a=l.name||"Error",s=l.message||l,n=cd(l,0)):(a=l,s=""),t.push(a+(s?": "+s:"")+n)}return on&&((n=cd(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&Vv(e._prev,t,r)),t}function Kv(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function _o(){Hl()&&Vl()}function Hl(){var e=hd;return hd=!1,Lc=!1,e}function Vl(){var e,t,r;do for(;Ci.length>0;)for(e=Ci,Ci=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(Ci.length>0);hd=!0,Lc=!0}function rh(){var e=Fa;Fa=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=Vo.slice(0),r=t.length;r;)t[--r]()}function No(e){return new xe(Sl,!1,e)}function Qe(e,t){var r=Ee;return function(){var n=Hl(),a=Ee;try{return fa(r,!0),e.apply(this,arguments)}catch(s){t&&t(s)}finally{fa(a,!1),n&&Vl()}}}Ys(xe.prototype,{then:pd,_then:function(e,t){th(this,new Wv(null,null,e,t,Ee))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):No(n)):this.then(null,n=>n&&n.name===t?r(n):No(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),No(t)))},stack:{get:function(){if(this._stack)return this._stack;try{fd=!0;var e=Vv(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{fd=!1}}},timeout:function(e,t){return e<1/0?new xe((r,n)=>{var a=setTimeout(()=>n(new Se.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&En(xe.prototype,Symbol.toStringTag,"Dexie.Promise"),Ms.env=Gv(),Ys(xe,{all:function(){var e=pn.apply(null,arguments).map(bo);return new xe(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((a,s)=>xe.resolve(a).then(l=>{e[s]=l,--n||t(e)},r))})},resolve:e=>{if(e instanceof xe)return e;if(e&&typeof e.then=="function")return new xe((r,n)=>{e.then(r,n)});var t=new xe(Sl,!0,e);return Kv(t,md),t},reject:No,race:function(){var e=pn.apply(null,arguments).map(bo);return new xe((t,r)=>{e.map(n=>xe.resolve(n).then(t,r))})},PSD:{get:()=>Ee,set:e=>Ee=e},totalEchoes:{get:()=>Mc},newPSD:da,usePSD:li,scheduler:{get:()=>Gi,set:e=>{Gi=e}},rejectionMapper:{get:()=>xd,set:e=>{xd=e}},follow:(e,t)=>new xe((r,n)=>da((a,s)=>{var l=Ee;l.unhandleds=[],l.onunhandled=s,l.finalize=Ha(function(){(function(o){function c(){o(),Vo.splice(Vo.indexOf(c),1)}Vo.push(c),++Oa,Gi(()=>{--Oa==0&&rh()},[])})(()=>{this.unhandleds.length===0?a():s(this.unhandleds[0])})},l.finalize),e()},t,r,n))}),zo&&(zo.allSettled&&En(xe,"allSettled",function(){const e=pn.apply(null,arguments).map(bo);return new xe(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((a,s)=>xe.resolve(a).then(l=>n[s]={status:"fulfilled",value:l},l=>n[s]={status:"rejected",reason:l}).then(()=>--r||t(n)))})}),zo.any&&typeof AggregateError<"u"&&En(xe,"any",function(){const e=pn.apply(null,arguments).map(bo);return new xe((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const a=new Array(n);e.forEach((s,l)=>xe.resolve(s).then(o=>t(o),o=>{a[l]=o,--n||r(new AggregateError(a))}))})}));const Bt={awaits:0,echoes:0,id:0};var WT=0,Ko=[],e0=0,Mc=0,zT=0;function da(e,t,r,n){var a=Ee,s=Object.create(a);s.parent=a,s.ref=0,s.global=!1,s.id=++zT;var l=Ms.env;s.env=eh?{Promise:xe,PromiseProp:{value:xe,configurable:!0,writable:!0},all:xe.all,race:xe.race,allSettled:xe.allSettled,any:xe.any,resolve:xe.resolve,reject:xe.reject,nthen:mx(l.nthen,s),gthen:mx(l.gthen,s)}:{},t&&Qt(s,t),++a.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=li(s,e,r,n);return s.ref===0&&s.finalize(),o}function ii(){return Bt.id||(Bt.id=++WT),++Bt.awaits,Bt.echoes+=Uv,Bt.id}function Fn(){return!!Bt.awaits&&(--Bt.awaits==0&&(Bt.id=0),Bt.echoes=Bt.awaits*Uv,!0)}function bo(e){return Bt.echoes&&e&&e.constructor===zo?(ii(),e.then(t=>(Fn(),t),t=>(Fn(),gt(t)))):e}function HT(e){++Mc,Bt.echoes&&--Bt.echoes!=0||(Bt.echoes=Bt.id=0),Ko.push(Ee),fa(e,!0)}function VT(){var e=Ko[Ko.length-1];Ko.pop(),fa(e,!1)}function fa(e,t){var r=Ee;if((t?!Bt.echoes||e0++&&e===Ee:!e0||--e0&&e===Ee)||Xv(t?HT.bind(null,e):VT),e!==Ee&&(Ee=e,r===Ms&&(Ms.env=Gv()),eh)){var n=Ms.env.Promise,a=e.env;Rc.then=a.nthen,n.prototype.then=a.gthen,(r.global||e.global)&&(Object.defineProperty(Xe,"Promise",a.PromiseProp),n.all=a.all,n.race=a.race,n.resolve=a.resolve,n.reject=a.reject,a.allSettled&&(n.allSettled=a.allSettled),a.any&&(n.any=a.any))}}function Gv(){var e=Xe.Promise;return eh?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Xe,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Rc.then,gthen:e.prototype.then}:{}}function li(e,t,r,n,a){var s=Ee;try{return fa(e,!0),t(r,n,a)}finally{fa(s,!1)}}function Xv(e){$v.call(ud,e)}function Bc(e,t,r,n){return typeof e!="function"?e:function(){var a=Ee;r&&ii(),fa(t,!0);try{return e.apply(this,arguments)}finally{fa(a,!1),n&&Xv(Fn)}}}function mx(e,t){return function(r,n){return e.call(this,Bc(r,t),Bc(n,t))}}(""+$v).indexOf("[native code]")===-1&&(ii=Fn=Ve);const xx="unhandledrejection";function px(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,a={promise:t,reason:e};if(Xe.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(xx,!0,!0),Qt(n,a)):Xe.CustomEvent&&Qt(n=new CustomEvent(xx,{detail:a}),a),n&&Xe.dispatchEvent&&(dispatchEvent(n),!Xe.PromiseRejectionEvent&&Xe.onunhandledrejection))try{Xe.onunhandledrejection(n)}catch{}on&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var gt=xe.reject;function vd(e,t,r,n){if(e.idbdb&&(e._state.openComplete||Ee.letThrough||e._vip)){var a=e._createTransaction(t,r,e._dbSchema);try{a.create(),e._state.PR1398_maxLoop=3}catch(s){return s.name===Jf.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>vd(e,t,r,n))):gt(s)}return a._promise(t,(s,l)=>da(()=>(Ee.trans=a,n(s,l,a)))).then(s=>a._completion.then(()=>s))}if(e._state.openComplete)return gt(new Se.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return gt(new Se.DatabaseClosed);e.open().catch(Ve)}return e._state.dbReadyPromise.then(()=>vd(e,t,r,n))}const gx="3.2.7",ka="￿",yd=-1/0,fn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Yv="String expected.",Xi=[],hu=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),KT=hu,GT=hu,qv=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),mu="__dbnames",t0="readonly",r0="readwrite";function Va(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const Qv={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Eo(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=zl(t))[e],t)}class XT{_trans(t,r,n){const a=this._tx||Ee.trans,s=this.name;function l(c,u,d){if(!d.schema[s])throw new Se.NotFound("Table "+s+" not part of transaction");return r(d.idbtrans,d)}const o=Hl();try{return a&&a.db===this.db?a===Ee.trans?a._promise(t,l,n):da(()=>a._promise(t,l,n),{trans:a,transless:Ee.transless||Ee}):vd(this.db,t,[this.name],l)}finally{o&&Vl()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(a=>this.hook.reading.fire(a))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Ut(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=ft(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(u=>{if(u.compound&&r.every(d=>u.keyPath.indexOf(d)>=0)){for(let d=0;d<r.length;++d)if(r.indexOf(u.keyPath[d])===-1)return!1;return!0}return!1}).sort((u,d)=>u.keyPath.length-d.keyPath.length)[0];if(n&&this.db._maxKey!==ka){const u=n.keyPath.slice(0,r.length);return this.where(u).equals(u.map(d=>t[d]))}!n&&on&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:a}=this.schema,s=this.db._deps.indexedDB;function l(u,d){try{return s.cmp(u,d)===0}catch{return!1}}const[o,c]=r.reduce(([u,d],f)=>{const h=a[f],x=t[f];return[u||h,u||!h?Va(d,h&&h.multi?g=>{const m=jn(g,f);return Ut(m)&&m.some(_=>l(x,_))}:g=>l(x,jn(g,f))):d]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(c):n?this.filter(c):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Ut(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=n=>{if(!n)return n;const a=Object.create(t.prototype);for(var s in n)if(_r(n,s))try{a[s]=n[s]}catch{}return a};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){Qt(this,t)})}add(t,r){const{auto:n,keyPath:a}=this.schema.primKey;let s=t;return a&&n&&(s=Eo(a)(t)),this._trans("readwrite",l=>this.core.mutate({trans:l,type:"add",keys:r!=null?[r]:null,values:[s]})).then(l=>l.numFailures?xe.reject(l.failures[0]):l.lastResult).then(l=>{if(a)try{Gr(t,a,l)}catch{}return l})}update(t,r){if(typeof t!="object"||Ut(t))return this.where(":id").equals(t).modify(r);{const n=jn(t,this.schema.primKey.keyPath);if(n===void 0)return gt(new Se.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?ft(r).forEach(a=>{Gr(t,a,r[a])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:a}=this.schema.primKey;let s=t;return a&&n&&(s=Eo(a)(t)),this._trans("readwrite",l=>this.core.mutate({trans:l,type:"put",values:[s],keys:r!=null?[r]:null})).then(l=>l.numFailures?xe.reject(l.failures[0]):l.lastResult).then(l=>{if(a)try{Gr(t,a,l)}catch{}return l})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?xe.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:Qv})).then(t=>t.numFailures?xe.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(a=>this.hook.reading.fire(a))))}bulkAdd(t,r,n){const a=Array.isArray(r)?r:void 0,s=(n=n||(a?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",l=>{const{auto:o,keyPath:c}=this.schema.primKey;if(c&&a)throw new Se.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let d=c&&o?t.map(Eo(c)):t;return this.core.mutate({trans:l,type:"add",keys:a,values:d,wantResults:s}).then(({numFailures:f,results:h,lastResult:x,failures:g})=>{if(f===0)return s?h:x;throw new Ki(`${this.name}.bulkAdd(): ${f} of ${u} operations failed`,g)})})}bulkPut(t,r,n){const a=Array.isArray(r)?r:void 0,s=(n=n||(a?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",l=>{const{auto:o,keyPath:c}=this.schema.primKey;if(c&&a)throw new Se.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let d=c&&o?t.map(Eo(c)):t;return this.core.mutate({trans:l,type:"put",keys:a,values:d,wantResults:s}).then(({numFailures:f,results:h,lastResult:x,failures:g})=>{if(f===0)return s?h:x;throw new Ki(`${this.name}.bulkPut(): ${f} of ${u} operations failed`,g)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:a,failures:s})=>{if(n===0)return a;throw new Ki(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,s)})}}function Yi(e){var t={},r=function(l,o){if(o){for(var c=arguments.length,u=new Array(c-1);--c;)u[c-1]=arguments[c];return t[l].subscribe.apply(null,u),e}if(typeof l=="string")return t[l]};r.addEventType=s;for(var n=1,a=arguments.length;n<a;++n)s(arguments[n]);return r;function s(l,o,c){if(typeof l!="object"){var u;o||(o=BT),c||(c=Ve);var d={subscribers:[],fire:c,subscribe:function(f){d.subscribers.indexOf(f)===-1&&(d.subscribers.push(f),d.fire=o(d.fire,f))},unsubscribe:function(f){d.subscribers=d.subscribers.filter(function(h){return h!==f}),d.fire=d.subscribers.reduce(o,c)}};return t[l]=r[l]=d,d}ft(u=l).forEach(function(f){var h=u[f];if(Ut(h))s(f,u[f][0],u[f][1]);else{if(h!=="asap")throw new Se.InvalidArgument("Invalid event config");var x=s(f,jl,function(){for(var g=arguments.length,m=new Array(g);g--;)m[g]=arguments[g];x.subscribers.forEach(function(_){Dv(function(){_.apply(null,m)})})})}})}}function Ni(e,t){return Rs(t).from({prototype:e}),t}function ls(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function n0(e,t){e.filter=Va(e.filter,t)}function a0(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>Va(n(),t()):t,e.justLimit=r&&!n}function Go(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new Se.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function vx(e,t,r){const n=Go(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function jo(e,t,r,n){const a=e.replayFilter?Va(e.filter,e.replayFilter()):e.filter;if(e.or){const s={},l=(o,c,u)=>{if(!a||a(c,u,h=>c.stop(h),h=>c.fail(h))){var d=c.primaryKey,f=""+d;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(d)),_r(s,f)||(s[f]=!0,t(o,c,u))}};return Promise.all([e.or._iterate(l,r),yx(vx(e,n,r),e.algorithm,l,!e.keysOnly&&e.valueMapper)])}return yx(vx(e,n,r),Va(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function yx(e,t,r,n){var a=Qe(n?(s,l,o)=>r(n(s),l,o):r);return e.then(s=>{if(s)return s.start(()=>{var l=()=>s.continue();t&&!t(s,o=>l=o,o=>{s.stop(o),l=Ve},o=>{s.fail(o),l=Ve})||a(s.value,s,o=>l=o),l()})})}function Xt(e,t){try{const r=wx(e),n=wx(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(a,s){const l=a.length,o=s.length,c=l<o?l:o;for(let u=0;u<c;++u)if(a[u]!==s[u])return a[u]<s[u]?-1:1;return l===o?0:l<o?-1:1}(_x(e),_x(t));case"Array":return function(a,s){const l=a.length,o=s.length,c=l<o?l:o;for(let u=0;u<c;++u){const d=Xt(a[u],s[u]);if(d!==0)return d}return l===o?0:l<o?-1:1}(e,t)}}catch{}return NaN}function wx(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=ld(e);return r==="ArrayBuffer"?"binary":r}function _x(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class YT{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,gt.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,gt.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=Va(r.algorithm,t)}_iterate(t,r){return jo(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&Qt(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>jo(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,a=n.table.core;if(ls(n,!0))return a.count({trans:r,query:{index:Go(n,a.schema),range:n.range}}).then(l=>Math.min(l,n.limit));var s=0;return jo(n,()=>(++s,!1),r,a).then(()=>s)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),a=n[0],s=n.length-1;function l(u,d){return d?l(u[n[d]],d-1):u[a]}var o=this._ctx.dir==="next"?1:-1;function c(u,d){var f=l(u,s),h=l(d,s);return f<h?-o:f>h?o:0}return this.toArray(function(u){return u.sort(c)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&ls(n,!0)&&n.limit>0){const{valueMapper:a}=n,s=Go(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:s,range:n.range}}).then(({result:l})=>a?l.map(a):l)}{const a=[];return jo(n,s=>a.push(s),r,n.table.core).then(()=>a)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,ls(r)?a0(r,()=>{var n=t;return(a,s)=>n===0||(n===1?(--n,!1):(s(()=>{a.advance(n),n=0}),!1))}):a0(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),a0(this._ctx,()=>{var r=t;return function(n,a,s){return--r<=0&&a(s),r>=0}},!0),this}until(t,r){return n0(this._ctx,function(n,a,s){return!t(n.value)||(a(s),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return n0(this._ctx,function(a){return t(a.value)}),r=this._ctx,n=t,r.isMatch=Va(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,a){t(a.key,a)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,a){t(a.primaryKey,a)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(a,s){n.push(s.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&ls(r,!0)&&r.limit>0)return this._read(a=>{var s=Go(r,r.table.core.schema);return r.table.core.query({trans:a,values:!1,limit:r.limit,query:{index:s,range:r.range}})}).then(({result:a})=>a).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(a,s){n.push(s.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return n0(this._ctx,function(a){var s=a.primaryKey.toString(),l=_r(n,s);return n[s]=!0,!l}),this}modify(t){var r=this._ctx;return this._write(n=>{var a;if(typeof t=="function")a=t;else{var s=ft(t),l=s.length;a=function(m){for(var _=!1,v=0;v<l;++v){var p=s[v],w=t[p];jn(m,p)!==w&&(Gr(m,p,w),_=!0)}return _}}const o=r.table.core,{outbound:c,extractKey:u}=o.schema.primaryKey,d=this.db._options.modifyChunkSize||200,f=[];let h=0;const x=[],g=(m,_)=>{const{failures:v,numFailures:p}=_;h+=m-p;for(let w of ft(v))f.push(v[w])};return this.clone().primaryKeys().then(m=>{const _=v=>{const p=Math.min(d,m.length-v);return o.getMany({trans:n,keys:m.slice(v,v+p),cache:"immutable"}).then(w=>{const T=[],I=[],L=c?[]:null,j=[];for(let y=0;y<p;++y){const O=w[y],B={value:zl(O),primKey:m[v+y]};a.call(B,B.value,B)!==!1&&(B.value==null?j.push(m[v+y]):c||Xt(u(O),u(B.value))===0?(I.push(B.value),c&&L.push(m[v+y])):(j.push(m[v+y]),T.push(B.value)))}const A=ls(r)&&r.limit===1/0&&(typeof t!="function"||t===s0)&&{index:r.index,range:r.range};return Promise.resolve(T.length>0&&o.mutate({trans:n,type:"add",values:T}).then(y=>{for(let O in y.failures)j.splice(parseInt(O),1);g(T.length,y)})).then(()=>(I.length>0||A&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:L,values:I,criteria:A,changeSpec:typeof t!="function"&&t}).then(y=>g(I.length,y))).then(()=>(j.length>0||A&&t===s0)&&o.mutate({trans:n,type:"delete",keys:j,criteria:A}).then(y=>g(j.length,y))).then(()=>m.length>v+p&&_(v+d))})};return _(0).then(()=>{if(f.length>0)throw new Ic("Error modifying one or more objects",f,h,x);return m.length})})})}delete(){var t=this._ctx,r=t.range;return ls(t)&&(t.isPrimKey&&!GT||r.type===3)?this._write(n=>{const{primaryKey:a}=t.table.core.schema,s=r;return t.table.core.count({trans:n,query:{index:a,range:s}}).then(l=>t.table.core.mutate({trans:n,type:"deleteRange",range:s}).then(({failures:o,lastResult:c,results:u,numFailures:d})=>{if(d)throw new Ic("Could not delete some values",Object.keys(o).map(f=>o[f]),l-d);return l-d}))}):this.modify(s0)}}const s0=(e,t)=>t.value=null;function qT(e,t){return e<t?-1:e===t?0:1}function QT(e,t){return e>t?-1:e===t?0:1}function ur(e,t,r){var n=e instanceof Zv?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function os(e){return new e.Collection(e,()=>Jv("")).limit(0)}function JT(e,t,r,n,a,s){for(var l=Math.min(e.length,n.length),o=-1,c=0;c<l;++c){var u=t[c];if(u!==n[c])return a(e[c],r[c])<0?e.substr(0,c)+r[c]+r.substr(c+1):a(e[c],n[c])<0?e.substr(0,c)+n[c]+r.substr(c+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;a(e[c],u)<0&&(o=c)}return l<n.length&&s==="next"?e+r.substr(e.length):l<e.length&&s==="prev"?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function So(e,t,r,n){var a,s,l,o,c,u,d,f=r.length;if(!r.every(m=>typeof m=="string"))return ur(e,Yv);function h(m){a=function(v){return v==="next"?p=>p.toUpperCase():p=>p.toLowerCase()}(m),s=function(v){return v==="next"?p=>p.toLowerCase():p=>p.toUpperCase()}(m),l=m==="next"?qT:QT;var _=r.map(function(v){return{lower:s(v),upper:a(v)}}).sort(function(v,p){return l(v.lower,p.lower)});o=_.map(function(v){return v.upper}),c=_.map(function(v){return v.lower}),u=m,d=m==="next"?"":n}h("next");var x=new e.Collection(e,()=>Mn(o[0],c[f-1]+n));x._ondirectionchange=function(m){h(m)};var g=0;return x._addAlgorithm(function(m,_,v){var p=m.key;if(typeof p!="string")return!1;var w=s(p);if(t(w,c,g))return!0;for(var T=null,I=g;I<f;++I){var L=JT(p,w,o[I],c[I],l,u);L===null&&T===null?g=I+1:(T===null||l(T,L)>0)&&(T=L)}return _(T!==null?function(){m.continue(T+d)}:v),!1}),x}function Mn(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function Jv(e){return{type:1,lower:e,upper:e}}class Zv{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,a){n=n!==!1,a=a===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||a)&&(!n||!a)?os(this):new this.Collection(this,()=>Mn(t,r,!n,!a))}catch{return ur(this,fn)}}equals(t){return t==null?ur(this,fn):new this.Collection(this,()=>Jv(t))}above(t){return t==null?ur(this,fn):new this.Collection(this,()=>Mn(t,void 0,!0))}aboveOrEqual(t){return t==null?ur(this,fn):new this.Collection(this,()=>Mn(t,void 0,!1))}below(t){return t==null?ur(this,fn):new this.Collection(this,()=>Mn(void 0,t,!1,!0))}belowOrEqual(t){return t==null?ur(this,fn):new this.Collection(this,()=>Mn(void 0,t))}startsWith(t){return typeof t!="string"?ur(this,Yv):this.between(t,t+ka,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):So(this,(r,n)=>r.indexOf(n[0])===0,[t],ka)}equalsIgnoreCase(t){return So(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=pn.apply(ds,arguments);return t.length===0?os(this):So(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=pn.apply(ds,arguments);return t.length===0?os(this):So(this,(r,n)=>n.some(a=>r.indexOf(a)===0),t,ka)}anyOf(){const t=pn.apply(ds,arguments);let r=this._cmp;try{t.sort(r)}catch{return ur(this,fn)}if(t.length===0)return os(this);const n=new this.Collection(this,()=>Mn(t[0],t[t.length-1]));n._ondirectionchange=s=>{r=s==="next"?this._ascending:this._descending,t.sort(r)};let a=0;return n._addAlgorithm((s,l,o)=>{const c=s.key;for(;r(c,t[a])>0;)if(++a,a===t.length)return l(o),!1;return r(c,t[a])===0||(l(()=>{s.continue(t[a])}),!1)}),n}notEqual(t){return this.inAnyRange([[yd,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=pn.apply(ds,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ur(this,fn)}const r=t.reduce((n,a)=>n?n.concat([[n[n.length-1][1],a]]):[[yd,a]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,a=this._ascending,s=this._descending,l=this._min,o=this._max;if(t.length===0)return os(this);if(!t.every(p=>p[0]!==void 0&&p[1]!==void 0&&a(p[0],p[1])<=0))return ur(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Se.InvalidArgument);const c=!r||r.includeLowers!==!1,u=r&&r.includeUppers===!0;let d,f=a;function h(p,w){return f(p[0],w[0])}try{d=t.reduce(function(p,w){let T=0,I=p.length;for(;T<I;++T){const L=p[T];if(n(w[0],L[1])<0&&n(w[1],L[0])>0){L[0]=l(L[0],w[0]),L[1]=o(L[1],w[1]);break}}return T===I&&p.push(w),p},[]),d.sort(h)}catch{return ur(this,fn)}let x=0;const g=u?p=>a(p,d[x][1])>0:p=>a(p,d[x][1])>=0,m=c?p=>s(p,d[x][0])>0:p=>s(p,d[x][0])>=0;let _=g;const v=new this.Collection(this,()=>Mn(d[0][0],d[d.length-1][1],!c,!u));return v._ondirectionchange=p=>{p==="next"?(_=g,f=a):(_=m,f=s),d.sort(h)},v._addAlgorithm((p,w,T)=>{for(var I=p.key;_(I);)if(++x,x===d.length)return w(T),!1;return!!function(L){return!g(L)&&!m(L)}(I)||(this._cmp(I,d[x][1])===0||this._cmp(I,d[x][0])===0||w(()=>{f===a?p.continue(d[x][0]):p.continue(d[x][1])}),!1)}),v}startsWithAnyOf(){const t=pn.apply(ds,arguments);return t.every(r=>typeof r=="string")?t.length===0?os(this):this.inAnyRange(t.map(r=>[r,r+ka])):ur(this,"startsWithAnyOf() only works with strings")}}function tn(e){return Qe(function(t){return Tl(t),e(t.target.error),!1})}function Tl(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const kl="storagemutated",Vn="x-storagemutated-1",ha=Yi(null,kl);class ZT{_lock(){return ki(!Ee.global),++this._reculock,this._reculock!==1||Ee.global||(Ee.lockOwnerFor=this),this}_unlock(){if(ki(!Ee.global),--this._reculock==0)for(Ee.global||(Ee.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{li(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&Ee.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(ki(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new Se.DatabaseClosed(n);case"MissingAPIError":throw new Se.MissingAPI(n.message,n);default:throw new Se.OpenFailed(n)}if(!this.active)throw new Se.TransactionInactive;return ki(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Qe(a=>{Tl(a),this._reject(t.error)}),t.onabort=Qe(a=>{Tl(a),this.active&&this._reject(new Se.Abort(t.error)),this.active=!1,this.on("abort").fire(a)}),t.oncomplete=Qe(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&ha.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return gt(new Se.ReadOnly("Transaction is readonly"));if(!this.active)return gt(new Se.TransactionInactive);if(this._locked())return new xe((s,l)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(s,l)},Ee])});if(n)return da(()=>{var s=new xe((l,o)=>{this._lock();const c=r(l,o,this);c&&c.then&&c.then(l,o)});return s.finally(()=>this._unlock()),s._lib=!0,s});var a=new xe((s,l)=>{var o=r(s,l,this);o&&o.then&&o.then(s,l)});return a._lib=!0,a}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=xe.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var a=r.idbtrans.objectStore(r.storeNames[0]);(function l(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(a.get(-1/0).onsuccess=l)})()}var s=r._waitingFor;return new xe((l,o)=>{n.then(c=>r._waitingQueue.push(Qe(l.bind(null,c))),c=>r._waitingQueue.push(Qe(o.bind(null,c)))).finally(()=>{r._waitingFor===s&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Se.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(_r(r,t))return r[t];const n=this.schema[t];if(!n)throw new Se.NotFound("Table "+t+" not part of transaction");const a=new this.db.Table(t,n,this);return a.core=this.db.core.table(t),r[t]=a,a}}function wd(e,t,r,n,a,s,l){return{name:e,keyPath:t,unique:r,multi:n,auto:a,compound:s,src:(r&&!l?"&":"")+(n?"*":"")+(a?"++":"")+ey(t)}}function ey(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function ty(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:Fv(r,n=>[n.name,n])}}let Cl=e=>{try{return e.only([[]]),Cl=()=>[[]],[[]]}catch{return Cl=()=>ka,ka}};function _d(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>jn(n,t)}(e):t=>jn(t,e)}function Nx(e){return[].slice.call(e)}let e6=0;function qi(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function t6(e,t,r){function n(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:d,lowerOpen:f,upperOpen:h}=c;return u===void 0?d===void 0?null:t.upperBound(d,!!h):d===void 0?t.lowerBound(u,!!f):t.bound(u,d,!!f,!!h)}const{schema:a,hasGetAll:s}=function(c,u){const d=Nx(c.objectStoreNames);return{schema:{name:c.name,tables:d.map(f=>u.objectStore(f)).map(f=>{const{keyPath:h,autoIncrement:x}=f,g=Ut(h),m=h==null,_={},v={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:m,compound:g,keyPath:h,autoIncrement:x,unique:!0,extractKey:_d(h)},indexes:Nx(f.indexNames).map(p=>f.index(p)).map(p=>{const{name:w,unique:T,multiEntry:I,keyPath:L}=p,j={name:w,compound:Ut(L),keyPath:L,unique:T,multiEntry:I,extractKey:_d(L)};return _[qi(L)]=j,j}),getIndexByKeyPath:p=>_[qi(p)]};return _[":id"]=v.primaryKey,h!=null&&(_[qi(h)]=v.primaryKey),v})},hasGetAll:d.length>0&&"getAll"in u.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),l=a.tables.map(c=>function(u){const d=u.name;return{name:d,schema:u,mutate:function({trans:f,type:h,keys:x,values:g,range:m}){return new Promise((_,v)=>{_=Qe(_);const p=f.objectStore(d),w=p.keyPath==null,T=h==="put"||h==="add";if(!T&&h!=="delete"&&h!=="deleteRange")throw new Error("Invalid operation type: "+h);const{length:I}=x||g||{length:1};if(x&&g&&x.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(I===0)return _({numFailures:0,failures:{},results:[],lastResult:void 0});let L;const j=[],A=[];let y=0;const O=H=>{++y,Tl(H)};if(h==="deleteRange"){if(m.type===4)return _({numFailures:y,failures:A,results:[],lastResult:void 0});m.type===3?j.push(L=p.clear()):j.push(L=p.delete(n(m)))}else{const[H,Q]=T?w?[g,x]:[g,null]:[x,null];if(T)for(let ie=0;ie<I;++ie)j.push(L=Q&&Q[ie]!==void 0?p[h](H[ie],Q[ie]):p[h](H[ie])),L.onerror=O;else for(let ie=0;ie<I;++ie)j.push(L=p[h](H[ie])),L.onerror=O}const B=H=>{const Q=H.target.result;j.forEach((ie,oe)=>ie.error!=null&&(A[oe]=ie.error)),_({numFailures:y,failures:A,results:h==="delete"?x:j.map(ie=>ie.result),lastResult:Q})};L.onerror=H=>{O(H),B(H)},L.onsuccess=B})},getMany:({trans:f,keys:h})=>new Promise((x,g)=>{x=Qe(x);const m=f.objectStore(d),_=h.length,v=new Array(_);let p,w=0,T=0;const I=j=>{const A=j.target;v[A._pos]=A.result,++T===w&&x(v)},L=tn(g);for(let j=0;j<_;++j)h[j]!=null&&(p=m.get(h[j]),p._pos=j,p.onsuccess=I,p.onerror=L,++w);w===0&&x(v)}),get:({trans:f,key:h})=>new Promise((x,g)=>{x=Qe(x);const m=f.objectStore(d).get(h);m.onsuccess=_=>x(_.target.result),m.onerror=tn(g)}),query:function(f){return h=>new Promise((x,g)=>{x=Qe(x);const{trans:m,values:_,limit:v,query:p}=h,w=v===1/0?void 0:v,{index:T,range:I}=p,L=m.objectStore(d),j=T.isPrimaryKey?L:L.index(T.name),A=n(I);if(v===0)return x({result:[]});if(f){const y=_?j.getAll(A,w):j.getAllKeys(A,w);y.onsuccess=O=>x({result:O.target.result}),y.onerror=tn(g)}else{let y=0;const O=_||!("openKeyCursor"in j)?j.openCursor(A):j.openKeyCursor(A),B=[];O.onsuccess=H=>{const Q=O.result;return Q?(B.push(_?Q.value:Q.primaryKey),++y===v?x({result:B}):void Q.continue()):x({result:B})},O.onerror=tn(g)}})}(s),openCursor:function({trans:f,values:h,query:x,reverse:g,unique:m}){return new Promise((_,v)=>{_=Qe(_);const{index:p,range:w}=x,T=f.objectStore(d),I=p.isPrimaryKey?T:T.index(p.name),L=g?m?"prevunique":"prev":m?"nextunique":"next",j=h||!("openKeyCursor"in I)?I.openCursor(n(w),L):I.openKeyCursor(n(w),L);j.onerror=tn(v),j.onsuccess=Qe(A=>{const y=j.result;if(!y)return void _(null);y.___id=++e6,y.done=!1;const O=y.continue.bind(y);let B=y.continuePrimaryKey;B&&(B=B.bind(y));const H=y.advance.bind(y),Q=()=>{throw new Error("Cursor not stopped")};y.trans=f,y.stop=y.continue=y.continuePrimaryKey=y.advance=()=>{throw new Error("Cursor not started")},y.fail=Qe(v),y.next=function(){let ie=1;return this.start(()=>ie--?this.continue():this.stop()).then(()=>this)},y.start=ie=>{const oe=new Promise((z,K)=>{z=Qe(z),j.onerror=tn(K),y.fail=K,y.stop=N=>{y.stop=y.continue=y.continuePrimaryKey=y.advance=Q,z(N)}}),we=()=>{if(j.result)try{ie()}catch(z){y.fail(z)}else y.done=!0,y.start=()=>{throw new Error("Cursor behind last entry")},y.stop()};return j.onsuccess=Qe(z=>{j.onsuccess=we,we()}),y.continue=O,y.continuePrimaryKey=B,y.advance=H,we(),oe},_(y)},v)})},count({query:f,trans:h}){const{index:x,range:g}=f;return new Promise((m,_)=>{const v=h.objectStore(d),p=x.isPrimaryKey?v:v.index(x.name),w=n(g),T=w?p.count(w):p.count();T.onsuccess=Qe(I=>m(I.target.result)),T.onerror=tn(_)})}}}(c)),o={};return l.forEach(c=>o[c.name]=c),{stack:"dbcore",transaction:e.transaction.bind(e),table(c){if(!o[c])throw new Error(`Table '${c}' not found`);return o[c]},MIN_KEY:-1/0,MAX_KEY:Cl(t),schema:a}}function Nd({_novip:e},t){const r=t.db,n=function(a,s,{IDBKeyRange:l,indexedDB:o},c){return{dbcore:function(d,f){return f.reduce((h,{create:x})=>({...h,...x(h)}),d)}(t6(s,l,c),a.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(a=>{const s=a.name;e.core.schema.tables.some(l=>l.name===s)&&(a.core=e.core.table(s),e[s]instanceof e.Table&&(e[s].core=a.core))})}function Uc({_novip:e},t,r,n){r.forEach(a=>{const s=n[a];t.forEach(l=>{const o=Yf(l,a);(!o||"value"in o&&o.value===void 0)&&(l===e.Transaction.prototype||l instanceof e.Transaction?En(l,a,{get(){return this.table(a)},set(c){Cv(this,a,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):l[a]=new e.Table(a,s))})})}function bd({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function r6(e,t){return e._cfg.version-t._cfg.version}function n6(e,t,r,n){const a=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,a);s.create(r),s._completion.catch(n);const l=s._reject.bind(s),o=Ee.transless||Ee;da(()=>{Ee.trans=s,Ee.transless=o,t===0?(ft(a).forEach(c=>{i0(r,c,a[c].primKey,a[c].indexes)}),Nd(e,r),xe.follow(()=>e.on.populate.fire(s)).catch(l)):function({_novip:c},u,d,f){const h=[],x=c._versions;let g=c._dbSchema=jd(c,c.idbdb,f),m=!1;const _=x.filter(p=>p._cfg.version>=u);function v(){return h.length?xe.resolve(h.shift()(d.idbtrans)).then(v):xe.resolve()}return _.forEach(p=>{h.push(()=>{const w=g,T=p._cfg.dbschema;Sd(c,w,f),Sd(c,T,f),g=c._dbSchema=T;const I=ry(w,T);I.add.forEach(j=>{i0(f,j[0],j[1].primKey,j[1].indexes)}),I.change.forEach(j=>{if(j.recreate)throw new Se.Upgrade("Not yet support for changing primary key");{const A=f.objectStore(j.name);j.add.forEach(y=>Ed(A,y)),j.change.forEach(y=>{A.deleteIndex(y.name),Ed(A,y)}),j.del.forEach(y=>A.deleteIndex(y))}});const L=p._cfg.contentUpgrade;if(L&&p._cfg.version>u){Nd(c,f),d._memoizedTables={},m=!0;let j=Ov(T);I.del.forEach(B=>{j[B]=w[B]}),bd(c,[c.Transaction.prototype]),Uc(c,[c.Transaction.prototype],ft(j),j),d.schema=j;const A=qf(L);let y;A&&ii();const O=xe.follow(()=>{if(y=L(d),y&&A){var B=Fn.bind(null,null);y.then(B,B)}});return y&&typeof y.then=="function"?xe.resolve(y):O.then(()=>y)}}),h.push(w=>{(!m||!KT)&&function(T,I){[].slice.call(I.db.objectStoreNames).forEach(L=>T[L]==null&&I.db.deleteObjectStore(L))}(p._cfg.dbschema,w),bd(c,[c.Transaction.prototype]),Uc(c,[c.Transaction.prototype],c._storeNames,c._dbSchema),d.schema=c._dbSchema})}),v().then(()=>{var p,w;w=f,ft(p=g).forEach(T=>{w.db.objectStoreNames.contains(T)||i0(w,T,p[T].primKey,p[T].indexes)})})}(e,t,s,r).catch(l)})}function ry(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const a=e[n],s=t[n];if(a){const l={name:n,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||a.primKey.auto!==s.primKey.auto&&!hu)l.recreate=!0,r.change.push(l);else{const o=a.idxByName,c=s.idxByName;let u;for(u in o)c[u]||l.del.push(u);for(u in c){const d=o[u],f=c[u];d?d.src!==f.src&&l.change.push(f):l.add.push(f)}(l.del.length>0||l.add.length>0||l.change.length>0)&&r.change.push(l)}}else r.add.push([n,s])}return r}function i0(e,t,r,n){const a=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(s=>Ed(a,s)),a}function Ed(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function jd(e,t,r){const n={};return Pc(t.objectStoreNames,0).forEach(a=>{const s=r.objectStore(a);let l=s.keyPath;const o=wd(ey(l),l||"",!1,!1,!!s.autoIncrement,l&&typeof l!="string",!0),c=[];for(let d=0;d<s.indexNames.length;++d){const f=s.index(s.indexNames[d]);l=f.keyPath;var u=wd(f.name,l,!!f.unique,!!f.multiEntry,!1,l&&typeof l!="string",!1);c.push(u)}n[a]=ty(a,o,c)}),n}function Sd({_novip:e},t,r){const n=r.db.objectStoreNames;for(let a=0;a<n.length;++a){const s=n[a],l=r.objectStore(s);e._hasGetAll="getAll"in l;for(let o=0;o<l.indexNames.length;++o){const c=l.indexNames[o],u=l.index(c).keyPath,d=typeof u=="string"?u:"["+Pc(u).join("+")+"]";if(t[s]){const f=t[s].idxByName[d];f&&(f.name=c,delete t[s].idxByName[d],t[s].idxByName[c]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Xe.WorkerGlobalScope&&Xe instanceof Xe.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class a6{_parseStoresSpec(t,r){ft(t).forEach(n=>{if(t[n]!==null){var a=t[n].split(",").map((l,o)=>{const c=(l=l.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return wd(c,u||null,/\&/.test(l),/\*/.test(l),/\+\+/.test(l),Ut(u),o===0)}),s=a.shift();if(s.multi)throw new Se.Schema("Primary key cannot be multi-valued");a.forEach(l=>{if(l.auto)throw new Se.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new Se.Schema("Index must have a name and cannot be an empty string")}),r[n]=ty(n,s,a)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?Qt(this._cfg.storesSource,t):t;const n=r._versions,a={};let s={};return n.forEach(l=>{Qt(a,l._cfg.storesSource),s=l._cfg.dbschema={},l._parseStoresSpec(a,s)}),r._dbSchema=s,bd(r,[r._allTables,r,r.Transaction.prototype]),Uc(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],ft(s),s),r._storeNames=ft(s),this}upgrade(t){return this._cfg.contentUpgrade=Zf(this._cfg.contentUpgrade||Ve,t),this}}function nh(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Pa(mu,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function ah(e){return e&&typeof e.databases=="function"}function Td(e){return da(function(){return Ee.letThrough=!0,e()})}function s6(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function i6(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?gt(t.dbOpenError):e);on&&(t.openCanceller._stackHolder=ts()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function a(){if(t.openCanceller!==n)throw new Se.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,l=null,o=!1;const c=()=>new xe((u,d)=>{if(a(),!r)throw new Se.MissingAPI;const f=e.name,h=t.autoSchema?r.open(f):r.open(f,Math.round(10*e.verno));if(!h)throw new Se.MissingAPI;h.onerror=tn(d),h.onblocked=Qe(e._fireOnBlocked),h.onupgradeneeded=Qe(x=>{if(l=h.transaction,t.autoSchema&&!e._options.allowEmptyDB){h.onerror=Tl,l.abort(),h.result.close();const m=r.deleteDatabase(f);m.onsuccess=m.onerror=Qe(()=>{d(new Se.NoSuchDatabase(`Database ${f} doesnt exist`))})}else{l.onerror=tn(d);var g=x.oldVersion>Math.pow(2,62)?0:x.oldVersion;o=g<1,e._novip.idbdb=h.result,n6(e,g/10,l,d)}},d),h.onsuccess=Qe(()=>{l=null;const x=e._novip.idbdb=h.result,g=Pc(x.objectStoreNames);if(g.length>0)try{const _=x.transaction((m=g).length===1?m[0]:m,"readonly");t.autoSchema?function({_novip:v},p,w){v.verno=p.version/10;const T=v._dbSchema=jd(0,p,w);v._storeNames=Pc(p.objectStoreNames,0),Uc(v,[v._allTables],ft(T),T)}(e,x,_):(Sd(e,e._dbSchema,_),function(v,p){const w=ry(jd(0,v.idbdb,p),v._dbSchema);return!(w.add.length||w.change.some(T=>T.add.length||T.change.length))}(e,_)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Nd(e,_)}catch{}var m;Xi.push(e),x.onversionchange=Qe(_=>{t.vcFired=!0,e.on("versionchange").fire(_)}),x.onclose=Qe(_=>{e.on("close").fire(_)}),o&&function({indexedDB:_,IDBKeyRange:v},p){!ah(_)&&p!==mu&&nh(_,v).put({name:p}).catch(Ve)}(e._deps,f),u()},d)}).catch(u=>u&&u.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c()):xe.reject(u));return xe.race([n,(typeof navigator>"u"?xe.resolve():s6()).then(c)]).then(()=>(a(),t.onReadyBeingFired=[],xe.resolve(Td(()=>e.on.ready.fire(e.vip))).then(function u(){if(t.onReadyBeingFired.length>0){let d=t.onReadyBeingFired.reduce(Zf,Ve);return t.onReadyBeingFired=[],xe.resolve(Td(()=>d(e.vip))).then(u)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(u=>{t.dbOpenError=u;try{l&&l.abort()}catch{}return n===t.openCanceller&&e._close(),gt(u)}).finally(()=>{t.openComplete=!0,s()})}function kd(e){var t=s=>e.next(s),r=a(t),n=a(s=>e.throw(s));function a(s){return l=>{var o=s(l),c=o.value;return o.done?c:c&&typeof c.then=="function"?c.then(r,n):Ut(c)?Promise.all(c).then(r,n):r(c)}}return a(t)()}function l6(e,t,r){var n=arguments.length;if(n<2)throw new Se.InvalidArgument("Too few arguments");for(var a=new Array(n-1);--n;)a[n-1]=arguments[n];return r=a.pop(),[e,Pv(a),r]}function ny(e,t,r,n,a){return xe.resolve().then(()=>{const s=Ee.transless||Ee,l=e._createTransaction(t,r,e._dbSchema,n),o={trans:l,transless:s};if(n)l.idbtrans=n.idbtrans;else try{l.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===Jf.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>ny(e,t,r,null,a))):gt(f)}const c=qf(a);let u;c&&ii();const d=xe.follow(()=>{if(u=a.call(l,l),u)if(c){var f=Fn.bind(null,null);u.then(f,f)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=kd(u))},o);return(u&&typeof u.then=="function"?xe.resolve(u).then(f=>l.active?f:gt(new Se.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):d.then(()=>u)).then(f=>(n&&l._resolve(),l._completion.then(()=>f))).catch(f=>(l._reject(f),gt(f)))})}function To(e,t,r){const n=Ut(e)?e.slice():[e];for(let a=0;a<r;++a)n.push(t);return n}const o6={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,a={},s=[];function l(d,f,h){const x=qi(d),g=a[x]=a[x]||[],m=d==null?0:typeof d=="string"?1:d.length,_=f>0,v={...h,isVirtual:_,keyTail:f,keyLength:m,extractKey:_d(d),unique:!_&&h.unique};return g.push(v),v.isPrimaryKey||s.push(v),m>1&&l(m===2?d[0]:d.slice(0,m-1),f+1,h),g.sort((p,w)=>p.keyTail-w.keyTail),v}const o=l(n.primaryKey.keyPath,0,n.primaryKey);a[":id"]=[o];for(const d of n.indexes)l(d.keyPath,0,d);function c(d){const f=d.query.index;return f.isVirtual?{...d,query:{index:f,range:(h=d.query.range,x=f.keyTail,{type:h.type===1?2:h.type,lower:To(h.lower,h.lowerOpen?e.MAX_KEY:e.MIN_KEY,x),lowerOpen:!0,upper:To(h.upper,h.upperOpen?e.MIN_KEY:e.MAX_KEY,x),upperOpen:!0})}}:d;var h,x}return{...r,schema:{...n,primaryKey:o,indexes:s,getIndexByKeyPath:function(d){const f=a[qi(d)];return f&&f[0]}},count:d=>r.count(c(d)),query:d=>r.query(c(d)),openCursor(d){const{keyTail:f,isVirtual:h,keyLength:x}=d.query.index;return h?r.openCursor(c(d)).then(g=>g&&function(m){return Object.create(m,{continue:{value:function(v){v!=null?m.continue(To(v,d.reverse?e.MAX_KEY:e.MIN_KEY,f)):d.unique?m.continue(m.key.slice(0,x).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,f)):m.continue()}},continuePrimaryKey:{value(v,p){m.continuePrimaryKey(To(v,e.MAX_KEY,f),p)}},primaryKey:{get:()=>m.primaryKey},key:{get(){const v=m.key;return x===1?v[0]:v.slice(0,x)}},value:{get:()=>m.value}})}(g)):r.openCursor(d)}}}}}};function sh(e,t,r,n){return r=r||{},n=n||"",ft(e).forEach(a=>{if(_r(t,a)){var s=e[a],l=t[a];if(typeof s=="object"&&typeof l=="object"&&s&&l){const o=ld(s);o!==ld(l)?r[n+a]=t[a]:o==="Object"?sh(s,l,r,n+a+"."):s!==l&&(r[n+a]=t[a])}else s!==l&&(r[n+a]=t[a])}else r[n+a]=void 0}),ft(t).forEach(a=>{_r(e,a)||(r[n+a]=t[a])}),r}const c6={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(s){const l=Ee.trans,{deleting:o,creating:c,updating:u}=l.table(t).hook;switch(s.type){case"add":if(c.fire===Ve)break;return l._promise("readwrite",()=>d(s),!0);case"put":if(c.fire===Ve&&u.fire===Ve)break;return l._promise("readwrite",()=>d(s),!0);case"delete":if(o.fire===Ve)break;return l._promise("readwrite",()=>d(s),!0);case"deleteRange":if(o.fire===Ve)break;return l._promise("readwrite",()=>function(h){return f(h.trans,h.range,1e4)}(s),!0)}return r.mutate(s);function d(h){const x=Ee.trans,g=h.keys||function(m,_){return _.type==="delete"?_.keys:_.keys||_.values.map(m.extractKey)}(n,h);if(!g)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?{...h,keys:g}:{...h}).type!=="delete"&&(h.values=[...h.values]),h.keys&&(h.keys=[...h.keys]),function(m,_,v){return _.type==="add"?Promise.resolve([]):m.getMany({trans:_.trans,keys:v,cache:"immutable"})}(r,h,g).then(m=>{const _=g.map((v,p)=>{const w=m[p],T={onerror:null,onsuccess:null};if(h.type==="delete")o.fire.call(T,v,w,x);else if(h.type==="add"||w===void 0){const I=c.fire.call(T,v,h.values[p],x);v==null&&I!=null&&(v=I,h.keys[p]=v,n.outbound||Gr(h.values[p],n.keyPath,v))}else{const I=sh(w,h.values[p]),L=u.fire.call(T,I,v,w,x);if(L){const j=h.values[p];Object.keys(L).forEach(A=>{_r(j,A)?j[A]=L[A]:Gr(j,A,L[A])})}}return T});return r.mutate(h).then(({failures:v,results:p,numFailures:w,lastResult:T})=>{for(let I=0;I<g.length;++I){const L=p?p[I]:g[I],j=_[I];L==null?j.onerror&&j.onerror(v[I]):j.onsuccess&&j.onsuccess(h.type==="put"&&m[I]?h.values[I]:L)}return{failures:v,results:p,numFailures:w,lastResult:T}}).catch(v=>(_.forEach(p=>p.onerror&&p.onerror(v)),Promise.reject(v)))})}function f(h,x,g){return r.query({trans:h,values:!1,query:{index:n,range:x},limit:g}).then(({result:m})=>d({type:"delete",keys:m,trans:h}).then(_=>_.numFailures>0?Promise.reject(_.failures[0]):m.length<g?{failures:[],numFailures:0,lastResult:void 0}:f(h,{...x,lower:m[m.length-1],lowerOpen:!0},g)))}}}}})};function ay(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let a=0,s=0;a<t.keys.length&&s<e.length;++a)Xt(t.keys[a],e[s])===0&&(n.push(r?zl(t.values[a]):t.values[a]),++s);return n.length===e.length?n:null}catch{return null}}const u6={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const a=ay(n.keys,n.trans._cache,n.cache==="clone");return a?xe.resolve(a):r.getMany(n).then(s=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?zl(s):s},s))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function ih(e){return!("from"in e)}const xn=function(e,t){if(!this){const r=new xn;return e&&"d"in e&&Qt(r,e),r}Qt(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Al(e,t,r){const n=Xt(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(ih(e))return Qt(e,{from:t,to:r,d:1});const a=e.l,s=e.r;if(Xt(r,e.from)<0)return a?Al(a,t,r):e.l={from:t,to:r,d:1,l:null,r:null},bx(e);if(Xt(t,e.to)>0)return s?Al(s,t,r):e.r={from:t,to:r,d:1,l:null,r:null},bx(e);Xt(t,e.from)<0&&(e.from=t,e.l=null,e.d=s?s.d+1:1),Xt(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const l=!e.r;a&&!e.l&&$c(e,a),s&&l&&$c(e,s)}function $c(e,t){ih(t)||function r(n,{from:a,to:s,l,r:o}){Al(n,a,s),l&&r(n,l),o&&r(n,o)}(e,t)}function d6(e,t){const r=Cd(t);let n=r.next();if(n.done)return!1;let a=n.value;const s=Cd(e);let l=s.next(a.from),o=l.value;for(;!n.done&&!l.done;){if(Xt(o.from,a.to)<=0&&Xt(o.to,a.from)>=0)return!0;Xt(a.from,o.from)<0?a=(n=r.next(o.from)).value:o=(l=s.next(a.from)).value}return!1}function Cd(e){let t=ih(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Xt(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Xt(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function bx(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),a=n>1?"r":n<-1?"l":"";if(a){const s=a==="r"?"l":"r",l={...e},o=e[a];e.from=o.from,e.to=o.to,e[a]=o[a],l[a]=o[s],e[s]=l,l.d=Ex(l)}e.d=Ex(e)}function Ex({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Ys(xn.prototype,{add(e){return $c(this,e),this},addKey(e){return Al(this,e,e),this},addKeys(e){return e.forEach(t=>Al(this,t,t)),this},[od](){return Cd(this)}});const f6={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new xn(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const a=e.table(n),{schema:s}=a,{primaryKey:l}=s,{extractKey:o,outbound:c}=l,u={...a,mutate:h=>{const x=h.trans,g=x.mutatedParts||(x.mutatedParts={}),m=L=>{const j=`idb://${t}/${n}/${L}`;return g[j]||(g[j]=new xn)},_=m(""),v=m(":dels"),{type:p}=h;let[w,T]=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[];const I=h.trans._cache;return a.mutate(h).then(L=>{if(Ut(w)){p!=="delete"&&(w=L.results),_.addKeys(w);const j=ay(w,I);j||p==="add"||v.addKeys(w),(j||T)&&function(A,y,O,B){function H(Q){const ie=A(Q.name||"");function oe(z){return z!=null?Q.extractKey(z):null}const we=z=>Q.multiEntry&&Ut(z)?z.forEach(K=>ie.addKey(K)):ie.addKey(z);(O||B).forEach((z,K)=>{const N=O&&oe(O[K]),D=B&&oe(B[K]);Xt(N,D)!==0&&(N!=null&&we(N),D!=null&&we(D))})}y.indexes.forEach(H)}(m,s,j,T)}else if(w){const j={from:w.lower,to:w.upper};v.add(j),_.add(j)}else _.add(r),v.add(r),s.indexes.forEach(j=>m(j.name).add(r));return L})}},d=({query:{index:h,range:x}})=>{var g,m;return[h,new xn((g=x.lower)!==null&&g!==void 0?g:e.MIN_KEY,(m=x.upper)!==null&&m!==void 0?m:e.MAX_KEY)]},f={get:h=>[l,new xn(h.key)],getMany:h=>[l,new xn().addKeys(h.keys)],count:d,query:d,openCursor:d};return ft(f).forEach(h=>{u[h]=function(x){const{subscr:g}=Ee;if(g){const m=T=>{const I=`idb://${t}/${n}/${T}`;return g[I]||(g[I]=new xn)},_=m(""),v=m(":dels"),[p,w]=f[h](x);if(m(p.name||"").add(w),!p.isPrimaryKey){if(h!=="count"){const T=h==="query"&&c&&x.values&&a.query({...x,values:!1});return a[h].apply(this,arguments).then(I=>{if(h==="query"){if(c&&x.values)return T.then(({result:j})=>(_.addKeys(j),I));const L=x.values?I.result.map(o):I.result;x.values?_.addKeys(L):v.addKeys(L)}else if(h==="openCursor"){const L=I,j=x.values;return L&&Object.create(L,{key:{get:()=>(v.addKey(L.primaryKey),L.key)},primaryKey:{get(){const A=L.primaryKey;return v.addKey(A),A}},value:{get:()=>(j&&_.addKey(L.primaryKey),L.value)}})}return I})}v.add(r)}}return a[h].apply(this,arguments)}}),u}}}};class Pa{constructor(t,r){this._middlewares={},this.verno=0;const n=Pa.dependencies;this._options=r={addons:Pa.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:a}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ve,dbReadyPromise:null,cancelOpen:Ve,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var l;s.dbReadyPromise=new xe(o=>{s.dbReadyResolve=o}),s.openCanceller=new xe((o,c)=>{s.cancelOpen=c}),this._state=s,this.name=t,this.on=Yi(this,"populate","blocked","versionchange","close",{ready:[Zf,Ve]}),this.on.ready.subscribe=Av(this.on.ready.subscribe,o=>(c,u)=>{Pa.vip(()=>{const d=this._state;if(d.openComplete)d.dbOpenError||xe.resolve().then(c),u&&o(c);else if(d.onReadyBeingFired)d.onReadyBeingFired.push(c),u&&o(c);else{o(c);const f=this;u||o(function h(){f.on.ready.unsubscribe(c),f.on.ready.unsubscribe(h)})}})}),this.Collection=(l=this,Ni(YT.prototype,function(o,c){this.db=l;let u=Qv,d=null;if(c)try{u=c()}catch(g){d=g}const f=o._ctx,h=f.table,x=h.hook.reading.fire;this._ctx={table:h,index:f.index,isPrimKey:!f.index||h.schema.primKey.keyPath&&f.index===h.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:d,or:f.or,valueMapper:x!==jl?x:null}})),this.Table=function(o){return Ni(XT.prototype,function(c,u,d){this.db=o,this._tx=d,this.name=c,this.schema=u,this.hook=o._allTables[c]?o._allTables[c].hook:Yi(null,{creating:[RT,Ve],reading:[IT,jl],updating:[MT,Ve],deleting:[LT,Ve]})})}(this),this.Transaction=function(o){return Ni(ZT.prototype,function(c,u,d,f,h){this.db=o,this.mode=c,this.storeNames=u,this.schema=d,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=Yi(this,"complete","error","abort"),this.parent=h||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new xe((x,g)=>{this._resolve=x,this._reject=g}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},x=>{var g=this.active;return this.active=!1,this.on.error.fire(x),this.parent?this.parent._reject(x):g&&this.idbtrans&&this.idbtrans.abort(),gt(x)})})}(this),this.Version=function(o){return Ni(a6.prototype,function(c){this.db=o,this._cfg={version:c,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return Ni(Zv.prototype,function(c,u,d){this.db=o,this._ctx={table:c,index:u===":id"?null:u,or:d};const f=o._deps.indexedDB;if(!f)throw new Se.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(h,x)=>f.cmp(x,h),this._max=(h,x)=>f.cmp(h,x)>0?h:x,this._min=(h,x)=>f.cmp(h,x)<0?h:x,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=Cl(r.IDBKeyRange),this._createTransaction=(o,c,u,d)=>new this.Transaction(o,c,u,this._options.chromeTransactionDurability,d),this._fireOnBlocked=o=>{this.on("blocked").fire(o),Xi.filter(c=>c.name===this.name&&c!==this&&!c._state.vcFired).map(c=>c.on("versionchange").fire(o))},this.use(o6),this.use(c6),this.use(f6),this.use(u6),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new Se.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Se.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(a=>a._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(r6),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||Ee.letThrough||this._vip)?t():new xe((r,n)=>{if(this._state.openComplete)return n(new Se.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new Se.DatabaseClosed);this.open().catch(Ve)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:a}){a&&this.unuse({stack:t,name:a});const s=this._middlewares[t]||(this._middlewares[t]=[]);return s.push({stack:t,create:r,level:n??10,name:a}),s.sort((l,o)=>l.level-o.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(a=>n?a.create!==n:!!r&&a.name!==r)),this}open(){return i6(this)}_close(){const t=this._state,r=Xi.indexOf(this);if(r>=0&&Xi.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new xe(n=>{t.dbReadyResolve=n}),t.openCanceller=new xe((n,a)=>{t.cancelOpen=a})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new Se.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new xe((n,a)=>{const s=()=>{this.close();var l=this._deps.indexedDB.deleteDatabase(this.name);l.onsuccess=Qe(()=>{(function({indexedDB:o,IDBKeyRange:c},u){!ah(o)&&u!==mu&&nh(o,c).delete(u).catch(Ve)})(this._deps,this.name),n()}),l.onerror=tn(a),l.onblocked=this._fireOnBlocked};if(t)throw new Se.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return ft(this._allTables).map(t=>this._allTables[t])}transaction(){const t=l6.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let a=Ee.trans;a&&a.db===this&&t.indexOf("!")===-1||(a=null);const s=t.indexOf("?")!==-1;let l,o;t=t.replace("!","").replace("?","");try{if(o=r.map(u=>{var d=u instanceof this.Table?u.name:u;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),t=="r"||t===t0)l=t0;else{if(t!="rw"&&t!=r0)throw new Se.InvalidArgument("Invalid transaction mode: "+t);l=r0}if(a){if(a.mode===t0&&l===r0){if(!s)throw new Se.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&o.forEach(u=>{if(a&&a.storeNames.indexOf(u)===-1){if(!s)throw new Se.SubTransaction("Table "+u+" not included in parent transaction.");a=null}}),s&&a&&!a.active&&(a=null)}}catch(u){return a?a._promise(null,(d,f)=>{f(u)}):gt(u)}const c=ny.bind(null,this,l,o,a,n);return a?a._promise(l,c,"lock"):Ee.trans?li(Ee.transless,()=>this._whenReady(c)):this._whenReady(c)}table(t){if(!_r(this._allTables,t))throw new Se.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const h6=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class m6{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[h6](){return this}}function sy(e,t){return ft(t).forEach(r=>{$c(e[r]||(e[r]=new xn),t[r])}),e}function x6(e){let t,r=!1;const n=new m6(a=>{const s=qf(e);let l=!1,o={},c={};const u={get closed(){return l},unsubscribe:()=>{l=!0,ha.storagemutated.unsubscribe(x)}};a.start&&a.start(u);let d=!1,f=!1;function h(){return ft(c).some(m=>o[m]&&d6(o[m],c[m]))}const x=m=>{sy(o,m),h()&&g()},g=()=>{if(d||l)return;o={};const m={},_=function(v){s&&ii();const p=()=>da(e,{subscr:v,trans:null}),w=Ee.trans?li(Ee.transless,p):p();return s&&w.then(Fn,Fn),w}(m);f||(ha(kl,x),f=!0),d=!0,Promise.resolve(_).then(v=>{r=!0,t=v,d=!1,l||(h()?g():(o={},c=m,a.next&&a.next(v)))},v=>{d=!1,r=!1,a.error&&a.error(v),u.unsubscribe()})};return g(),u});return n.hasValue=()=>r,n.getValue=()=>t,n}let Ad;try{Ad={indexedDB:Xe.indexedDB||Xe.mozIndexedDB||Xe.webkitIndexedDB||Xe.msIndexedDB,IDBKeyRange:Xe.IDBKeyRange||Xe.webkitIDBKeyRange}}catch{Ad={indexedDB:null,IDBKeyRange:null}}const _a=Pa;function Xo(e){let t=yn;try{yn=!0,ha.storagemutated.fire(e)}finally{yn=t}}Ys(_a,{...Wo,delete:e=>new _a(e,{addons:[]}).delete(),exists:e=>new _a(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return ah(t)?Promise.resolve(t.databases()).then(n=>n.map(a=>a.name).filter(a=>a!==mu)):nh(t,r).toCollection().primaryKeys()}(_a.dependencies).then(e)}catch{return gt(new Se.MissingAPI)}},defineClass:()=>function(e){Qt(this,e)},ignoreTransaction:e=>Ee.trans?li(Ee.transless,e):e(),vip:Td,async:function(e){return function(){try{var t=kd(e.apply(this,arguments));return t&&typeof t.then=="function"?t:xe.resolve(t)}catch(r){return gt(r)}}},spawn:function(e,t,r){try{var n=kd(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:xe.resolve(n)}catch(a){return gt(a)}},currentTransaction:{get:()=>Ee.trans||null},waitFor:function(e,t){const r=xe.resolve(typeof e=="function"?_a.ignoreTransaction(e):e).timeout(t||6e4);return Ee.trans?Ee.trans.waitFor(r):r},Promise:xe,debug:{get:()=>on,set:e=>{Rv(e,e==="dexie"?()=>!0:qv)}},derive:Rs,extend:Qt,props:Ys,override:Av,Events:Yi,on:ha,liveQuery:x6,extendObservabilitySet:sy,getByKeyPath:jn,setByKeyPath:Gr,delByKeyPath:function(e,t){typeof t=="string"?Gr(e,t,void 0):"length"in t&&[].map.call(t,function(r){Gr(e,r,void 0)})},shallowClone:Ov,deepClone:zl,getObjectDiff:sh,cmp:Xt,asap:Dv,minKey:yd,addons:[],connections:Xi,errnames:Jf,dependencies:Ad,semVer:gx,version:gx.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),_a.maxKey=Cl(_a.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ha(kl,e=>{if(!yn){let t;hu?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Vn,!0,!0,e)):t=new CustomEvent(Vn,{detail:e}),yn=!0,dispatchEvent(t),yn=!1}}),addEventListener(Vn,({detail:e})=>{yn||Xo(e)}));let yn=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(Vn);typeof e.unref=="function"&&e.unref(),ha(kl,t=>{yn||e.postMessage(t)}),e.onmessage=t=>{t.data&&Xo(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ha(kl,t=>{try{yn||(typeof localStorage<"u"&&localStorage.setItem(Vn,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:Vn,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Vn){const r=JSON.parse(t.newValue);r&&Xo(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===Vn&&Xo(t.changedParts)})}xe.rejectionMapper=function(e,t){if(!e||e instanceof Ls||e instanceof TypeError||e instanceof SyntaxError||!e.name||!hx[e.name])return e;var r=new hx[e.name](t||e.message,e);return"stack"in e&&En(r,"stack",{get:function(){return this.inner.stack}}),r},Rv(on,qv);class p6 extends Pa{constructor(){super("ConstructionManagementDB");Xl(this,"operations");Xl(this,"clients");Xl(this,"settings");this.version(2).stores({operations:"id, code, name, clientId, status, createdAt, updatedAt, totalAmount, totalReceived",clients:"id, name, type, phone, email, createdAt, updatedAt",settings:"key"}).upgrade(r=>r.table("clients").toCollection().modify(n=>{n.type||(n.type="owner"),n.contacts||(n.contacts=[])})),this.version(1).stores({operations:"id, code, name, clientId, status, createdAt, updatedAt, totalAmount, totalReceived",clients:"id, name, phone, email, createdAt, updatedAt",settings:"key"}),this.operations.hook("creating",function(r,n,a){n.createdAt=new Date,n.updatedAt=new Date,n.warrantyCertificates||(n.warrantyCertificates=[]),n.guaranteeChecks=n.guaranteeChecks.map(s=>({...s,relatedTo:s.relatedTo||"operation"})),n.guaranteeLetters=n.guaranteeLetters.map(s=>({...s,relatedTo:s.relatedTo||"operation"}))}),this.operations.hook("updating",function(r,n,a,s){r.updatedAt=new Date}),this.clients.hook("creating",function(r,n,a){n.createdAt=new Date,n.updatedAt=new Date,n.type||(n.type="owner"),n.contacts||(n.contacts=[])}),this.clients.hook("updating",function(r,n,a,s){r.updatedAt=new Date})}}const ze=new p6,Qr={async getAllOperations(){return await ze.operations.orderBy("createdAt").reverse().toArray()},async getOperationById(e){return await ze.operations.get(e)},async addOperation(e){return await ze.operations.add(e)},async updateOperation(e,t){return await ze.operations.update(e,t)},async deleteOperation(e){await ze.operations.delete(e)},async getOperationsByClient(e){return await ze.operations.where("clientId").equals(e).toArray()},async getOperationsByStatus(e){return await ze.operations.where("status").equals(e).toArray()},async getOperationsByDateRange(e,t){return await ze.operations.where("createdAt").between(e,t,!0,!0).toArray()},async getAllClients(){return await ze.clients.orderBy("name").toArray()},async getClientById(e){return await ze.clients.get(e)},async addClient(e){return await ze.clients.add(e)},async updateClient(e,t){return await ze.clients.update(e,t)},async deleteClient(e){if((await this.getOperationsByClient(e)).length>0)throw new Error("لا يمكن حذف العميل لأنه مرتبط بعمليات موجودة");await ze.clients.delete(e)},async searchClients(e){return await ze.clients.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.phone&&t.phone.includes(e)||t.email&&t.email.toLowerCase().includes(e.toLowerCase())).toArray()},async getSetting(e){const t=await ze.settings.get(e);return t==null?void 0:t.value},async setSetting(e,t){return await ze.settings.put({key:e,value:t})},async exportData(){const e=await this.getAllOperations(),t=await this.getAllClients();return{operations:e,clients:t,exportDate:new Date().toISOString(),version:"2.0"}},async importData(e){await ze.transaction("rw",ze.operations,ze.clients,async()=>{if(e.clients){const t=e.clients.map(r=>({...r,type:r.type||"owner",contacts:r.contacts||[]}));await ze.clients.clear(),await ze.clients.bulkAdd(t)}if(e.operations){const t=e.operations.map(r=>({...r,warrantyCertificates:r.warrantyCertificates||[],guaranteeChecks:r.guaranteeChecks.map(n=>({...n,relatedTo:n.relatedTo||"operation"})),guaranteeLetters:r.guaranteeLetters.map(n=>({...n,relatedTo:n.relatedTo||"operation"}))}));await ze.operations.clear(),await ze.operations.bulkAdd(t)}})},async getStatistics(){const[e,t]=await Promise.all([this.getAllOperations(),this.getAllClients()]),r=e.length,n=e.filter(u=>u.status==="completed").length,a=e.filter(u=>u.status==="in_progress").length,s=e.reduce((u,d)=>u+d.totalAmount,0),l=e.reduce((u,d)=>u+d.totalReceived,0),o=e.reduce((u,d)=>u+d.guaranteeChecks.filter(f=>!f.isReturned).length+d.guaranteeLetters.filter(f=>!f.isReturned).length,0),c=e.reduce((u,d)=>u+(d.warrantyCertificates||[]).filter(f=>f.isActive).length,0);return{totalOperations:r,completedOperations:n,inProgressOperations:a,totalAmount:s,totalReceived:l,outstandingGuarantees:o,activeWarranties:c,totalClients:t.length}},async advancedSearch(e){let t=ze.operations.toCollection();if(e.clientId&&(t=t.filter(r=>r.clientId===e.clientId)),e.status&&(t=t.filter(r=>r.status===e.status)),e.startDate&&(t=t.filter(r=>r.createdAt>=e.startDate)),e.endDate&&(t=t.filter(r=>r.createdAt<=e.endDate)),e.minAmount!==void 0&&(t=t.filter(r=>r.totalAmount>=e.minAmount)),e.maxAmount!==void 0&&(t=t.filter(r=>r.totalAmount<=e.maxAmount)),e.searchTerm){const r=e.searchTerm.toLowerCase();t=t.filter(n=>n.name.toLowerCase().includes(r)||n.code.toLowerCase().includes(r))}return await t.toArray()}},g6=async()=>{try{if(await ze.open(),await ze.clients.count()===0){const t=[{id:crypto.randomUUID(),name:"شركة الإنشاءات الحديثة",type:"main_contractor",phone:"01234567890",email:"info@modern-construction.com",address:"القاهرة، مصر",contacts:[{id:crypto.randomUUID(),name:"أحمد محمد",position:"مدير الحسابات",department:"accounts",phone:"01234567891",email:"ahmed@modern-construction.com",isMainContact:!0},{id:crypto.randomUUID(),name:"سارة أحمد",position:"مهندسة مشروعات",department:"engineering",phone:"01234567892",email:"sara@modern-construction.com",isMainContact:!1}],createdAt:new Date,updatedAt:new Date},{id:crypto.randomUUID(),name:"مؤسسة البناء المتطور",type:"owner",phone:"01987654321",email:"contact@advanced-building.com",address:"الإسكندرية، مصر",contacts:[{id:crypto.randomUUID(),name:"محمد علي",position:"المدير التنفيذي",department:"management",phone:"01987654322",email:"mohamed@advanced-building.com",isMainContact:!0}],createdAt:new Date,updatedAt:new Date},{id:crypto.randomUUID(),name:"شركة المقاولات العربية",type:"consultant",phone:"01555666777",email:"info@arab-contracting.com",address:"الجيزة، مصر",contacts:[{id:crypto.randomUUID(),name:"فاطمة حسن",position:"مديرة المشاريع",department:"engineering",phone:"01555666778",email:"fatma@arab-contracting.com",isMainContact:!0}],createdAt:new Date,updatedAt:new Date}];await ze.clients.bulkAdd(t),console.log("تم إضافة العملاء التجريبيين بنجاح")}console.log("تم تهيئة قاعدة البيانات بنجاح")}catch(e){console.error("خطأ في تهيئة قاعدة البيانات:",e)}},vt={getOperations:async()=>{try{return await Qr.getAllOperations()}catch(e){return console.error("Error loading operations:",e),[]}},saveOperations:async e=>{console.warn("saveOperations is deprecated. Use individual operation methods instead.")},addOperation:async e=>{try{await Qr.addOperation(e)}catch(t){throw console.error("Error adding operation:",t),t}},updateOperation:async(e,t)=>{try{await Qr.updateOperation(e,t)}catch(r){throw console.error("Error updating operation:",r),r}},deleteOperation:async e=>{try{await Qr.deleteOperation(e)}catch(t){throw console.error("Error deleting operation:",t),t}},getClients:async()=>{try{return await Qr.getAllClients()}catch(e){return console.error("Error loading clients:",e),[]}},saveClients:async e=>{console.warn("saveClients is deprecated. Use individual client methods instead.")},addClient:async e=>{try{await Qr.addClient(e)}catch(t){throw console.error("Error adding client:",t),t}},updateClient:async(e,t)=>{try{await Qr.updateClient(e,t)}catch(r){throw console.error("Error updating client:",r),r}},deleteClient:async e=>{try{await Qr.deleteClient(e)}catch(t){throw console.error("Error deleting client:",t),t}},exportData:async()=>{try{return await Qr.exportData()}catch(e){throw console.error("Error exporting data:",e),e}},importData:async e=>{try{await Qr.importData(e)}catch(t){throw console.error("Error importing data:",t),t}}};function v6(){const[e,t]=ye.useState("dashboard"),[r,n]=ye.useState([]),[a,s]=ye.useState([]),[l,o]=ye.useState(null),[c,u]=ye.useState(!0);ye.useEffect(()=>{(async()=>{try{u(!0),await g6();const[A,y]=await Promise.all([vt.getOperations(),vt.getClients()]);n(A),s(y),console.log("تم تحميل البيانات بنجاح:",{operations:A.length,clients:y.length})}catch(A){console.error("خطأ في تحميل البيانات:",A)}finally{u(!1)}})()},[]);const d=j=>{t(j),o(null)},f=()=>{const j=r.length,A=r.filter(we=>we.status==="completed"||we.status==="completed_partial_payment"||we.status==="completed_full_payment").length,y=r.filter(we=>we.status==="in_progress").length,O=r.reduce((we,z)=>we+z.totalAmount,0),B=r.reduce((we,z)=>we+Dr(z),0),H=r.reduce((we,z)=>we+Ua(z),0),Q=r.reduce((we,z)=>we+z.totalReceived,0),ie=r.reduce((we,z)=>we+z.guaranteeChecks.filter(K=>!K.isReturned).length+z.guaranteeLetters.filter(K=>!K.isReturned).length,0),oe=r.reduce((we,z)=>we+(z.warrantyCertificates||[]).filter(K=>K.isActive).length,0);return{totalOperations:j,completedOperations:A,inProgressOperations:y,totalAmount:O,totalReceived:Q,outstandingGuarantees:ie,activeWarranties:oe,totalDeductions:B,totalNetAmount:H}},h=async j=>{try{await vt.addOperation(j);const A=await vt.getOperations();n(A),t("view-operations")}catch(A){console.error("خطأ في حفظ العملية:",A),alert("حدث خطأ في حفظ العملية")}},x=async j=>{try{const A=Tf(j),y={...j,status:A,updatedAt:new Date};await vt.updateOperation(j.id,y);const O=await vt.getOperations();n(O),t("view-operations"),o(null)}catch(A){console.error("خطأ في تحديث العملية:",A),alert("حدث خطأ في تحديث العملية")}},g=async j=>{if(window.confirm("هل أنت متأكد من حذف هذه العملية؟"))try{await vt.deleteOperation(j);const A=await vt.getOperations();n(A)}catch(A){console.error("خطأ في حذف العملية:",A),alert("حدث خطأ في حذف العملية")}},m=j=>{o(j),t("view-operation-details")},_=j=>{o(j),t("edit-operation")},v=async j=>{try{await vt.addClient(j);const A=await vt.getClients();s(A)}catch(A){console.error("خطأ في إضافة العميل:",A),alert("حدث خطأ في إضافة العميل")}},p=async(j,A)=>{try{await vt.updateClient(j,A);const y=await vt.getClients();s(y)}catch(y){console.error("خطأ في تحديث العميل:",y),alert("حدث خطأ في تحديث العميل")}},w=async j=>{try{if(r.some(y=>y.clientId===j)){alert("لا يمكن حذف العميل لأنه مرتبط بعمليات موجودة");return}if(window.confirm("هل أنت متأكد من حذف هذا العميل؟")){await vt.deleteClient(j);const y=await vt.getClients();s(y)}}catch(A){console.error("خطأ في حذف العميل:",A),alert("حدث خطأ في حذف العميل")}},T=async()=>{try{const j=await vt.exportData(),A=new Blob([JSON.stringify(j,null,2)],{type:"application/json"}),y=URL.createObjectURL(A),O=document.createElement("a");O.href=y,O.download=`construction-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(y)}catch(j){console.error("خطأ في تصدير البيانات:",j),alert("حدث خطأ في تصدير البيانات")}},I=async j=>{var y;const A=(y=j.target.files)==null?void 0:y[0];if(A){const O=new FileReader;O.onload=async B=>{var H;try{const Q=JSON.parse((H=B.target)==null?void 0:H.result);await vt.importData(Q);const[ie,oe]=await Promise.all([vt.getOperations(),vt.getClients()]);n(ie),s(oe),alert("تم استيراد البيانات بنجاح")}catch(Q){console.error("خطأ في استيراد البيانات:",Q),alert("خطأ في قراءة الملف")}},O.readAsText(A)}j.target.value=""},L=()=>{if(c)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"جاري تحميل البيانات..."})]})});switch(e){case"dashboard":return i.jsx(wi,{stats:f(),onNavigate:d});case"add-operation":return i.jsx(f_,{clients:a,onSave:h,onCancel:()=>t("dashboard")});case"view-operations":return i.jsx(gT,{operations:r,clients:a,onEdit:_,onDelete:g,onView:m});case"view-operation-details":if(!l)return i.jsx(wi,{stats:f(),onNavigate:d});const j=a.find(A=>A.id===l.clientId);return j?i.jsx(vT,{operation:l,client:j,onClose:()=>{o(null),t("view-operations")}}):i.jsx(wi,{stats:f(),onNavigate:d});case"edit-operation":return l?i.jsx(yT,{operation:l,clients:a,onSave:x,onCancel:()=>{o(null),t("view-operations")}}):i.jsx(wi,{stats:f(),onNavigate:d});case"clients":return i.jsx(wT,{clients:a,onAddClient:v,onUpdateClient:p,onDeleteClient:w});case"guarantees":return i.jsx(_T,{operations:r,clients:a});case"warranties":return i.jsx(NT,{operations:r,clients:a,onUpdateOperation:x});case"checks":return i.jsx(bT,{operations:r,clients:a});case"reports":return i.jsx(ET,{operations:r,clients:a});default:return i.jsx(wi,{stats:f(),onNavigate:d})}};return i.jsxs("div",{className:"min-h-screen bg-gray-100",dir:"rtl",children:[i.jsx(c_,{onExport:T,onImport:I}),i.jsxs("div",{className:"flex",children:[i.jsx(u_,{activeView:e,onViewChange:t}),i.jsx("main",{className:"flex-1",children:L()})]})]})}Lg(document.getElementById("root")).render(i.jsx(ye.StrictMode,{children:i.jsx(v6,{})}));
